<?xml version="1.0"?>
<AlteryxDocument yxmdVer="2022.1">
  <Nodes>
    <Node ToolID="35">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="55" y="54" width="551" height="40" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text>UPDATE WEEK NUMBER BEFORE RUNNING</Text>
          <Font name="Segoe UI Light" size="20" style="1" />
          <TextColor name="Red" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="4" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="36">
      <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
        <Position x="655" y="54" width="408" height="252" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Text><![CDATA[
This part of the VCES process has 3 main tasks:


1. Updates the report month in the config file.



2. Checks there are no records in any of the tables or at least only the tables that should have records.



3. Move the files generated by OPS and save over to the required folder. This section has Python code to manage the moving of files and manages archiving files that are no longer needed.]]></Text>
          <Font name="Segoe UI Light" size="8.25" style="0" />
          <TextColor name="Black" />
          <FillColor name="White" />
          <Shape shape="0" />
          <Justification Justification="3" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
    </Node>
    <Node ToolID="13">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="55" y="101" width="230" height="228" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Update Report Month</Caption>
          <Style TextColor="#314c4a" FillColor="#808080" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="12">
          <GuiSettings Plugin="AlteryxBasePluginsGui.TextInput.TextInput">
            <Position x="80" y="198" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <NumRows value="1" />
              <Fields>
                <Field name="report_month" />
                <Field name="base_report_folder" />
                <Field name="current_reporting" />
              </Fields>
              <Data>
                <r>
                  <c>2022-12-01</c>
                  <c>\\clbnas01\OpsDataTeam\20. Alteryx\3. Development\Billing Automation\Dev\VCES v2\reports\Monthly\</c>
                  <c><![CDATA[Monthly             ]]></c>
                </r>
              </Data>
            </Configuration>
            <Annotation DisplayMode="1">
              <Name>Manual Input 1</Name>
              <AnnotationText>Text input for report month and report base folder</AnnotationText>
              <DefaultAnnotationText>Text input for report month and report base folder</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxTextInput" />
        </Node>
        <Node ToolID="15">
          <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
            <Position x="80" y="150" width="180" height="40" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Text>Update month you are running for in the table below.</Text>
              <Font name="Segoe UI Light" size="8.25" style="0" />
              <TextColor name="Black" />
              <FillColor name="White" />
              <Shape shape="0" />
              <Justification Justification="4" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
        </Node>
        <Node ToolID="16">
          <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileOutput.DbFileOutput">
            <Position x="200" y="198" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <File MaxRecords="" FileFormat="23">aka:5f15b4860b05360e6c4ed32e|||[Billing_Automation].[config].[config]</File>
              <Passwords />
              <CachedCosmeticName>DI_Billing</CachedCosmeticName>
              <FormatSpecificOptions>
                <TransactionSize>10000</TransactionSize>
                <IgnoreDropTableSQLErrors>False</IgnoreDropTableSQLErrors>
                <PostSQL />
                <TableStyle>Quoted</TableStyle>
                <PreSQL />
                <TransactionMessages>False</TransactionMessages>
                <OutputOption>Delete</OutputOption>
              </FormatSpecificOptions>
              <MultiFile value="False" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText>aka:DI_Billing
Query=[Billing_Automation].[config...</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileOutput" />
        </Node>
      </ChildNodes>
    </Node>
    <Node ToolID="20">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="378" y="101" width="230" height="228" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Table Empty Check</Caption>
          <Style TextColor="#314c4a" FillColor="#808080" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="18">
          <GuiSettings Plugin="AlteryxGuiToolkit.TextBox.TextBox">
            <Position x="403" y="150" width="180" height="40" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Text>Has the previous months data been saved down</Text>
              <Font name="Segoe UI Light" size="8.25" style="0" />
              <TextColor name="Black" />
              <FillColor name="White" />
              <Shape shape="0" />
              <Justification Justification="4" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
        </Node>
        <Node ToolID="21">
          <GuiSettings Plugin="AlteryxBasePluginsGui.DbFileInput.DbFileInput">
            <Position x="403" y="198" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <Passwords />
              <CachedCosmeticName>DI_Billing</CachedCosmeticName>
              <File RecordLimit="" FileFormat="23">aka:5f15b4860b05360e6c4ed32e|||select 'tbl_bin_List' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_bin_List
union
select 'tbl_ppbo_declines' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_declines
union
select 'tbl_ppbo_declines_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_declines_with_bin
union
select 'tbl_ppbo_members' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_members
union
select 'tbl_ppbo_members_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_members_with_bin
union
select 'tbl_ppbo_visits' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_visits
union
select 'tbl_ppbo_visits_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_visits_with_bin</File>
              <FormatSpecificOptions>
                <PreSQL />
                <PreSQLOnConfig>True</PreSQLOnConfig>
                <NoProgress>True</NoProgress>
                <CacheData>False</CacheData>
                <TableStyle>Quoted</TableStyle>
                <ReadUncommitted>False</ReadUncommitted>
                <PostSQL />
              </FormatSpecificOptions>
            </Configuration>
            <Annotation DisplayMode="1">
              <Name>Table Record Counts</Name>
              <AnnotationText>Query record count from all staging tables</AnnotationText>
              <DefaultAnnotationText>Table Record Counts</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
            <MetaInfo connection="Output">
              <RecordInfo>
                <Field name="dbTable" size="26" source="File: aka:5f15b4860b05360e6c4ed32e|||select 'tbl_bin_List' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_bin_List&#xA;union&#xA;select 'tbl_ppbo_declines' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_declines&#xA;union&#xA;select 'tbl_ppbo_declines_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_declines_with_bin&#xA;union&#xA;select 'tbl_ppbo_members' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_members&#xA;union&#xA;select 'tbl_ppbo_members_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_members_with_bin&#xA;union&#xA;select 'tbl_ppbo_visits' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_visits&#xA;union&#xA;select 'tbl_ppbo_visits_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_visits_with_bin" type="V_String" />
                <Field name="rec_count" source="File: aka:5f15b4860b05360e6c4ed32e|||select 'tbl_bin_List' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_bin_List&#xA;union&#xA;select 'tbl_ppbo_declines' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_declines&#xA;union&#xA;select 'tbl_ppbo_declines_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_declines_with_bin&#xA;union&#xA;select 'tbl_ppbo_members' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_members&#xA;union&#xA;select 'tbl_ppbo_members_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_members_with_bin&#xA;union&#xA;select 'tbl_ppbo_visits' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_visits&#xA;union&#xA;select 'tbl_ppbo_visits_with_bin' as dbTable, count(*) rec_count FROM Billing_Automation.staging.tbl_ppbo_visits_with_bin" type="Int32" />
              </RecordInfo>
            </MetaInfo>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxDbFileInput" />
        </Node>
        <Node ToolID="22">
          <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
            <Position x="523" y="198" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <TempFile>C:\Users\HARSHA~1.DES\AppData\Local\Temp\Engine_7748_900ab9b996334a49b99e7fe12f240ad5_\Engine_12660_92b5edadc13b4b3c9f76f8aef56587c9_.yxdb</TempFile>
              <TempFileDataProfiling />
              <Layout>
                <ViewMode>Single</ViewMode>
                <ViewSize value="100" />
                <View1>
                  <DefaultTab>Profile</DefaultTab>
                  <Hints>
                    <Table />
                  </Hints>
                </View1>
                <View2 />
              </Layout>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
        </Node>
      </ChildNodes>
    </Node>
    <Node ToolID="32">
      <GuiSettings Plugin="AlteryxGuiToolkit.ToolContainer.ToolContainer">
        <Position x="54" y="341" width="565" height="200" />
      </GuiSettings>
      <Properties>
        <Configuration>
          <Caption>Copy Over OPS Bin Files</Caption>
          <Style TextColor="#314c4a" FillColor="#808080" BorderColor="#314c4a" Transparency="25" Margin="25" />
          <Disabled value="False" />
          <Folded value="False" />
        </Configuration>
        <Annotation DisplayMode="0">
          <Name />
          <DefaultAnnotationText />
          <Left value="False" />
        </Annotation>
      </Properties>
      <ChildNodes>
        <Node ToolID="24">
          <GuiSettings Plugin="AlteryxBasePluginsGui.TextInput.TextInput">
            <Position x="79" y="425" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <NumRows value="5" />
              <Fields>
                <Field name="FileName" />
                <Field name="Source_Full_File_Name" />
                <Field name="Success" />
                <Field name="DateTime" />
                <Field name="Destination_Folder_Name" />
              </Fields>
              <Data>
                <r>
                  <c>Generic.xlsx</c>
                  <c>\\clbnas01\PriorityPass\8F. OPS LOUNGEKEY\!!VISA LOUNGEKEY\!!Deal Types\!Visa CEMEA LoungeKey (Platform)\MENA Infinite and Signature\1. Setup\BIN lists\Current BINs\Generic_BIN_List.xlsx</c>
                  <c />
                  <c />
                  <c>\\clbnas01\OpsDataTeam\20. Alteryx\3. Development\Billing Automation\Dev\VCES v2\source\ActiveBinFiles</c>
                </r>
                <r>
                  <c>VCES.xlsx</c>
                  <c>\\clbnas01\PriorityPass\8F. OPS LOUNGEKEY\!!VISA LOUNGEKEY\!!Deal Types\!Visa CEMEA LoungeKey (Platform)\MENA Infinite and Signature\1. Setup\BIN lists\Current BINs\VCES_BIN_List.xlsx</c>
                  <c />
                  <c />
                  <c>\\clbnas01\OpsDataTeam\20. Alteryx\3. Development\Billing Automation\Dev\VCES v2\source\ActiveBinFiles</c>
                </r>
                <r>
                  <c>SSA.xlsx</c>
                  <c>\\clbnas01\PriorityPass\8F. OPS LOUNGEKEY\!!VISA LOUNGEKEY\!!Deal Types\!Visa CEMEA LoungeKey (Platform)\SSA (Platform)\BIN List\SSA_BIN_List.xlsx</c>
                  <c />
                  <c />
                  <c>\\clbnas01\OpsDataTeam\20. Alteryx\3. Development\Billing Automation\Dev\VCES v2\source\ActiveBinFiles</c>
                </r>
                <r>
                  <c>CISSEE.xlsx</c>
                  <c>\\clbnas01\PriorityPass\8F. OPS LOUNGEKEY\!!VISA LOUNGEKEY\!!Deal Types\!Visa CISSEE LoungeKey (Platform)\!! CIS PLATFORM BIN LISTS\CISSEE_Bin_List.xlsx</c>
                  <c />
                  <c />
                  <c>\\clbnas01\OpsDataTeam\20. Alteryx\3. Development\Billing Automation\Dev\VCES v2\source\ActiveBinFiles</c>
                </r>
                <r>
                  <c>Pricing Table.xlsx</c>
                  <c>\\clbnas01\PriorityPass\8F. OPS LOUNGEKEY\!!VISA LOUNGEKEY\!!Visa Templates\19. Pricing\Visa Current pricing.xlsx</c>
                  <c />
                  <c />
                  <c>\\clbnas01\OpsDataTeam\20. Alteryx\3. Development\Billing Automation\Dev\VCES v2\source</c>
                </r>
              </Data>
            </Configuration>
            <Annotation DisplayMode="1">
              <Name>Manual Input 2</Name>
              <AnnotationText>File Names &amp; Paths</AnnotationText>
              <DefaultAnnotationText>Manual Input 2</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxTextInput" />
        </Node>
        <Node ToolID="27">
          <GuiSettings Plugin="AlteryxBasePluginsGui.Formula.Formula">
            <Position x="283" y="414" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <FormulaFields>
                <FormulaField expression="[Destination_Folder_Name] + &quot;\&quot; + REGEX_Replace([FileName], &quot;(\w+)\.(\w+)&quot;, &quot;Bin_$1_&quot;+[report_month]+&quot;.xlsx&quot;)" field="Destination_Full_File_Name" size="255" type="V_WString" />
                <FormulaField expression="REGEX_Replace([FileName], &quot;(\w+)\.(\w+)&quot;, &quot;Bin_$1_&quot;+[report_month]+&quot;.xlsx&quot;)" field="FileName" size="50" type="V_String" />
                <FormulaField expression="DateTimeFormat(DateTimeAdd([report_month],-4,&quot;Month&quot;),&quot;%Y-%m-%d&quot;)" field="old_report_month" size="10" type="String" />
              </FormulaFields>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText>Destination_Full_File_Name = [Destination_Folder_Name] + "\" + REGEX_Replace([Fi...</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxFormula" />
        </Node>
        <Node ToolID="31">
          <GuiSettings Plugin="AlteryxBasePluginsGui.AppendFields.AppendFields">
            <Position x="187" y="414" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <CartesianMode>Error</CartesianMode>
              <SelectConfiguration>
                <Configuration outputConnection="Output">
                  <OrderChanged value="False" />
                  <CommaDecimal value="False" />
                  <SelectFields>
                    <SelectField field="Target_base_report_folder" selected="False" input="Target_" />
                    <SelectField field="Target_current_reporting" selected="False" input="Target_" />
                    <SelectField field="Source_FileName" selected="True" input="Source_" size="50" />
                    <SelectField field="Source_Success" selected="True" input="Source_" type="String" size="1" />
                    <SelectField field="Source_DateTime" selected="True" input="Source_" type="Date" size="10" />
                    <SelectField field="*Unknown" selected="True" />
                  </SelectFields>
                </Configuration>
              </SelectConfiguration>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxAppendFields" />
        </Node>
        <Node ToolID="29">
          <GuiSettings Plugin="JupyterCode">
            <Position x="463" y="414" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <LastExecutedByEngineVersion>2022.1.1.30569</LastExecutedByEngineVersion>
              <DefaultVenv>1</DefaultVenv>
              <JupyterGuidDir>415d67c655d5c31208dc089789fc0b8b</JupyterGuidDir>
              <productionModeScript>#################################
# List all non-standard packages to be imported by your 
# script here (only missing packages will be installed)
from ayx import Package
#Package.installPackages(['pandas','numpy'])
from ayx import Alteryx
from shutil import copyfile
import os.path
from os import path
import time, datetime


#################################
filepaths = Alteryx.read("#1")

for index, file in filepaths.iterrows():
    src = file['Old_FullPath']
    dst = file['New_FullPath']
    fnm = file["FileName"]
    mod = os.stat(dst).st_mtime
    src_exists = path.exists(src)
    dst_exists = path.exists(dst)
    
    #Convert the modified date to a clean string
    year,month,day,hour,minute,second=time.localtime(mod)[:-3]
    mod = " %02d-%02d-%d@%02d_%02d"%(year,month,day,hour,minute)
    
    if src_exists is False:
        filepaths.at[index, "Success"] = "N"
        filepaths.at[index, "DateTime"] = datetime.datetime.now() 
    else:

        #if thereis alraedy a file in the source folder move to archive
        if dst_exists:    
            src_first = dst
            dst_first = dst[:-len(fnm)] + "Archive\\" + fnm[:-5] + mod + ".xlsx"

            #copyfile(src_first, dst_first) # Copy to archive folder

        #copyfile(src, dst) # Copy to source folder

        if path.exists(dst):
            filepaths.at[index, "Success"] = "Y"
            filepaths.at[index, "DateTime"] = datetime.datetime.now()
    
print(filepaths)


#################################
Alteryx.write(filepaths,1)</productionModeScript>
              <Notebook><![CDATA[{"cells":[{"cell_type":"markdown","metadata":{"ayx":{"cell_class":"text_cell","cell_css":"border: 3px solid #357; margin: 4px; background: #fbffff","cell_type":"markdown","contents_keyword":"Alteryx.help()","first_line":"Run `Alteryx.help()` for info about useful functions.","label":"info"}},"source":["Run `Alteryx.help()` for info about useful functions.  \n","i.e., `Alteryx.read(\"#1\")`, `Alteryx.write(df,1)`, `Alteryx.getWorkflowConstant(\"Engine.WorkflowDirectory\")`"]},{"cell_type":"code","execution_count":1,"metadata":{"ayx":{"cell_class":"code_cell","cell_css":"border: 1px solid #58a; margin: 2px;","cell_type":"code","contents_keyword":"installPackages","first_line":"# List all non-standard packages to be imported by your","label":"deps"}},"outputs":[],"source":["# List all non-standard packages to be imported by your \n","# script here (only missing packages will be installed)\n","from ayx import Package\n","#Package.installPackages(['pandas','numpy'])\n","from ayx import Alteryx\n","from shutil import copyfile\n","import os.path\n","from os import path\n","import time, datetime"]},{"cell_type":"code","execution_count":2,"metadata":{},"outputs":[],"source":["filepaths = Alteryx.read(\"#1\")\n","\n","\n","for index, file in filepaths.iterrows():\n","    src = file['Source_Full_File_Name']\n","    dst = file['Destination_Full_File_Name'] \n","    hst = file['Destination_Full_File_Name'].replace(file['report_month'],file['old_report_month']) \n","    fnm = file[\"FileName\"]\n","\n","    src_exists = path.exists(src) #does source file exist\n","    hst_exists = path.exists(hst) #does historical file exist\n","    dst_exists = path.exists(dst) #does file exist in Destination location\n","\n","    #move historical file to archive\n","    if hst_exists:\n","        mod = os.stat(hst).st_mtime\n","\n","        #Convert the modified date to a clean string\n","        year,month,day,hour,minute,second=time.localtime(mod)[:-3]\n","        mod = \" %02d-%02d-%d@%02d_%02d\"%(year,month,day,hour,minute)\n","        \n","        arc = hst.replace(file['Destination_Folder_Name'],file['Destination_Folder_Name'] + '\\\\Archive')\n","        arc = arc[:-5] + mod + \".xlsx\"\n","        \n","        copyfile(hst, arc) # Copy to archive folder\n","        if path.exists(arc):\n","            os.remove(hst)\n","\n","    #copy over new files\n","    if src_exists is False:\n","        filepaths.at[index, \"Success\"] = \"N\"\n","        filepaths.at[index, \"DateTime\"] = datetime.datetime.now() \n","    else:\n","\n","        #if thereis alraedy a file in the source folder move to archive\n","        if dst_exists:\n","            mod = os.stat(dst).st_mtime\n","\n","            #Convert the modified date to a clean string\n","            year,month,day,hour,minute,second=time.localtime(mod)[:-3]\n","            mod = \" %02d-%02d-%d@%02d_%02d\"%(year,month,day,hour,minute)\n","\n","            arc = dst.replace(file['Destination_Folder_Name'],file['Destination_Folder_Name'] + '\\\\Archive')\n","            arc = arc[:-5] + mod + \".xlsx\"\n","\n","            copyfile(dst, arc) # Copy to archive folder\n","\n","        copyfile(src, dst) # Copy to source folder\n","    \n","    #update \n","    if path.exists(dst):\n","        filepaths.at[index, \"Success\"] = \"Y\"\n","        filepaths.at[index, \"DateTime\"] = datetime.datetime.now()"]},{"cell_type":"code","execution_count":3,"metadata":{},"outputs":[],"source":["Alteryx.write(filepaths,1)"]},{"cell_type":"code","execution_count":null,"metadata":{},"outputs":[],"source":[]}],"metadata":{"kernelspec":{"display_name":"designerbasetools_venv","language":"python","name":"designerbasetools_venv"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"}},"nbformat":4,"nbformat_minor":2}]]></Notebook>
              <Port>54264</Port>
              <WorkflowName>o:\20. alteryx\3. development\billing automation\dev\vces v2\alteryx\1.model\0_prerunchecks.yxmd</WorkflowName>
              <specialCellMetadata>[{"label":"info","contents_keyword":"Alteryx.help()","cell_css":"border: 3px solid #357; margin: 4px; background: #fbffff","first_line":"Run `Alteryx.help()` for info about useful functions.","cell_type":"markdown","cell_class":"text_cell"},{"label":"deps","contents_keyword":"installPackages","cell_css":"border: 1px solid #58a; margin: 2px;","first_line":"# List all non-standard packages to be imported by your","cell_type":"code","cell_class":"code_cell"}]</specialCellMetadata>
              <AssetManaged>True</AssetManaged>
              <JupyterProduction>false</JupyterProduction>
              <vEnvName>designerbasetools_venv</vEnvName>
              <JupyterGuidCopy />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
            <MetaInfo connection="Output1">
              <RecordInfo>
                <Field name="report_month" size="1073741823" source="PythonTool:" type="V_WString" />
                <Field name="FileName" size="1073741823" source="PythonTool:" type="V_WString" />
                <Field name="Source_Full_File_Name" size="1073741823" source="PythonTool:" type="V_WString" />
                <Field name="Success" size="1073741823" source="PythonTool:" type="V_WString" />
                <Field name="DateTime" source="PythonTool:" type="DateTime" />
                <Field name="Destination_Folder_Name" size="1073741823" source="PythonTool:" type="V_WString" />
                <Field name="Destination_Full_File_Name" size="1073741823" source="PythonTool:" type="V_WString" />
                <Field name="old_report_month" size="1073741823" source="PythonTool:" type="V_WString" />
              </RecordInfo>
            </MetaInfo>
          </Properties>
          <EngineSettings EngineDll="AlteryxJupyterPluginEngine.dll" EngineDllEntryPoint="AlteryxJupyter" />
        </Node>
        <Node ToolID="34">
          <GuiSettings Plugin="AlteryxBasePluginsGui.MultiFieldFormula.MultiFieldFormula">
            <Position x="367" y="414" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <FieldType>DateTime</FieldType>
              <Fields orderChanged="False">
                <Field name="report_month" />
                <Field name="DateTime" selected="False" />
                <Field name="*Unknown" selected="False" />
              </Fields>
              <CopyOutput value="False" />
              <Expression>ToString([_CurrentField_])</Expression>
              <ChangeFieldType value="True" />
              <OutputFieldType type="V_String" size="10" scale="0" />
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText>ToString([_CurrentField_])</DefaultAnnotationText>
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxMultiFieldFormula" />
        </Node>
        <Node ToolID="30">
          <GuiSettings Plugin="AlteryxBasePluginsGui.BrowseV2.BrowseV2">
            <Position x="535" y="390" />
          </GuiSettings>
          <Properties>
            <Configuration>
              <TempFile>C:\Users\HARSHA~1.DES\AppData\Local\Temp\Engine_7748_900ab9b996334a49b99e7fe12f240ad5_\Engine_12660_ce747487a64d4de1b78e47aca7020092_.yxdb</TempFile>
              <TempFileDataProfiling />
              <Layout>
                <ViewMode>Single</ViewMode>
                <ViewSize value="100" />
                <View1>
                  <DefaultTab>Profile</DefaultTab>
                  <Hints>
                    <Table />
                  </Hints>
                </View1>
                <View2 />
              </Layout>
            </Configuration>
            <Annotation DisplayMode="0">
              <Name />
              <DefaultAnnotationText />
              <Left value="False" />
            </Annotation>
          </Properties>
          <EngineSettings EngineDll="AlteryxBasePluginsEngine.dll" EngineDllEntryPoint="AlteryxBrowseV2" />
        </Node>
      </ChildNodes>
    </Node>
  </Nodes>
  <Connections>
    <Connection>
      <Origin ToolID="12" Connection="Output" />
      <Destination ToolID="16" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="12" Connection="Output" />
      <Destination ToolID="31" Connection="Targets" />
    </Connection>
    <Connection>
      <Origin ToolID="24" Connection="Output" />
      <Destination ToolID="31" Connection="Source" />
    </Connection>
    <Connection>
      <Origin ToolID="21" Connection="Output" />
      <Destination ToolID="22" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="27" Connection="Output" />
      <Destination ToolID="34" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="31" Connection="Output" />
      <Destination ToolID="27" Connection="Input" />
    </Connection>
    <Connection>
      <Origin ToolID="29" Connection="Output1" />
      <Destination ToolID="30" Connection="Input" />
    </Connection>
    <Connection name="#1">
      <Origin ToolID="34" Connection="Output" />
      <Destination ToolID="29" Connection="Input" />
    </Connection>
  </Connections>
  <Properties>
    <Memory default="True" />
    <GlobalRecordLimit value="0" />
    <TempFiles default="True" />
    <Annotation on="False" includeToolName="False" />
    <ConvErrorLimit value="10" />
    <ConvErrorLimit_Stop value="False" />
    <CancelOnError value="False" />
    <DisableBrowse value="False" />
    <EnablePerformanceProfiling value="False" />
    <PredictiveToolsCodePage value="1252" />
    <DisableAllOutput value="False" />
    <ShowAllMacroMessages value="False" />
    <ShowConnectionStatusIsOn value="True" />
    <ShowConnectionStatusOnlyWhenRunning value="True" />
    <ZoomLevel value="0" />
    <LayoutType>Horizontal</LayoutType>
    <MetaInfo>
      <NameIsFileName value="True" />
      <Name>0_PreRunChecks</Name>
      <Description />
      <RootToolName />
      <ToolVersion />
      <ToolInDb value="False" />
      <CategoryName />
      <SearchTags />
      <Author />
      <Company />
      <Copyright />
      <DescriptionLink actual="" displayed="" />
      <Example>
        <Description />
        <File />
      </Example>
      <WorkflowId value="496fbfa6-fd24-4a6c-aef4-52063fd5bd3f" />
      <Telemetry>
        <PreviousWorkflowId value="" />
        <OriginWorkflowId value="496fbfa6-fd24-4a6c-aef4-52063fd5bd3f" />
      </Telemetry>
    </MetaInfo>
    <Events>
      <Enabled value="True" />
    </Events>
  </Properties>
</AlteryxDocument>