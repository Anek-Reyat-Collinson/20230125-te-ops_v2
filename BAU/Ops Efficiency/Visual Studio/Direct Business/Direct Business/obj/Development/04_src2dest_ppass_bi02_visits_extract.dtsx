<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="2/6/2017 3:07:28 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="TCG02672"
  DTS:CreatorName="TCG\Vijay.Pattar"
  DTS:DTSID="{4E99A833-802D-4F7D-9B9D-4ED3B48A91B9}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.170"
  DTS:LocaleID="2057"
  DTS:ObjectName="04_src2dest_ppass_bi02_visits_extract"
  DTS:PackageType="5"
  DTS:VersionBuild="412"
  DTS:VersionGUID="{FC207B9A-35BD-4EC3-BF4D-7EA7D7FF984B}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="3"
      DTS:DTSID="{DB6FC861-5416-48AD-802F-CF8429AA24FE}"
      DTS:ObjectName="int_DataloadWorkFlowID">
      <DTS:Property
        DTS:DataType="3"
        DTS:Name="ParameterValue">0</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{1127DD94-0C59-4624-B6DC-498BED761D9A}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="dtEndDate">
      <DTS:VariableValue
        DTS:DataType="7">7/31/2018</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{1A39D528-498B-44D8-994B-19316AD09DD0}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="dtReportMonth">
      <DTS:VariableValue
        DTS:DataType="7">7/1/2018</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{99575F65-B9EC-462B-A955-0B1AB4E0A04A}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="dtStartDate">
      <DTS:VariableValue
        DTS:DataType="7">7/1/2018</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5037F3D3-0FB7-45D0-A8EF-4E500253BA0D}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="intApplicationDataloadWorkflowID">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{A5D7567F-32F9-4174-91AC-0526585FBEDD}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="intDataLoadID">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{68E78F03-C883-4EAE-A3C6-C56896891965}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="intDebug">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CFF2888A-C748-466B-AD64-0C49534E1B34}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="intRecInsertedCount">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{127794A9-DF43-4C61-A842-32B92AE5F945}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="intRecUpdatedCount">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{90F1FEE6-9D07-470F-8D4A-9F141BD1D251}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="intRecWithIssueCount">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{77758F19-A82A-4B0C-B9C2-EBC1600D29DA}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Package::int_DataloadWorkFlowID]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="int_DataloadWorkFlowID">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5028C464-1134-427F-92F7-42AC53265B6F}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Int_EnableWorkflow">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7B2EEFAE-EB5C-4B5E-9788-973CE60898CE}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Int_interation">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{49D003CE-0244-4C2E-A02E-60B06DE43A1B}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="int_Src_Qry_Counter">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{171FB994-F8E6-441B-B3B8-09731541A748}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="rsWorkflowStep_Configuration">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{4B8E59A9-275C-4C85-B52E-AC8C80259193}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="str">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{683627F4-61DD-410B-8C49-38EA1DC6F105}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strArchiveFileNameFormat">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5096C4FE-08AF-47B0-804A-BC2696C3B042}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[System::PackageName] + &quot; Fails to execute.&#xA;&#xA;Please, check Package and run again &#xA;&#xA;From  BI_DEV_TEAM&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strBody">
      <DTS:VariableValue
        DTS:DataType="8">04_src2dest_ppass_bi02_visits_extract Fails to execute.

Please, check Package and run again 

From  BI_DEV_TEAM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E629E38E-03E6-4D30-9F61-9E2D885D0FCD}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strClientName">
      <DTS:VariableValue
        DTS:DataType="8">Direct Business WS Tactical Billing</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{8C1BAC71-CDBC-4846-B993-964AE32EB2EA}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strCorruptFolder">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{2DB27C4E-981C-4833-8083-30D26FD458CD}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strDestinationFolder">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B324CC30-46BB-4DFC-91AD-A924554E84F0}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="(DT_WSTR,20) DateAdd(&quot;Month&quot;, 0,  @[User::dtEndDate])"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strEndDate_YMD">
      <DTS:VariableValue
        DTS:DataType="8">2018-07-31 00:00:00</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{333F38E9-BD25-4DBE-98BF-E7802372D0C7}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strFileName_Format_Export">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{455965FF-48A5-4AA2-8FDD-7429375072A5}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strFileName_Format_Import">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5E6745D8-A59C-4790-BBC9-FE5C110636F9}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Project::ToEmail]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strFromEmail">
      <DTS:VariableValue
        DTS:DataType="8">TE-BI@collinsongroup.com</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E2075ADB-19CE-4531-BCC7-3A479C223ACF}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::Int_EnableWorkflow] &gt;= 1 ?  &quot;By Pass&quot;:&quot;Complete&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strLoadCompletion">
      <DTS:VariableValue
        DTS:DataType="8">Complete</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7A66740A-8504-472E-8F9E-926A0E9A3950}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;IF OBJECT_ID('tempdb..##dbwsvisitsbysource') IS NOT NULL&#xA;    DROP TABLE ##dbwsvisitsbysource;&#xA;IF OBJECT_ID('tempdb..#dbwsvisitsbysourceraw') IS NOT NULL&#xA;    DROP TABLE #dbwsvisitsbysourceraw;&#xA;&#xA;DECLARE @StartDate AS DATE;&#xA;DECLARE @EndDate AS DATE;&#xA;&#xA;SET @StartDate = '&quot;+(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)+&quot;';&#xA;SET @EndDate = '&quot;+(DT_WSTR, 4) year( @[User::dtEndDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtEndDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtEndDate] ),2) +&quot;';&#xA;&#x9;&#xA;CREATE TABLE #dbwsvisitsbysourceraw (&#xA;&#x9;&#x9;source_code &#x9;&#x9;varchar(20),&#xA;&#x9;&#x9;consumer_no &#x9;&#x9;INT NOT NULL,&#xA;&#x9;&#x9;external_identifier BIGINT NULL,&#xA;&#x9;&#x9;membership_no &#x9;&#x9;BIGINT NULL,&#xA;&#x9;&#x9;purchase_no &#x9;&#x9;INT NOT NULL,&#xA;&#x9;&#x9;track_seq &#x9;&#x9;&#x9;INT NOT NULL,&#xA;&#x9;&#x9;title &#x9;&#x9;&#x9;&#x9;varchar(20),&#xA;&#x9;&#x9;forename &#x9;&#x9;&#x9;varchar(50),&#xA;&#x9;&#x9;surname &#x9;&#x9;&#x9;varchar(50),&#xA;&#x9;&#x9;fullname &#x9;&#x9;&#x9;varchar(120),&#xA;&#x9;&#x9;source_desc &#x9;&#x9;varchar(255),&#xA;&#x9;&#x9;product_version &#x9;varchar(20),&#xA;&#x9;&#x9;paid_to_date &#x9;&#x9;date,&#xA;&#x9;&#x9;subs_issue_date &#x9;date,&#xA;&#x9;&#x9;subs_status &#x9;&#x9;varchar(5),&#xA;&#x9;&#x9;track_start &#x9;&#x9;date,&#xA;&#x9;&#x9;track_start_full    datetime,  --&#xA;&#x9;&#x9;track_status        varchar(5),&#xA;&#x9;&#x9;cservice_centre     varchar(5),&#xA;&#x9;&#x9;sservicecentre      varchar(5),--&#xA;&#x9;&#x9;track_guests &#x9;&#x9;INT,&#xA;&#x9;&#x9;track_from &#x9;&#x9;&#x9;varchar(20),&#xA;&#x9;&#x9;track_value &#x9;&#x9;FLOAT,&#xA;&#x9;&#x9;creation_date &#x9;&#x9;date,&#xA;&#x9;&#x9;lounge_name&#x9;&#x9;&#x9;varchar(100),&#xA;&#x9;&#x9;airport &#x9;&#x9;&#x9;varchar(100),&#xA;&#x9;&#x9;trans_ccard_number &#x9;varchar(100),&#xA;&#x9;&#x9; unique_card_no &#x9;varchar(100),&#xA;&#x9;&#x9;external_ref &#x9;&#x9;varchar(100),&#xA;&#x9;&#x9;track_batch &#x9;&#x9;INT,&#xA;&#x9;&#x9;old_system_ref &#x9;&#x9;varchar(100),&#xA;&#x9;&#x9;campaign_code &#x9;&#x9;varchar(100),&#xA;&#x9;&#x9;lounge_code&#x9;&#x9;&#x9;varchar(20),&#xA;&#x9;&#x9;city &#x9;&#x9;&#x9;&#x9;varchar(100),&#xA;&#x9;&#x9;country &#x9;&#x9;&#x9;&#x9;varchar(100),&#xA;&#x9;&#x9;vendor_tracking_code &#x9;varchar(100),&#xA;&#x9;&#x9;user_invitation_code &#x9;varchar(100),&#xA;&#x9;&#x9;remaining_mem_cli_count int,&#xA;&#x9;&#x9;remaining_mem_cli2_count int,&#xA;&#x9;&#x9;remaining_mem_pp_count &#x9;int,&#xA;&#x9;&#x9;remaining_gue_cli_count int,&#xA;&#x9;&#x9;remaining_gue_cli2_count int,&#xA;&#x9;&#x9;remaining_gue_pp_count &#x9;int,&#xA;&#x9;&#x9;remaining_mgu_cli_count int,&#xA;&#x9;&#x9;remaining_mgu_cli2_count int,&#xA;&#x9;&#x9;remaining_mgu_pp_count &#x9;int,&#xA;&#x9;&#x9;remaining_mgu_comp_count int,&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;experience_category &#x9;varchar(100),&#xA;&#x9;&#x9;experience_type &#x9;&#x9;varchar(100),&#xA;&#x9;&#x9;airport_terminal_name  varchar(100),&#xA;&#x9;&#x9;airport_terminal_type  varchar(100),&#xA;&#x9;&#x9;visit_type&#x9;int&#xA;);&#xA;&#xA;&#xA;INSERT INTO #dbwsvisitsbysourceraw(&#x9;&#xA;&#x9;source_code,&#xA;&#x9;consumer_no,&#xA;&#x9;external_identifier,&#xA;&#x9;membership_no,&#xA;&#x9;purchase_no,&#xA;&#x9;track_seq,&#xA;&#x9;title,&#xA;&#x9;forename,&#xA;&#x9;surname,&#xA;&#x9;fullname,&#xA;&#x9;source_desc,&#xA;&#x9;product_version,&#xA;&#x9;paid_to_date,&#xA;&#x9;subs_issue_date,&#xA;&#x9;subs_status,&#xA;&#x9;track_start,&#xA;&#x9;track_start_full,&#xA;&#x9;track_status  ,  &#xA;&#x9;cservice_centre ,&#xA;&#x9;sservicecentre  ,&#xA;&#x9;track_guests,&#xA;&#x9;track_from,&#xA;&#x9;track_value,&#xA;&#x9;creation_date,&#xA;&#x9;lounge_name,&#xA;&#x9;airport,&#xA;&#x9;trans_ccard_number,&#xA;&#x9;unique_card_no,&#xA;&#x9;external_ref,&#xA;&#x9;track_batch,&#xA;&#x9;old_system_ref,&#xA;&#x9;campaign_code,&#xA;&#x9;lounge_code,&#xA;&#x9;city,&#xA;&#x9;country,&#xA;&#x9;vendor_tracking_code,&#xA;&#x9;user_invitation_code,&#xA;&#x9;remaining_mem_cli_count,&#xA;&#x9;remaining_mem_cli2_count,&#xA;&#x9;remaining_mem_pp_count,&#xA;&#x9;remaining_gue_cli_count,&#xA;&#x9;remaining_gue_cli2_count,&#xA;&#x9;remaining_gue_pp_count,&#xA;&#x9;remaining_mgu_cli_count,&#xA;&#x9;remaining_mgu_cli2_count,&#xA;&#x9;remaining_mgu_pp_count,&#xA;&#x9;remaining_mgu_comp_count,&#xA;&#x9;&#xA;&#x9;experience_category,&#xA;&#x9;experience_type,&#xA;&#x9;airport_terminal_name,&#xA;&#x9;airport_terminal_type,&#xA;&#x9;visit_type )&#xA;SELECT&#x9;s.source_code,&#xA;&#x9;&#x9;c.consumer_no,&#xA;&#x9;&#x9;c.external_identifier,&#xA;&#x9;&#x9;c.membership_no,&#xA;&#x9;&#x9;p.purchase_no,&#xA;&#x9;&#x9;t.track_seq,&#xA;&#x9;&#x9;c.title,&#xA;&#x9;&#x9;c.forename,&#xA;&#x9;&#x9;c.surname,&#xA;&#x9;&#x9;LTRIM(RTRIM(REPLACE(REPLACE(REPLACE(c.forename + ' ' + c.surname,' ',' |'),'| ',''),'|',''))) AS fullname,&#xA;&#x9;&#x9;s.source_desc,&#xA;&#x9;&#x9;p.product_version,&#xA;&#x9;&#x9;p.paid_to_date,&#xA;&#x9;&#x9;p.subs_issue_date,&#xA;&#x9;&#x9;p.subs_status,&#xA;&#x9;&#x9;t.track_start,&#xA;&#x9;&#x9;t.track_start_full,&#xA;&#x9;    t.track_status  ,  &#xA;&#x9;    c.service_centre ,&#xA;&#x9;    s.servicecentre  ,&#xA;&#x9;&#x9;t.track_guests,&#xA;&#x9;&#x9;t.track_from,&#xA;&#x9;&#x9;t.track_value,&#xA;&#x9;&#x9;t.creation_date,&#xA;&#x9;&#x9;l.lounge_name,&#xA;&#x9;&#x9;a.pp_short_name AS airport,&#xA;&#x9;&#x9;p.trans_ccard_number AS trans_ccard_number,&#xA;&#x9;&#x9;t.unique_card_no,&#xA;&#x9;&#x9;t.external_ref,&#xA;&#x9;&#x9;t.track_batch,&#xA;&#x9;&#x9;p.old_system_ref,&#xA;&#x9;&#x9;s.campaign_code,&#xA;&#x9;&#x9;l.lounge_code,&#xA;&#x9;&#x9;a.airport_city AS city,&#xA;&#x9;&#x9;cou.code_desc AS country,&#xA;&#x9;&#x9;siv.vendor_tracking_code,&#xA;&#x9;&#x9;siv.user_invitation_code,&#xA;&#x9;&#x9;0 AS remaining_mem_cli_count,&#xA;&#x9;&#x9;0 AS remaining_mem_cli2_count,&#xA; &#x9;&#x9;0 AS remaining_mem_pp_count,&#xA; &#x9;&#x9;0 AS remaining_gue_cli_count,&#xA; &#x9;&#x9;0 AS remaining_gue_cli2_count,&#xA; &#x9;&#x9;0 AS remaining_gue_pp_count,&#xA; &#x9;&#x9;0 AS remaining_mgu_cli_count,&#xA; &#x9;&#x9;0 AS remaining_mgu_cli2_count,&#xA; &#x9;&#x9;0 AS remaining_mgu_pp_count,&#xA; &#x9;&#x9;0 AS remaining_mgu_comp_count,&#xA; &#x9;&#x9;&#xA;&#x9;&#x9;'Lounge' as experience_category,&#xA;&#x9;&#x9;'Lounge' as experience_type,&#xA;&#x9;&#x9;ate.terminal_name as airport_terminal_name,&#xA;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;WHEN l.lounge_type = 'I' THEN 'I'&#xA;&#x9;&#x9;&#x9;WHEN l.lounge_type = 'D' THEN 'D'&#xA;&#x9;&#x9;&#x9;ELSE 'U'&#xA;&#x9;&#x9;  END&#x9;as airport_terminal_type,&#xA;&#x9;&#x9;t.visit_type_id&#xA;FROM&#xA;&#x9;&#x9;source_deal_config AS sdc WITH (NOLOCK)&#xA;&#x9;&#x9;INNER JOIN source AS s WITH (NOLOCK) ON sdc.source_code = s.source_code&#xA;&#x9;&#x9;INNER JOIN source_subscription AS ss WITH (NOLOCK) ON sdc.source_deal_config_id = ss.source_deal_config_id&#xA;&#x9;&#x9;INNER JOIN purchase_subscription_link AS psl WITH (NOLOCK) ON ss.source_subscription_id = psl.source_subscription_id&#xA;&#x9;&#x9;INNER JOIN purchase AS p WITH (NOLOCK) ON psl.purchase_no = p.purchase_no&#xA;&#x9;&#x9;INNER JOIN consumer AS c WITH (NOLOCK) ON p.consumer_no = c.consumer_no&#xA;&#x9;&#x9;INNER JOIN tracking AS t WITH (NOLOCK) ON p.purchase_no = t.purchase_no&#xA;&#x9;&#x9;INNER JOIN lounge AS l WITH (NOLOCK) ON l.lounge_code = t.track_from&#xA;&#x9;&#x9;INNER JOIN airport AS a WITH (NOLOCK) ON a.iso_airport_code = l.airport&#xA;&#x9;&#x9;LEFT OUTER JOIN airport_terminal AS ate WITH (NOLOCK) ON l.airport_terminal_id = ate.airport_terminal_id&#xA;&#x9;&#x9;LEFT OUTER JOIN code AS COU  WITH (NOLOCK) ON COU.code = l.country_code AND COU.codetype = 'CTRY'&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;LEFT OUTER JOIN source_invitation_validation siv WITH (NOLOCK) ON siv.consumer_no = c.consumer_no&#xA;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;sdc.source_code IN (&#xA;&quot;+@[User::strSource_Code_from_master] +&quot; )&#xA;&#x9;&#x9;AND t.creation_date&#xA;&#x9;&#x9;&#x9;BETWEEN @StartDate&#xA;&#x9; &#x9;&#x9;&#x9;AND @EndDate&#xA;&#x9; &#x9;AND t.track_status &lt;&gt; 'NA'&#xA;&#x9;&#x9;AND p.isDeleted = 0&#xA;&#xA;/* Load in the reedemed offers data */&#xA;INSERT INTO #dbwsvisitsbysourceraw (&#x9;&#xA;&#x9;source_code,&#xA;&#x9;consumer_no,&#xA;&#x9;external_identifier,&#xA;&#x9;membership_no,&#xA;&#x9;purchase_no,&#xA;&#x9;track_seq,&#xA;&#x9;title,&#xA;&#x9;forename,&#xA;&#x9;surname,&#xA;&#x9;fullname,&#xA;&#x9;source_desc,&#xA;&#x9;product_version,&#xA;&#x9;paid_to_date,&#xA;&#x9;subs_issue_date,&#xA;&#x9;subs_status,&#xA;&#x9;track_start,&#xA;&#x9;track_start_full,&#xA;&#x9;track_status  ,  &#xA;&#x9;cservice_centre ,&#xA;&#x9;sservicecentre  ,&#xA;&#x9;track_guests,&#xA;&#x9;track_from,&#xA;&#x9;track_value,&#xA;&#x9;creation_date,&#xA;&#x9;lounge_name,&#xA;&#x9;airport,&#xA;&#x9;trans_ccard_number,&#xA;&#x9;unique_card_no,&#xA;&#x9;external_ref,&#xA;&#x9;track_batch,&#xA;&#x9;old_system_ref,&#xA;&#x9;campaign_code,&#xA;&#x9;lounge_code,&#xA;&#x9;city,&#xA;&#x9;country,&#xA;&#x9;vendor_tracking_code,&#xA;&#x9;user_invitation_code,&#xA;&#x9;remaining_mem_cli_count,&#xA;&#x9;remaining_mem_cli2_count,&#xA;&#x9;remaining_mem_pp_count,&#xA;&#x9;remaining_gue_cli_count,&#xA;&#x9;remaining_gue_cli2_count,&#xA;&#x9;remaining_gue_pp_count,&#xA;&#x9;remaining_mgu_cli_count,&#xA;&#x9;remaining_mgu_cli2_count,&#xA;&#x9;remaining_mgu_pp_count,&#xA;&#x9;remaining_mgu_comp_count,&#xA;&#x9;experience_category,&#xA;&#x9;experience_type,&#xA;&#x9;airport_terminal_name,&#xA;&#x9;airport_terminal_type,&#xA;&#x9;visit_type )&#xA;SELECT&#xA;&#x9;s.source_code,&#xA;&#x9;c.consumer_no,&#xA;&#x9;c.external_identifier,&#xA;&#x9;c.membership_no,&#xA;&#x9;p.purchase_no,&#xA;&#x9;t.track_seq,&#xA;&#x9;c.title,&#xA;&#x9;c.forename,&#xA;&#x9;c.surname,&#xA;&#x9;LTRIM(RTRIM(REPLACE(REPLACE(REPLACE(c.forename + ' ' + c.surname,' ',' |'),'| ',''),'|',''))) AS fullname,&#xA;&#x9;s.source_desc,&#xA;&#x9;p.product_version,&#xA;&#x9;p.paid_to_date,&#xA;&#x9;p.subs_issue_date,&#xA;&#x9;p.subs_status,&#xA;&#x9;t.track_start,&#xA;&#x9;t.track_start_full,&#xA;&#x9;t.track_status  ,  &#xA;&#x9;c.service_centre ,&#xA;&#x9;s.servicecentre  ,&#xA;&#x9;t.track_guests,&#xA;&#x9;t.track_from,&#xA;&#x9;t.track_value,&#xA;&#x9;t.creation_date,&#xA;&#x9;ord.outlet_name as lounge_name,&#xA;&#x9;a.pp_short_name AS airport,&#xA;&#x9;p.trans_ccard_number AS trans_ccard_number,&#xA;&#x9;t.unique_card_no,&#xA;&#x9;t.external_ref,&#xA;&#x9;t.track_batch,&#xA;&#x9;p.old_system_ref,&#xA;&#x9;s.campaign_code,&#xA;&#x9;t.track_from as lounge_code,&#xA;&#x9;a.airport_city AS city,&#xA;&#x9;cou.code_desc AS country,&#xA;&#x9;siv.vendor_tracking_code,&#xA;&#x9;siv.user_invitation_code,&#xA;&#x9;0 AS remaining_mem_cli_count , &#xA;&#x9;0 AS remaining_mem_cli2_count , &#xA;&#x9;0 AS remaining_mem_pp_count , &#xA;&#x9;0 AS remaining_gue_cli_count , &#xA;&#x9;0 AS remaining_gue_cli2_count , &#xA;&#x9;0 AS remaining_gue_pp_count , &#xA;&#x9;0 AS remaining_mgu_cli_count , &#xA;&#x9;0 AS remaining_mgu_cli2_count , &#xA;&#x9;0 AS remaining_mgu_pp_count , &#xA;&#x9;0 AS remaining_mgu_comp_count,&#xA;&#x9;&#xA;&#x9;ord.offer_category as experience_category,&#xA;&#x9;&#x9;ord.offer_type as experience_type,&#xA;&#x9;ISNULL(ate.terminal_name, 'Unknown' ) as airport_terminal_name,&#xA;&#x9;'U' as airport_terminal_type,&#xA;&#x9;t.visit_type_id&#xA;FROM&#xA;&#x9;source_deal_config AS sdc WITH (NOLOCK)&#xA;&#x9;INNER JOIN source AS s WITH (NOLOCK) ON sdc.source_code = s.source_code&#xA;&#x9;INNER JOIN source_subscription AS ss WITH (NOLOCK) ON sdc.source_deal_config_id = ss.source_deal_config_id&#xA;&#x9;INNER JOIN purchase_subscription_link AS psl WITH (NOLOCK) ON ss.source_subscription_id = psl.source_subscription_id&#xA;&#x9;INNER JOIN purchase AS p WITH (NOLOCK) ON psl.purchase_no = p.purchase_no&#xA;&#x9;INNER JOIN consumer AS c WITH (NOLOCK) ON p.consumer_no = c.consumer_no&#xA;&#x9;INNER JOIN tracking AS t WITH (NOLOCK) ON p.purchase_no = t.purchase_no&#xA;&#x9;INNER JOIN offer_redemption_details AS ord WITH (NOLOCK) ON ord.consumer_no = c.consumer_no AND ord.track_seq = t.track_seq&#xA;&#x9;INNER JOIN airport AS a WITH (NOLOCK) ON a.iso_airport_code = ord.airport_iso_code&#xA;&#x9;LEFT JOIN outlet_airport_terminal AS oat WITH (NOLOCK) ON ord.outlet_id = oat.outlet_id&#xA;&#x9;LEFT JOIN airport_terminal AS ate WITH (NOLOCK) ON oat.airport_terminal_id = ate.airport_terminal_id&#xA;&#x9;LEFT OUTER JOIN code AS COU WITH (NOLOCK) ON cou.alpha_1 = a.iso_country_code&#xA;&#x9;&#x9;AND cou.codetype = 'CTRY2'&#xA;&#x9;&#x9;AND cou.alpha_5 &lt;&gt; ''&#xA;&#x9;LEFT OUTER JOIN source_invitation_validation siv WITH (NOLOCK) ON siv.consumer_no = c.consumer_no&#xA;&#x9;&#xA;WHERE&#xA;&#x9;&#x9;sdc.source_code IN (&quot;+@[User::strSource_Code_from_master] +&quot; )&#xA;&#x9;AND t.creation_date&#xA;&#x9;&#x9;BETWEEN @StartDate&#xA; &#x9;&#x9;&#x9;AND @EndDate&#xA; &#x9;AND t.track_status &lt;&gt; 'NA'&#xA;&#x9;AND p.isDeleted = 0&#xA;&#x9;&#xA;&#xA;/* update the temp table with an index */&#xA;CREATE CLUSTERED INDEX dbwsvisitsbysourceraw_idx1 ON #dbwsvisitsbysourceraw(purchase_no, track_seq);&#xA;CREATE NONCLUSTERED INDEX dbwsvisitsbysourceraw_idx2 ON #dbwsvisitsbysourceraw (source_code, consumer_no, fullname, track_start, lounge_name, external_ref) &#xA;WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 100) ON [PRIMARY]&#xA;&#xA;&#x9;&#x9;/*  MEM PPAYVISIT  */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;           &#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no;&#xA;&#xA;&#x9;/* MEM CPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw #dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no;&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;/* MEM CPAYVISIT2 */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* GUE PPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* GUE CPAYLIST */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* GUE CPAYVISIT2 */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/*MGU PPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 3&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 3&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;/* MGU CPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 3&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 3&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* MGU CPAYVISIT2 */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 3&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 3&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* SHAREDMEM PPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 8&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 8&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* SHAREDMEM CPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 8&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 8&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;/* SHAREDMEM CPAYVISIT2 */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 8&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 8&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* SHAREDGUE PPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 9&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 9&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* SHAREDGUE CPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 9&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 9&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#xA;/* SHAREDGUE CPAYVISIT2 */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 9&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 9&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;/* SHAREDMGU PPAYVISIT */&#xA;&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 10&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 10&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;/* SHAREDMGU CPAYVISIT */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 10&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 10&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;/*SHAREDMGU CPAYVISIT2 */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 10&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 10&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;/*OFFERMEM PPAYVISIT */&#xA;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 6&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 6&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;/* OFFERMEMCPAYLIST */&#xA;&#x9;&#x9;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 6&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 6&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;/* OFFERMEMCPAYLIST2 */&#xA;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 6&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 6&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MEM_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;/* OFFERGUEPPAYLIST */&#xA;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 5&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 5&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;/* OFFERGUECPAYLIST */&#xA;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 5&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 5&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;/* OFFERGUECPAYLIST2 */&#xA;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 5&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 5&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_GUE_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;/* OFFERMGUPPAYLIST */&#xA;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 7&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 21&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 7&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_PP_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;/* OFFERMGUCPAYLIST */&#xA;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 7&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 22&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 7&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_CLI_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;/* OFFERMGUCPAYLIST2 */&#xA;;WITH used_visit_allocations AS (&#xA;            &#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;COUNT(1) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase_visit_allocation_his AS pvah2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXISTS (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw temp2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;temp2.purchase_no = pval2.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pvah2.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva2.visitor_type_id = 7&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND salg.guest_source_visit_allocation_id is NULL&#xA;&#x9;&#x9;&#x9;&#x9;GROUP BY&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pvah2.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;derived_visit_allocation AS (&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_from,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_count_to,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pva.visit_validity_type_id,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN pva.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(pva.visit_count_to - pva.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE (pva.visit_count_to - pva.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS allocated_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;purchase pur&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.charge_owner_id = 25&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visitor_type_id = 7&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.visit_allocation_type_id NOT IN (3,4)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND pur.isDeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id&#xA;               &#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(&#x9;pva.valid_from &lt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND pva.valid_to &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;OR pva.visit_validity_type_id = 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;calculated_visit_allocation AS&#xA;&#x9;&#x9;&#x9;(&#xA;&#x9;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CASE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_to = 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN 9999&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHEN derived_visit_allocation.visit_count_from = 0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;THEN&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ELSE&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;END&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;END AS visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;derived_visit_allocation.purchase_no&#xA;&#x9;&#x9;&#x9;&#x9;FROM derived_visit_allocation&#xA;&#x9;&#x9;&#x9;)&#xA;&#xA;&#x9;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;&#x9;remaining_MGU_CLI2_count = calculated_visit_allocation.visit_number&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no&#xA;&#x9;&#x9;;WITH derived_credit_data AS (&#xA;&#x9;&#x9;&#x9;SELECT&#xA;&#x9;&#x9;&#x9;&#x9;ISNULL(SUM(CASE WHEN vch.purchase_visit_allocation_his_id IS NULL THEN 1 ELSE 0 END),0) AS unused_visit,&#xA;&#x9;&#x9;&#x9;&#x9;ISNULL(SUM(CASE WHEN vch.purchase_visit_allocation_his_id IS NOT NULL THEN 1 ELSE 0 END),0) AS used_visit,&#xA;&#x9;&#x9;&#x9;&#x9;pval.purchase_no&#xA;&#x9;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;&#x9;visit_credit_his AS vch&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN visit_credit AS vc ON vch.visit_credit_id = vc.visit_credit_id&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN visit_credit_purchase_allocation AS vcpa ON vch.visit_credit_his_id = vcpa.visit_credit_his_id&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation AS pva ON vcpa.purchase_visit_allocation_id = pva.purchase_visit_allocation_id&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_grp AS pvag ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;&#x9;INNER JOIN purchase_visit_allocation_link AS pval ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA;&#x9;&#x9;&#x9;WHERE&#xA;&#x9;&#x9;&#x9;&#x9;vch.isdeleted = 0&#xA;&#x9;&#x9;&#x9;&#x9;AND vch.expiry_date &gt;= GETDATE()&#xA;&#x9;&#x9;&#x9;&#x9;AND vc.visit_credit_type_id = 1&#xA;&#x9;&#x9;&#x9;&#x9;AND vc.visitor_type_id = 3&#xA;&#x9;&#x9;&#x9;GROUP BY pval.purchase_no&#xA;&#x9;&#x9;)&#xA;&#x9;&#x9;UPDATE&#xA;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;SET&#xA;&#x9;&#x9;&#x9;REMAINING_MGU_COMP_COUNT = derived_credit_data.unused_visit&#xA;&#x9;&#x9;FROM&#xA;&#x9;&#x9;&#x9;#dbwsvisitsbysourceraw&#xA;&#x9;&#x9;&#x9;INNER JOIN derived_credit_data ON #dbwsvisitsbysourceraw.purchase_no = derived_credit_data.purchase_no&#xA;&#x9;&#x9;&#xA;&#xA;/* Get the data to return */&#xA;SELECT CAST(CONCAT(YEAR(temp.creation_date) , '-' , MONTH(temp.creation_date) , '-01' ) AS DATE)&#x9; AS&#x9;[report_month],&#xA; &#x9;FORMAT(CAST('&quot;+ &#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;  +&quot;' AS DATE), 'MMM-yy') AS [Process month]&#x9;&#xA;&#x9;,temp.source_code&#x9;&#x9;&#x9;&#x9;&#x9;AS Source_Code&#xA;    ,temp.source_desc                   AS Source_code_desc&#xA;&#x9;,temp.external_identifier&#x9;&#x9;&#x9;AS Member_No&#xA;    ,temp.consumer_no                   AS consumer_no &#xA;    ,temp.purchase_no                   AS purchase_no&#xA;&#x9;,temp.trans_ccard_number            AS CCard_No&#xA;&#x9;,CASE WHEN CHARINDEX('*', temp.unique_card_no) &gt; 0 THEN NULL&#xA;&#x9; WHEN temp.consumer_no IS NOT NULL THEN NULL&#xA;&#x9; ELSE temp.unique_card_no&#xA;     END AS ppid&#xA;    ,CASE WHEN CHARINDEX('*', temp.unique_card_no) &gt; 0 THEN LEFT(temp.trans_ccard_number, 10) ELSE NULL END  AS bin&#xA;&#x9;,temp.title&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;    AS Title&#xA;&#x9;,temp.forename&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS First_Name&#xA;&#x9;,temp.surname&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Last_Name&#xA;&#x9;,temp.product_version&#x9;&#x9;&#x9;&#x9;AS Membership_Plan&#xA;&#x9;,temp.subs_status&#x9;&#x9;&#x9;&#x9;&#x9;AS Member_Status&#xA;&#x9;,temp.paid_to_date&#x9;&#x9;&#x9;&#x9;&#x9;AS Paid_To_date&#xA;&#x9;,temp.track_start&#x9;&#x9;&#x9;&#x9;&#x9;AS Visit_Date&#xA;&#x9;,temp.[track_start_full]            AS Visit_Date2&#xA;&#x9;,temp.creation_date&#x9;&#x9;&#x9;    &#x9;AS Date_Processed&#xA;&#x9;,temp.track_status                  AS Visit_status&#xA;&#x9;,temp.track_seq                     AS Visit_seq&#xA;&#x9;,temp.track_guests&#x9;&#x9;&#x9;&#x9;&#x9;AS GuestVisits&#xA;&#x9;,temp.track_batch&#x9;&#x9;&#x9;&#x9;&#x9;AS Batch_No&#xA;    ,temp.cservice_centre               AS consumer_service_centre&#xA;    ,temp.sservicecentre                AS deal_service_centre&#xA;   ,COALESCE(NULLIF(temp.sservicecentre, ''), NULLIF(temp.cservice_centre, '')) AS retail_client_service_centre&#xA;&#x9;,temp.external_ref&#x9;&#x9;&#x9;&#x9;&#x9;AS Reference&#xA;&#x9;,temp.track_from&#x9;&#x9;&#x9;&#x9;&#x9;AS Lounge_Code&#xA;&#x9;,temp.lounge_name&#x9;&#x9;&#x9;&#x9;&#x9;AS Lounge&#xA;&#x9;,case when temp.airport_terminal_type='I' then 'International' &#xA;&#x9;      when temp.airport_terminal_type='D' then 'Domestic'&#xA;&#x9;&#x9;  when temp.airport_terminal_type='U' then 'Unknown'&#xA;&#x9;&#x9;   else temp.airport_terminal_type end AS domestic_int_lounge&#xA;&#x9;,temp.airport&#x9;  &#x9;   &#x9;AS Airport&#xA;&#x9;,temp.city &#x9;&#x9;&#x9;  &#x9;AS City&#xA;&#x9;,temp.country&#x9;&#x9;&#x9;   &#x9;AS Country&#xA;    , pvsd.count_mem_cli          AS Client_Pays_Member_Visit&#xA;    , pvsd.[count_mem_cli2]         AS Client_2_Pays_Member_Visit&#xA;    , pvsd.[count_mem_pp]           AS Inclusive_PP_Member_Visit&#xA;    , pvsd.[count_mem_comp]         AS Complimentary_Member_Visit&#xA;    , pvsd.[count_mem_mem]          AS Cardholder_Pays_Member_Visit&#xA;    , pvsd.[count_gue_cli]          AS Client_Pays_Guest_Visit&#xA;    , pvsd.[count_gue_cli2]         AS Client_2_Pays_Guest_Visit&#xA;    , pvsd.[count_gue_pp]           AS Inclusive_PP_Guest_Visit&#xA;    , pvsd.[count_gue_comp]         AS Complimentary_Guest_Visit&#xA;    , pvsd.[count_gue_mem]          AS Cardholder_Pays_Guest_Visit&#xA;    , pvsd.[count_gue_lou]          AS Lounge_Visit_Offer&#xA;&#x9;,temp.remaining_mem_cli_count&#x9;AS Client_Member&#xA;&#x9;,temp.remaining_mem_cli2_count &#x9;AS Client_2_Member&#xA;&#x9;,temp.remaining_mem_pp_count &#x9;AS Inclusive_PP_Member&#xA;&#x9;,temp.remaining_gue_cli_count &#x9;AS Client_Guest&#xA;&#x9;,temp.remaining_gue_cli2_count &#x9;AS Client_2_Guest&#xA;&#x9;,temp.remaining_gue_pp_count&#x9;AS Inclusive_PP_Guest&#xA;&#x9;,temp.remaining_mgu_cli_count &#x9;AS Client_Member_Guest&#xA;&#x9;,temp.remaining_mgu_cli2_count &#x9;AS Client_2_Member_Guest&#xA;&#x9;,temp.remaining_mgu_pp_count &#x9;AS Inclusive_PP_Member_Guest&#xA;&#x9;,temp.remaining_mgu_comp_count &#x9;AS Complimentary_Member_Guest&#xA;&#x9;,pvsd.[fee_mem_cli_curr]&#x9;&#x9;AS Client_Visit_Currency_Member&#xA;&#x9;,pvsd.[fee_mem_cli]&#x9;&#x9;&#x9;&#x9;AS Client_Visit_Amount_Member&#xA;&#x9;,pvsd.[fee_gue_cli_curr]&#x9;&#x9;AS Client_Visit_Currency_Guest&#xA;&#x9;,pvsd.[fee_gue_cli]&#x9;&#x9;&#x9;&#x9;AS Client_Visit_Amount_Guest&#xA;&#x9;,pvsd. [fee_mem_cli2_curr]      AS Client_2_Visit_Currency_Member&#xA;    ,pvsd. [fee_mem_cli2]           AS Client_2_Visit_Amount_Member&#xA;    ,pvsd. [fee_gue_cli2_curr]      AS Client_2_Visit_Currency_Guest&#xA;    ,pvsd. [fee_gue_cli2]           AS Client_2_Visit_Amount_Guest&#xA;&#x9;, CASE&#xA;        WHEN LEN(pvsd.[fee_mem_cli_curr]) &gt; 0&#xA;            THEN pvsd.[fee_mem_cli_curr]&#xA;        WHEN LEN(pvsd.[fee_gue_cli_curr]) &gt; 0&#xA;            THEN pvsd.[fee_gue_cli_curr]&#xA;        ELSE&#xA;            ' '&#xA;    END                                                                                                            AS Total_Client_Amount_Currency&#xA;  , CASE&#xA;        WHEN LEN(pvsd.[fee_mem_cli2_curr]) &gt; 0&#xA;            THEN pvsd.[fee_mem_cli2_curr]&#xA;        WHEN LEN(pvsd.[fee_gue_cli2_curr]) &gt; 0&#xA;            THEN pvsd.[fee_gue_cli2_curr]&#xA;        ELSE&#xA;            ' '&#xA;    END                                                                                                            AS Total_Client_2_Amount_Currency&#xA;  , CASE&#xA;        WHEN (pvsd.fee_mem_cli_curr = pvsd.fee_gue_cli_curr)&#xA;             AND LEN(pvsd.fee_mem_cli_curr) &gt; 0&#xA;            THEN pvsd.fee_mem_cli + pvsd.fee_gue_cli&#xA;        WHEN LEN(pvsd.fee_mem_cli_curr) &gt; 0&#xA;            THEN pvsd.fee_mem_cli&#xA;        WHEN LEN(pvsd.fee_gue_cli_curr) &gt; 0&#xA;            THEN pvsd.fee_gue_cli&#xA;        ELSE&#xA;            0.00&#xA;    END                                                                                                            AS Total_Client_Amount&#xA;  , CASE&#xA;        WHEN (pvsd.fee_mem_cli2_curr = pvsd.fee_gue_cli2_curr)&#xA;             AND LEN(pvsd.fee_mem_cli2_curr) &gt; 0&#xA;            THEN pvsd.fee_mem_cli2 + pvsd.fee_gue_cli2&#xA;        WHEN LEN(pvsd.fee_mem_cli2_curr) &gt; 0&#xA;            THEN pvsd.fee_mem_cli2&#xA;        WHEN LEN(pvsd.fee_gue_cli2_curr) &gt; 0&#xA;            THEN pvsd.fee_gue_cli2&#xA;        ELSE&#xA;            0.00&#xA;    END                                                                                                            AS Total_Client_2_Amount&#xA;&#x9;,pvsd.fee_mem_mem_curr&#x9;AS Cardholder_Visit_Currency_Member&#x9;&#xA;&#x9;,pvsd.fee_mem_mem&#x9;&#x9;AS Cardholder_Visit_Amount_Member&#x9;&#xA;&#x9;,pvsd.fee_gue_mem_curr&#x9;AS Cardholder_Visit_Currency_Guest&#x9;&#xA;&#x9;,pvsd.fee_gue_mem&#x9;&#x9;AS Cardholder_Visit_Amount_Guest&#x9;&#xA;&#x9;,CASE &#xA;&#x9;&#x9;WHEN Len(pvsd.fee_mem_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_mem_mem_curr&#xA;&#x9;&#x9;WHEN Len(pvsd.fee_gue_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_gue_mem_curr&#xA;&#x9;&#x9;ELSE ' '&#xA;    END&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Total_Cardholder_Amount_Currency&#x9;&#xA;&#x9;,CASE &#xA;&#x9;&#x9;WHEN (pvsd.fee_mem_mem_curr = pvsd.fee_gue_mem_curr) AND Len(pvsd.fee_mem_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_mem_mem + pvsd.fee_gue_mem&#xA;&#x9;&#x9;WHEN Len(pvsd.fee_mem_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_mem_mem&#xA;&#x9;&#x9;WHEN Len(pvsd.fee_gue_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_gue_mem&#xA;&#x9;&#x9;ELSE 0.00&#xA;&#x9;END&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Total_Cardholder_Amount&#x9;&#xA;&#x9;,left(temp.old_system_ref,10)&#x9;&#x9;&#x9;AS Cost_Centre&#x9;&#xA;&#x9;,temp.campaign_code&#x9;&#x9;&#x9;&#x9;&#x9;AS Campaign_Code&#x9;&#xA;&#x9;,temp.vendor_tracking_code&#x9;&#x9;&#x9;AS Vendor_Code&#x9;&#xA;&#x9;,left(temp.user_invitation_code,10)&#x9;&#x9;&#x9;AS User_Invitation_Code&#x9;&#xA;&#x9;,case when CHARINDEX(temp.track_from,temp. external_ref) &gt; 0 then  substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, '') ,7,50),1,2)+ ':' + substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, '') ,7,50),3,2) + ':' + substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, '') ,7,50),5,2) +'.' + case when (SUBSTRING(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, ''),7,50),7,3) ='' OR ISDATE(substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, '') ,7,50),7,3))&lt;&gt;1)then '000' else substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, ''),7,50),7,3) end&#x9;else '00:00:00.000' END as VisitTime&#xA;&#x9;,CAST(CAST(ISNULL(temp.external_identifier,'') AS NVARCHAR(max))+ISNULL(convert(varchar,temp.track_start,12),'')+ISNULL(temp.track_from,'') AS NVARCHAR(25)) Unique_reference&#xA;&#x9;,0 as entitlement_client_pays_member_visit&#xA;&#x9;,0 as entitlement_inclusive_PP_member_visit&#xA;&#x9;,0 as entitlement_client_guest_linked_guest_allocation&#xA;&#x9;,0 as entitlement_linked_guest_entitlement_per_visit&#xA;&#x9;,0 as entitlement_inclusive_PP_guest_visit&#xA;&#x9;,0 as entitlement_client_member_guest_visit&#xA;&#x9;,0 as entitlement_complimentary_member_guest_visit&#xA;&#x9;,0 as entitlement_inclusive_PP_member_guest_visit&#xA;&#x9;into ##dbwsvisitsbysource&#xA;FROM&#xA;&#x9;#dbwsvisitsbysourceraw AS temp&#xA;&#x9;INNER JOIN purchase_visit_summary_data AS pvsd WITH (NOLOCK) ON temp.purchase_no = pvsd.purchase_no AND temp.track_seq = pvsd.track_seq&#xA;ORDER BY&#xA;&#x9;temp.source_code,&#xA;&#x9;temp.consumer_no,&#xA;&#x9;temp.fullname,&#xA;&#x9;temp.track_seq,&#xA;&#x9;temp.track_start,&#xA;&#x9;temp.lounge_name,&#xA;&#x9;temp.external_ref ASC&#xA;&#x9;&#xA;&#x9;IF OBJECT_ID('tempdb..#dbwsvisitsbysource') IS NOT NULL&#xA;    DROP TABLE #dbwsvisitsbysource;&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strPPDB_Source_Query">
      <DTS:VariableValue
        DTS:DataType="8">IF OBJECT_ID('tempdb..##dbwsvisitsbysource') IS NOT NULL
    DROP TABLE ##dbwsvisitsbysource;
IF OBJECT_ID('tempdb..#dbwsvisitsbysourceraw') IS NOT NULL
    DROP TABLE #dbwsvisitsbysourceraw;

DECLARE @StartDate AS DATE;
DECLARE @EndDate AS DATE;

SET @StartDate = '2018-07-01';
SET @EndDate = '2018-07-31';
	
CREATE TABLE #dbwsvisitsbysourceraw (
		source_code 		varchar(20),
		consumer_no 		INT NOT NULL,
		external_identifier BIGINT NULL,
		membership_no 		BIGINT NULL,
		purchase_no 		INT NOT NULL,
		track_seq 			INT NOT NULL,
		title 				varchar(20),
		forename 			varchar(50),
		surname 			varchar(50),
		fullname 			varchar(120),
		source_desc 		varchar(255),
		product_version 	varchar(20),
		paid_to_date 		date,
		subs_issue_date 	date,
		subs_status 		varchar(5),
		track_start 		date,
		track_start_full    datetime,  --
		track_status        varchar(5),
		cservice_centre     varchar(5),
		sservicecentre      varchar(5),--
		track_guests 		INT,
		track_from 			varchar(20),
		track_value 		FLOAT,
		creation_date 		date,
		lounge_name			varchar(100),
		airport 			varchar(100),
		trans_ccard_number 	varchar(100),
		 unique_card_no 	varchar(100),
		external_ref 		varchar(100),
		track_batch 		INT,
		old_system_ref 		varchar(100),
		campaign_code 		varchar(100),
		lounge_code			varchar(20),
		city 				varchar(100),
		country 				varchar(100),
		vendor_tracking_code 	varchar(100),
		user_invitation_code 	varchar(100),
		remaining_mem_cli_count int,
		remaining_mem_cli2_count int,
		remaining_mem_pp_count 	int,
		remaining_gue_cli_count int,
		remaining_gue_cli2_count int,
		remaining_gue_pp_count 	int,
		remaining_mgu_cli_count int,
		remaining_mgu_cli2_count int,
		remaining_mgu_pp_count 	int,
		remaining_mgu_comp_count int,
		
		experience_category 	varchar(100),
		experience_type 		varchar(100),
		airport_terminal_name  varchar(100),
		airport_terminal_type  varchar(100),
		visit_type	int
);


INSERT INTO #dbwsvisitsbysourceraw(	
	source_code,
	consumer_no,
	external_identifier,
	membership_no,
	purchase_no,
	track_seq,
	title,
	forename,
	surname,
	fullname,
	source_desc,
	product_version,
	paid_to_date,
	subs_issue_date,
	subs_status,
	track_start,
	track_start_full,
	track_status  ,  
	cservice_centre ,
	sservicecentre  ,
	track_guests,
	track_from,
	track_value,
	creation_date,
	lounge_name,
	airport,
	trans_ccard_number,
	unique_card_no,
	external_ref,
	track_batch,
	old_system_ref,
	campaign_code,
	lounge_code,
	city,
	country,
	vendor_tracking_code,
	user_invitation_code,
	remaining_mem_cli_count,
	remaining_mem_cli2_count,
	remaining_mem_pp_count,
	remaining_gue_cli_count,
	remaining_gue_cli2_count,
	remaining_gue_pp_count,
	remaining_mgu_cli_count,
	remaining_mgu_cli2_count,
	remaining_mgu_pp_count,
	remaining_mgu_comp_count,
	
	experience_category,
	experience_type,
	airport_terminal_name,
	airport_terminal_type,
	visit_type )
SELECT	s.source_code,
		c.consumer_no,
		c.external_identifier,
		c.membership_no,
		p.purchase_no,
		t.track_seq,
		c.title,
		c.forename,
		c.surname,
		LTRIM(RTRIM(REPLACE(REPLACE(REPLACE(c.forename + ' ' + c.surname,' ',' |'),'| ',''),'|',''))) AS fullname,
		s.source_desc,
		p.product_version,
		p.paid_to_date,
		p.subs_issue_date,
		p.subs_status,
		t.track_start,
		t.track_start_full,
	    t.track_status  ,  
	    c.service_centre ,
	    s.servicecentre  ,
		t.track_guests,
		t.track_from,
		t.track_value,
		t.creation_date,
		l.lounge_name,
		a.pp_short_name AS airport,
		p.trans_ccard_number AS trans_ccard_number,
		t.unique_card_no,
		t.external_ref,
		t.track_batch,
		p.old_system_ref,
		s.campaign_code,
		l.lounge_code,
		a.airport_city AS city,
		cou.code_desc AS country,
		siv.vendor_tracking_code,
		siv.user_invitation_code,
		0 AS remaining_mem_cli_count,
		0 AS remaining_mem_cli2_count,
 		0 AS remaining_mem_pp_count,
 		0 AS remaining_gue_cli_count,
 		0 AS remaining_gue_cli2_count,
 		0 AS remaining_gue_pp_count,
 		0 AS remaining_mgu_cli_count,
 		0 AS remaining_mgu_cli2_count,
 		0 AS remaining_mgu_pp_count,
 		0 AS remaining_mgu_comp_count,
 		
		'Lounge' as experience_category,
		'Lounge' as experience_type,
		ate.terminal_name as airport_terminal_name,
		CASE
			WHEN l.lounge_type = 'I' THEN 'I'
			WHEN l.lounge_type = 'D' THEN 'D'
			ELSE 'U'
		  END	as airport_terminal_type,
		t.visit_type_id
FROM
		source_deal_config AS sdc WITH (NOLOCK)
		INNER JOIN source AS s WITH (NOLOCK) ON sdc.source_code = s.source_code
		INNER JOIN source_subscription AS ss WITH (NOLOCK) ON sdc.source_deal_config_id = ss.source_deal_config_id
		INNER JOIN purchase_subscription_link AS psl WITH (NOLOCK) ON ss.source_subscription_id = psl.source_subscription_id
		INNER JOIN purchase AS p WITH (NOLOCK) ON psl.purchase_no = p.purchase_no
		INNER JOIN consumer AS c WITH (NOLOCK) ON p.consumer_no = c.consumer_no
		INNER JOIN tracking AS t WITH (NOLOCK) ON p.purchase_no = t.purchase_no
		INNER JOIN lounge AS l WITH (NOLOCK) ON l.lounge_code = t.track_from
		INNER JOIN airport AS a WITH (NOLOCK) ON a.iso_airport_code = l.airport
		LEFT OUTER JOIN airport_terminal AS ate WITH (NOLOCK) ON l.airport_terminal_id = ate.airport_terminal_id
		LEFT OUTER JOIN code AS COU  WITH (NOLOCK) ON COU.code = l.country_code AND COU.codetype = 'CTRY'
		
		LEFT OUTER JOIN source_invitation_validation siv WITH (NOLOCK) ON siv.consumer_no = c.consumer_no
	WHERE
			sdc.source_code IN (
'2WLS12','2WLS14','ABC13','ABRSM10','AFA14','AIF11','AIRPLUS09','AIRTELGBN14','AIRTELGHA14','AIRTELKEN14','AIRTELMAD14','AIRTELMAL14','AIRTELNGR14','AIRTELNGR214','AIRTELNIGER14','AIRTELRWA14','AIRTELSEY14','AIRTELTANZ14','AIRTELTCHAD14','AIRTELZAM14','AKCB2011','ALJOUF15','ALRAJHI15','AMEELY12','AMEXSAU10','APE08','ASI13','AVISE07','AXTMRP08','B2U14','BAML13','BCCGDLS10','BCCGLS15','BCCPLATLS10','BCCPLS15','BPSHIP0710','CANON11','CCIT13','CEO13','CGSTAFFCOMP','CITI13','CITI14','COL02','COL06','COMZ0208,PPCOMMBK,PPCOMMERZ,PPCOMMERZ1','CORN02','CORNER13','DANFOSS14','DEXIA09','DREL2010','EMIRITG11','EUROPCAREN14','EZE13','FESTO13','FMDL12','FNB2011','GOMEXICO12','GRUN1511','HBSWEBUS10MC','HBSWEBUS10VS','HONEYWELL08','IAAT2015','KEYSLSTY2015','KEYSLSTY22015','LIBERTY15','LTSB0410','LTSB06','LTSB1010','MARD08','MBNA05','MCCOMP5FREE','MEHR09','MELIA2015','MOBILY13','MWSG1008','NBB13','NEB13','NMMS07','NO1T2010','NORD09','NORDICCORPAX06','NOV2015','OOREDOO15','OOREDOOMAL15','OOREDOOMALINV15','ORAG08','PORTAMEX06','PPACCIST17','PPAMIST2016','PPASLHVSP16','PPATPPG18','PPAXAST616','PPBARVSINF16','PPBPFPG16','PPBPFSP16','PPBSBE216','PPBU022015','PPBU062015','PPBU102015','PPBUPAPG17','PPCRSP16','PPDRGPPG17','PPDRGPSP17','PPHANPG17','PPHIFXPG17','PPKETPG16','PPMEDELSP17','PPMIKRCPG18','PPOEBPG2016','PPOEBSP2016','PPOLHPLPST2015','PPOMPCSP2016','PPOMPCSTD2015','PPOOST16','PPQUGSP17','PPRCLCST042015','PPSJC2016','PPSJCP2016','PPSJFCAST16','PPSJFCASTP16','PPTBSLSP17','PPTEEKAUS16','PPTEEKCON16','PPTEEKGAS16','PPTEEKSHU16','PPTEEKSPC16','PPTEEKSPG16','PPTRANSACT2016','PPTTCST16','PPTTCST316','PPWANUPST217','PPWBLNPG16','PURE13','QUI0012P2,QUI0012P','RCIREG05','REWORLD14','RIEBER08','RIEBER09','SAXO14','SCENIC2015','SCHLUM06','SGPBH10','SKERRITTS14','SMITH12','SMITHPG18','SMITHSP18','SWCAEC05','TCGMCCOMPS','TCGSTAFFCOMPS','TEEK07','TNB12015','TNB52015','TRANS07','TRANSACT11','TRCAFF11','TVLC08','UCB1508','ULSTER09/CIMSUBS04','UNICTYSU08','VODAFONE0213','VODAFONE0413','VODAFONE1013','VODAFONE1513','WELLWOOD2015','WEXAS09','YKM15' )
		AND t.creation_date
			BETWEEN @StartDate
	 			AND @EndDate
	 	AND t.track_status &lt;&gt; 'NA'
		AND p.isDeleted = 0

/* Load in the reedemed offers data */
INSERT INTO #dbwsvisitsbysourceraw (	
	source_code,
	consumer_no,
	external_identifier,
	membership_no,
	purchase_no,
	track_seq,
	title,
	forename,
	surname,
	fullname,
	source_desc,
	product_version,
	paid_to_date,
	subs_issue_date,
	subs_status,
	track_start,
	track_start_full,
	track_status  ,  
	cservice_centre ,
	sservicecentre  ,
	track_guests,
	track_from,
	track_value,
	creation_date,
	lounge_name,
	airport,
	trans_ccard_number,
	unique_card_no,
	external_ref,
	track_batch,
	old_system_ref,
	campaign_code,
	lounge_code,
	city,
	country,
	vendor_tracking_code,
	user_invitation_code,
	remaining_mem_cli_count,
	remaining_mem_cli2_count,
	remaining_mem_pp_count,
	remaining_gue_cli_count,
	remaining_gue_cli2_count,
	remaining_gue_pp_count,
	remaining_mgu_cli_count,
	remaining_mgu_cli2_count,
	remaining_mgu_pp_count,
	remaining_mgu_comp_count,
	experience_category,
	experience_type,
	airport_terminal_name,
	airport_terminal_type,
	visit_type )
SELECT
	s.source_code,
	c.consumer_no,
	c.external_identifier,
	c.membership_no,
	p.purchase_no,
	t.track_seq,
	c.title,
	c.forename,
	c.surname,
	LTRIM(RTRIM(REPLACE(REPLACE(REPLACE(c.forename + ' ' + c.surname,' ',' |'),'| ',''),'|',''))) AS fullname,
	s.source_desc,
	p.product_version,
	p.paid_to_date,
	p.subs_issue_date,
	p.subs_status,
	t.track_start,
	t.track_start_full,
	t.track_status  ,  
	c.service_centre ,
	s.servicecentre  ,
	t.track_guests,
	t.track_from,
	t.track_value,
	t.creation_date,
	ord.outlet_name as lounge_name,
	a.pp_short_name AS airport,
	p.trans_ccard_number AS trans_ccard_number,
	t.unique_card_no,
	t.external_ref,
	t.track_batch,
	p.old_system_ref,
	s.campaign_code,
	t.track_from as lounge_code,
	a.airport_city AS city,
	cou.code_desc AS country,
	siv.vendor_tracking_code,
	siv.user_invitation_code,
	0 AS remaining_mem_cli_count , 
	0 AS remaining_mem_cli2_count , 
	0 AS remaining_mem_pp_count , 
	0 AS remaining_gue_cli_count , 
	0 AS remaining_gue_cli2_count , 
	0 AS remaining_gue_pp_count , 
	0 AS remaining_mgu_cli_count , 
	0 AS remaining_mgu_cli2_count , 
	0 AS remaining_mgu_pp_count , 
	0 AS remaining_mgu_comp_count,
	
	ord.offer_category as experience_category,
		ord.offer_type as experience_type,
	ISNULL(ate.terminal_name, 'Unknown' ) as airport_terminal_name,
	'U' as airport_terminal_type,
	t.visit_type_id
FROM
	source_deal_config AS sdc WITH (NOLOCK)
	INNER JOIN source AS s WITH (NOLOCK) ON sdc.source_code = s.source_code
	INNER JOIN source_subscription AS ss WITH (NOLOCK) ON sdc.source_deal_config_id = ss.source_deal_config_id
	INNER JOIN purchase_subscription_link AS psl WITH (NOLOCK) ON ss.source_subscription_id = psl.source_subscription_id
	INNER JOIN purchase AS p WITH (NOLOCK) ON psl.purchase_no = p.purchase_no
	INNER JOIN consumer AS c WITH (NOLOCK) ON p.consumer_no = c.consumer_no
	INNER JOIN tracking AS t WITH (NOLOCK) ON p.purchase_no = t.purchase_no
	INNER JOIN offer_redemption_details AS ord WITH (NOLOCK) ON ord.consumer_no = c.consumer_no AND ord.track_seq = t.track_seq
	INNER JOIN airport AS a WITH (NOLOCK) ON a.iso_airport_code = ord.airport_iso_code
	LEFT JOIN outlet_airport_terminal AS oat WITH (NOLOCK) ON ord.outlet_id = oat.outlet_id
	LEFT JOIN airport_terminal AS ate WITH (NOLOCK) ON oat.airport_terminal_id = ate.airport_terminal_id
	LEFT OUTER JOIN code AS COU WITH (NOLOCK) ON cou.alpha_1 = a.iso_country_code
		AND cou.codetype = 'CTRY2'
		AND cou.alpha_5 &lt;&gt; ''
	LEFT OUTER JOIN source_invitation_validation siv WITH (NOLOCK) ON siv.consumer_no = c.consumer_no
	
WHERE
		sdc.source_code IN ('2WLS12','2WLS14','ABC13','ABRSM10','AFA14','AIF11','AIRPLUS09','AIRTELGBN14','AIRTELGHA14','AIRTELKEN14','AIRTELMAD14','AIRTELMAL14','AIRTELNGR14','AIRTELNGR214','AIRTELNIGER14','AIRTELRWA14','AIRTELSEY14','AIRTELTANZ14','AIRTELTCHAD14','AIRTELZAM14','AKCB2011','ALJOUF15','ALRAJHI15','AMEELY12','AMEXSAU10','APE08','ASI13','AVISE07','AXTMRP08','B2U14','BAML13','BCCGDLS10','BCCGLS15','BCCPLATLS10','BCCPLS15','BPSHIP0710','CANON11','CCIT13','CEO13','CGSTAFFCOMP','CITI13','CITI14','COL02','COL06','COMZ0208,PPCOMMBK,PPCOMMERZ,PPCOMMERZ1','CORN02','CORNER13','DANFOSS14','DEXIA09','DREL2010','EMIRITG11','EUROPCAREN14','EZE13','FESTO13','FMDL12','FNB2011','GOMEXICO12','GRUN1511','HBSWEBUS10MC','HBSWEBUS10VS','HONEYWELL08','IAAT2015','KEYSLSTY2015','KEYSLSTY22015','LIBERTY15','LTSB0410','LTSB06','LTSB1010','MARD08','MBNA05','MCCOMP5FREE','MEHR09','MELIA2015','MOBILY13','MWSG1008','NBB13','NEB13','NMMS07','NO1T2010','NORD09','NORDICCORPAX06','NOV2015','OOREDOO15','OOREDOOMAL15','OOREDOOMALINV15','ORAG08','PORTAMEX06','PPACCIST17','PPAMIST2016','PPASLHVSP16','PPATPPG18','PPAXAST616','PPBARVSINF16','PPBPFPG16','PPBPFSP16','PPBSBE216','PPBU022015','PPBU062015','PPBU102015','PPBUPAPG17','PPCRSP16','PPDRGPPG17','PPDRGPSP17','PPHANPG17','PPHIFXPG17','PPKETPG16','PPMEDELSP17','PPMIKRCPG18','PPOEBPG2016','PPOEBSP2016','PPOLHPLPST2015','PPOMPCSP2016','PPOMPCSTD2015','PPOOST16','PPQUGSP17','PPRCLCST042015','PPSJC2016','PPSJCP2016','PPSJFCAST16','PPSJFCASTP16','PPTBSLSP17','PPTEEKAUS16','PPTEEKCON16','PPTEEKGAS16','PPTEEKSHU16','PPTEEKSPC16','PPTEEKSPG16','PPTRANSACT2016','PPTTCST16','PPTTCST316','PPWANUPST217','PPWBLNPG16','PURE13','QUI0012P2,QUI0012P','RCIREG05','REWORLD14','RIEBER08','RIEBER09','SAXO14','SCENIC2015','SCHLUM06','SGPBH10','SKERRITTS14','SMITH12','SMITHPG18','SMITHSP18','SWCAEC05','TCGMCCOMPS','TCGSTAFFCOMPS','TEEK07','TNB12015','TNB52015','TRANS07','TRANSACT11','TRCAFF11','TVLC08','UCB1508','ULSTER09/CIMSUBS04','UNICTYSU08','VODAFONE0213','VODAFONE0413','VODAFONE1013','VODAFONE1513','WELLWOOD2015','WEXAS09','YKM15' )
	AND t.creation_date
		BETWEEN @StartDate
 			AND @EndDate
 	AND t.track_status &lt;&gt; 'NA'
	AND p.isDeleted = 0
	

/* update the temp table with an index */
CREATE CLUSTERED INDEX dbwsvisitsbysourceraw_idx1 ON #dbwsvisitsbysourceraw(purchase_no, track_seq);
CREATE NONCLUSTERED INDEX dbwsvisitsbysourceraw_idx2 ON #dbwsvisitsbysourceraw (source_code, consumer_no, fullname, track_start, lounge_name, external_ref) 
WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 100) ON [PRIMARY]

		/*  MEM PPAYVISIT  */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 1
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
           
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 1
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_PP_count = calculated_visit_allocation.visit_number
				
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no;

	/* MEM CPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 1
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 1
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw #dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no;

				/* MEM CPAYVISIT2 */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 1
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 1
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_CLI2_count = calculated_visit_allocation.visit_number
				
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* GUE PPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 2
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 2
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_PP_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* GUE CPAYLIST */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 2
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 2
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* GUE CPAYVISIT2 */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 2
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 2
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_CLI2_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/*MGU PPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 3
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 3
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_PP_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
/* MGU CPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 3
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 3
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* MGU CPAYVISIT2 */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 3
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 3
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_CLI2_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* SHAREDMEM PPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 8
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 8
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_PP_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* SHAREDMEM CPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 8
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 8
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
/* SHAREDMEM CPAYVISIT2 */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 8
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 8
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_CLI2_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* SHAREDGUE PPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 9
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 9
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_PP_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* SHAREDGUE CPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 9
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 9
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no

/* SHAREDGUE CPAYVISIT2 */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 9
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 9
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_CLI2_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
/* SHAREDMGU PPAYVISIT */

		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 10
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 10
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_PP_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
				/* SHAREDMGU CPAYVISIT */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 10
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 10
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
				/*SHAREDMGU CPAYVISIT2 */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 10
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 10
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_CLI2_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
/*OFFERMEM PPAYVISIT */
;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 6
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 6
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_PP_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		/* OFFERMEMCPAYLIST */
		;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 6
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 6
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		/* OFFERMEMCPAYLIST2 */
;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 6
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 6
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MEM_CLI2_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		/* OFFERGUEPPAYLIST */
;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 5
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 5
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_PP_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		/* OFFERGUECPAYLIST */
;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 5
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 5
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		/* OFFERGUECPAYLIST2 */
;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 5
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 5
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_GUE_CLI2_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		/* OFFERMGUPPAYLIST */
;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 7
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 21
					AND pva.visitor_type_id = 7
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_PP_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		/* OFFERMGUCPAYLIST */
;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 7
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 22
					AND pva.visitor_type_id = 7
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_CLI_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		/* OFFERMGUCPAYLIST2 */
;WITH used_visit_allocations AS (
            	SELECT
					COUNT(1) AS used_visit_count,
					pvah2.purchase_visit_allocation_id
				FROM
					purchase_visit_allocation_his AS pvah2
					INNER JOIN purchase_visit_allocation pva2 ON pvah2.purchase_visit_allocation_id = pva2.purchase_visit_allocation_id
					INNER JOIN purchase_visit_allocation_link pval2 ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
					LEFT OUTER JOIN source_visit_allocation_mem_gue_link salg ON pva2.source_visit_allocation_id = salg.guest_source_visit_allocation_id
				WHERE
						EXISTS (
							SELECT
								1
							FROM
								#dbwsvisitsbysourceraw temp2
							WHERE
								temp2.purchase_no = pval2.purchase_no
						)
					AND pvah2.isdeleted = 0
					AND pva2.visitor_type_id = 7
					AND salg.guest_source_visit_allocation_id is NULL
				GROUP BY
					pvah2.purchase_visit_allocation_id
			),
			derived_visit_allocation AS (
				SELECT
					pva.visit_count_from,
					pva.visit_count_to,
					pva.visit_validity_type_id,
					CASE
						WHEN pva.visit_count_to = 9999
							THEN 9999
						WHEN pva.visit_count_from = 0
							THEN	(pva.visit_count_to - pva.visit_count_from)
						ELSE (pva.visit_count_to - pva.visit_count_from) + 1
					END AS allocated_visit_count,
					ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
					pur.purchase_no
				FROM
					purchase pur
					INNER JOIN purchase_visit_allocation_link pval ON pval.purchase_no = pur.purchase_no
					INNER JOIN purchase_visit_allocation_grp pvag ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
					INNER JOIN purchase_visit_allocation pva ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
					AND pva.charge_owner_id = 25
					AND pva.visitor_type_id = 7
					AND pva.visit_allocation_type_id NOT IN (3,4)
					AND pur.isDeleted = 0
					LEFT JOIN used_visit_allocations ON pva.purchase_visit_allocation_id = used_visit_allocations.purchase_visit_allocation_id
               	WHERE
						(
							(	pva.valid_from &lt;= GETDATE()
								AND pva.valid_to &gt;= GETDATE()
							)
							OR pva.visit_validity_type_id = 2
						)
			),
			calculated_visit_allocation AS
			(
				SELECT
					CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN
						9999
					ELSE
						CASE WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
							CASE
								WHEN derived_visit_allocation.visit_count_to = 9999
									THEN 9999
								WHEN derived_visit_allocation.visit_count_from = 0
									THEN	(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
								ELSE
									(derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1
							END
						ELSE
							(derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count)
						END
					END AS visit_number,
					derived_visit_allocation.used_visit_count AS used_visit_number,
					derived_visit_allocation.purchase_no
				FROM derived_visit_allocation
			)

			UPDATE
				#dbwsvisitsbysourceraw
			SET
				remaining_MGU_CLI2_count = calculated_visit_allocation.visit_number
			FROM
				#dbwsvisitsbysourceraw
				INNER JOIN calculated_visit_allocation ON #dbwsvisitsbysourceraw.purchase_no = calculated_visit_allocation.purchase_no
		;WITH derived_credit_data AS (
			SELECT
				ISNULL(SUM(CASE WHEN vch.purchase_visit_allocation_his_id IS NULL THEN 1 ELSE 0 END),0) AS unused_visit,
				ISNULL(SUM(CASE WHEN vch.purchase_visit_allocation_his_id IS NOT NULL THEN 1 ELSE 0 END),0) AS used_visit,
				pval.purchase_no
			FROM
				visit_credit_his AS vch
				INNER JOIN visit_credit AS vc ON vch.visit_credit_id = vc.visit_credit_id
				INNER JOIN visit_credit_purchase_allocation AS vcpa ON vch.visit_credit_his_id = vcpa.visit_credit_his_id
				INNER JOIN purchase_visit_allocation AS pva ON vcpa.purchase_visit_allocation_id = pva.purchase_visit_allocation_id
				INNER JOIN purchase_visit_allocation_grp AS pvag ON pva.purchase_visit_allocation_grp_id = pvag.purchase_visit_allocation_grp_id
				INNER JOIN purchase_visit_allocation_link AS pval ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
			WHERE
				vch.isdeleted = 0
				AND vch.expiry_date &gt;= GETDATE()
				AND vc.visit_credit_type_id = 1
				AND vc.visitor_type_id = 3
			GROUP BY pval.purchase_no
		)
		UPDATE
			#dbwsvisitsbysourceraw
		SET
			REMAINING_MGU_COMP_COUNT = derived_credit_data.unused_visit
		FROM
			#dbwsvisitsbysourceraw
			INNER JOIN derived_credit_data ON #dbwsvisitsbysourceraw.purchase_no = derived_credit_data.purchase_no
		

/* Get the data to return */
SELECT CAST(CONCAT(YEAR(temp.creation_date) , '-' , MONTH(temp.creation_date) , '-01' ) AS DATE)	 AS	[report_month],
 	FORMAT(CAST('2018-07-01' AS DATE), 'MMM-yy') AS [Process month]	
	,temp.source_code					AS Source_Code
    ,temp.source_desc                   AS Source_code_desc
	,temp.external_identifier			AS Member_No
    ,temp.consumer_no                   AS consumer_no 
    ,temp.purchase_no                   AS purchase_no
	,temp.trans_ccard_number            AS CCard_No
	,CASE WHEN CHARINDEX('*', temp.unique_card_no) &gt; 0 THEN NULL
	 WHEN temp.consumer_no IS NOT NULL THEN NULL
	 ELSE temp.unique_card_no
     END AS ppid
    ,CASE WHEN CHARINDEX('*', temp.unique_card_no) &gt; 0 THEN LEFT(temp.trans_ccard_number, 10) ELSE NULL END  AS bin
	,temp.title						    AS Title
	,temp.forename						AS First_Name
	,temp.surname						AS Last_Name
	,temp.product_version				AS Membership_Plan
	,temp.subs_status					AS Member_Status
	,temp.paid_to_date					AS Paid_To_date
	,temp.track_start					AS Visit_Date
	,temp.[track_start_full]            AS Visit_Date2
	,temp.creation_date			    	AS Date_Processed
	,temp.track_status                  AS Visit_status
	,temp.track_seq                     AS Visit_seq
	,temp.track_guests					AS GuestVisits
	,temp.track_batch					AS Batch_No
    ,temp.cservice_centre               AS consumer_service_centre
    ,temp.sservicecentre                AS deal_service_centre
   ,COALESCE(NULLIF(temp.sservicecentre, ''), NULLIF(temp.cservice_centre, '')) AS retail_client_service_centre
	,temp.external_ref					AS Reference
	,temp.track_from					AS Lounge_Code
	,temp.lounge_name					AS Lounge
	,case when temp.airport_terminal_type='I' then 'International' 
	      when temp.airport_terminal_type='D' then 'Domestic'
		  when temp.airport_terminal_type='U' then 'Unknown'
		   else temp.airport_terminal_type end AS domestic_int_lounge
	,temp.airport	  	   	AS Airport
	,temp.city 			  	AS City
	,temp.country			   	AS Country
    , pvsd.count_mem_cli          AS Client_Pays_Member_Visit
    , pvsd.[count_mem_cli2]         AS Client_2_Pays_Member_Visit
    , pvsd.[count_mem_pp]           AS Inclusive_PP_Member_Visit
    , pvsd.[count_mem_comp]         AS Complimentary_Member_Visit
    , pvsd.[count_mem_mem]          AS Cardholder_Pays_Member_Visit
    , pvsd.[count_gue_cli]          AS Client_Pays_Guest_Visit
    , pvsd.[count_gue_cli2]         AS Client_2_Pays_Guest_Visit
    , pvsd.[count_gue_pp]           AS Inclusive_PP_Guest_Visit
    , pvsd.[count_gue_comp]         AS Complimentary_Guest_Visit
    , pvsd.[count_gue_mem]          AS Cardholder_Pays_Guest_Visit
    , pvsd.[count_gue_lou]          AS Lounge_Visit_Offer
	,temp.remaining_mem_cli_count	AS Client_Member
	,temp.remaining_mem_cli2_count 	AS Client_2_Member
	,temp.remaining_mem_pp_count 	AS Inclusive_PP_Member
	,temp.remaining_gue_cli_count 	AS Client_Guest
	,temp.remaining_gue_cli2_count 	AS Client_2_Guest
	,temp.remaining_gue_pp_count	AS Inclusive_PP_Guest
	,temp.remaining_mgu_cli_count 	AS Client_Member_Guest
	,temp.remaining_mgu_cli2_count 	AS Client_2_Member_Guest
	,temp.remaining_mgu_pp_count 	AS Inclusive_PP_Member_Guest
	,temp.remaining_mgu_comp_count 	AS Complimentary_Member_Guest
	,pvsd.[fee_mem_cli_curr]		AS Client_Visit_Currency_Member
	,pvsd.[fee_mem_cli]				AS Client_Visit_Amount_Member
	,pvsd.[fee_gue_cli_curr]		AS Client_Visit_Currency_Guest
	,pvsd.[fee_gue_cli]				AS Client_Visit_Amount_Guest
	,pvsd. [fee_mem_cli2_curr]      AS Client_2_Visit_Currency_Member
    ,pvsd. [fee_mem_cli2]           AS Client_2_Visit_Amount_Member
    ,pvsd. [fee_gue_cli2_curr]      AS Client_2_Visit_Currency_Guest
    ,pvsd. [fee_gue_cli2]           AS Client_2_Visit_Amount_Guest
	, CASE
        WHEN LEN(pvsd.[fee_mem_cli_curr]) &gt; 0
            THEN pvsd.[fee_mem_cli_curr]
        WHEN LEN(pvsd.[fee_gue_cli_curr]) &gt; 0
            THEN pvsd.[fee_gue_cli_curr]
        ELSE
            ' '
    END                                                                                                            AS Total_Client_Amount_Currency
  , CASE
        WHEN LEN(pvsd.[fee_mem_cli2_curr]) &gt; 0
            THEN pvsd.[fee_mem_cli2_curr]
        WHEN LEN(pvsd.[fee_gue_cli2_curr]) &gt; 0
            THEN pvsd.[fee_gue_cli2_curr]
        ELSE
            ' '
    END                                                                                                            AS Total_Client_2_Amount_Currency
  , CASE
        WHEN (pvsd.fee_mem_cli_curr = pvsd.fee_gue_cli_curr)
             AND LEN(pvsd.fee_mem_cli_curr) &gt; 0
            THEN pvsd.fee_mem_cli + pvsd.fee_gue_cli
        WHEN LEN(pvsd.fee_mem_cli_curr) &gt; 0
            THEN pvsd.fee_mem_cli
        WHEN LEN(pvsd.fee_gue_cli_curr) &gt; 0
            THEN pvsd.fee_gue_cli
        ELSE
            0.00
    END                                                                                                            AS Total_Client_Amount
  , CASE
        WHEN (pvsd.fee_mem_cli2_curr = pvsd.fee_gue_cli2_curr)
             AND LEN(pvsd.fee_mem_cli2_curr) &gt; 0
            THEN pvsd.fee_mem_cli2 + pvsd.fee_gue_cli2
        WHEN LEN(pvsd.fee_mem_cli2_curr) &gt; 0
            THEN pvsd.fee_mem_cli2
        WHEN LEN(pvsd.fee_gue_cli2_curr) &gt; 0
            THEN pvsd.fee_gue_cli2
        ELSE
            0.00
    END                                                                                                            AS Total_Client_2_Amount
	,pvsd.fee_mem_mem_curr	AS Cardholder_Visit_Currency_Member	
	,pvsd.fee_mem_mem		AS Cardholder_Visit_Amount_Member	
	,pvsd.fee_gue_mem_curr	AS Cardholder_Visit_Currency_Guest	
	,pvsd.fee_gue_mem		AS Cardholder_Visit_Amount_Guest	
	,CASE 
		WHEN Len(pvsd.fee_mem_mem_curr) &gt; 0 
			THEN pvsd.fee_mem_mem_curr
		WHEN Len(pvsd.fee_gue_mem_curr) &gt; 0 
			THEN pvsd.fee_gue_mem_curr
		ELSE ' '
    END						AS Total_Cardholder_Amount_Currency	
	,CASE 
		WHEN (pvsd.fee_mem_mem_curr = pvsd.fee_gue_mem_curr) AND Len(pvsd.fee_mem_mem_curr) &gt; 0 
			THEN pvsd.fee_mem_mem + pvsd.fee_gue_mem
		WHEN Len(pvsd.fee_mem_mem_curr) &gt; 0 
			THEN pvsd.fee_mem_mem
		WHEN Len(pvsd.fee_gue_mem_curr) &gt; 0 
			THEN pvsd.fee_gue_mem
		ELSE 0.00
	END						AS Total_Cardholder_Amount	
	,left(temp.old_system_ref,10)			AS Cost_Centre	
	,temp.campaign_code					AS Campaign_Code	
	,temp.vendor_tracking_code			AS Vendor_Code	
	,left(temp.user_invitation_code,10)			AS User_Invitation_Code	
	,case when CHARINDEX(temp.track_from,temp. external_ref) &gt; 0 then  substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, '') ,7,50),1,2)+ ':' + substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, '') ,7,50),3,2) + ':' + substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, '') ,7,50),5,2) +'.' + case when (SUBSTRING(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, ''),7,50),7,3) ='' OR ISDATE(substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, '') ,7,50),7,3))&lt;&gt;1)then '000' else substring(substring(replace(REPLACE(temp.external_ref,' ',''),temp.track_from, ''),7,50),7,3) end	else '00:00:00.000' END as VisitTime
	,CAST(CAST(ISNULL(temp.external_identifier,'') AS NVARCHAR(max))+ISNULL(convert(varchar,temp.track_start,12),'')+ISNULL(temp.track_from,'') AS NVARCHAR(25)) Unique_reference
	,0 as entitlement_client_pays_member_visit
	,0 as entitlement_inclusive_PP_member_visit
	,0 as entitlement_client_guest_linked_guest_allocation
	,0 as entitlement_linked_guest_entitlement_per_visit
	,0 as entitlement_inclusive_PP_guest_visit
	,0 as entitlement_client_member_guest_visit
	,0 as entitlement_complimentary_member_guest_visit
	,0 as entitlement_inclusive_PP_member_guest_visit
	into ##dbwsvisitsbysource
FROM
	#dbwsvisitsbysourceraw AS temp
	INNER JOIN purchase_visit_summary_data AS pvsd WITH (NOLOCK) ON temp.purchase_no = pvsd.purchase_no AND temp.track_seq = pvsd.track_seq
ORDER BY
	temp.source_code,
	temp.consumer_no,
	temp.fullname,
	temp.track_seq,
	temp.track_start,
	temp.lounge_name,
	temp.external_ref ASC
	
	IF OBJECT_ID('tempdb..#dbwsvisitsbysource') IS NOT NULL
    DROP TABLE #dbwsvisitsbysource;</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E4D807D8-BEC2-43E0-8415-585E009E1301}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strProcessUnknownFile">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{13E95186-FB8E-4EDC-8BFE-DD94530FE962}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strSourceFolder">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{EFE87B82-05E9-456F-AAD5-068FA33D3E2F}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strSource_Code_from_exception">
      <DTS:VariableValue
        DTS:DataType="8">'2WLS12','2WLS14','ABC13','ABRSM10','AFA14','AIF11','AIRPLUS09','AIRTELGBN14','AIRTELGHA14','AIRTELKEN14','AIRTELMAD14','AIRTELMAL14','AIRTELNGR14','AIRTELNGR214','AIRTELNIGER14','AIRTELRWA14','AIRTELSEY14','AIRTELTANZ14','AIRTELTCHAD14','AIRTELZAM14','AKCB2011','ALJOUF15','ALRAJHI15','AMEELY12','AMEXSAU10','APE08','ASI13','AVISE07','AXTMRP08','B2U14','BAML13','BCCGDLS10','BCCGLS15','BCCPLATLS10','BCCPLS15','BPSHIP0710','CANON11','CCIT13','CEO13','CGSTAFFCOMP','CITI13','CITI14','COL02','COL06','COMZ0208,PPCOMMBK,PPCOMMERZ,PPCOMMERZ1','CORN02','CORNER13','DANFOSS14','DEXIA09','DREL2010','EMIRITG11','EUROPCAREN14','EZE13','FESTO13','FMDL12','FNB2011','GOMEXICO12','GRUN1511','HBSWEBUS10MC','HBSWEBUS10VS','HONEYWELL08','IAAT2015','KEYSLSTY2015','KEYSLSTY22015','LIBERTY15','LTSB0410','LTSB06','LTSB1010','MARD08','MBNA05','MCCOMP5FREE','MEHR09','MELIA2015','MOBILY13','MWSG1008','NBB13','NEB13','NMMS07','NO1T2010','NORD09','NORDICCORPAX06','NOV2015','OOREDOO15','OOREDOOMAL15','OOREDOOMALINV15','ORAG08','PORTAMEX06','PPACCIST17','PPAMIST2016','PPASLHVSP16','PPATPPG18','PPAXAST616','PPBARVSINF16','PPBPFPG16','PPBPFSP16','PPBSBE216','PPBU022015','PPBU062015','PPBU102015','PPBUPAPG17','PPCRSP16','PPDRGPPG17','PPDRGPSP17','PPHANPG17','PPHIFXPG17','PPKETPG16','PPMEDELSP17','PPMIKRCPG18','PPOEBPG2016','PPOEBSP2016','PPOLHPLPST2015','PPOMPCSP2016','PPOMPCSTD2015','PPOOST16','PPQUGSP17','PPRCLCST042015','PPSJC2016','PPSJCP2016','PPSJFCAST16','PPSJFCASTP16','PPTBSLSP17','PPTEEKAUS16','PPTEEKCON16','PPTEEKGAS16','PPTEEKSHU16','PPTEEKSPC16','PPTEEKSPG16','PPTRANSACT2016','PPTTCST16','PPTTCST316','PPWANUPST217','PPWBLNPG16','PURE13','QUI0012P2,QUI0012P','RCIREG05','REWORLD14','RIEBER08','RIEBER09','SAXO14','SCENIC2015','SCHLUM06','SGPBH10','SKERRITTS14','SMITH12','SMITHPG18','SMITHSP18','SWCAEC05','TCGMCCOMPS','TCGSTAFFCOMPS','TEEK07','TNB12015','TNB52015','TRANS07','TRANSACT11','TRCAFF11','TVLC08','UCB1508','ULSTER09/CIMSUBS04','UNICTYSU08','VODAFONE0213','VODAFONE0413','VODAFONE1013','VODAFONE1513','WELLWOOD2015','WEXAS09','YKM15'</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D5BCCC94-BF56-42E5-B78F-360030993642}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strSource_Code_from_master">
      <DTS:VariableValue
        DTS:DataType="8">'2WLS12','2WLS14','ABC13','ABRSM10','AFA14','AIF11','AIRPLUS09','AIRTELGBN14','AIRTELGHA14','AIRTELKEN14','AIRTELMAD14','AIRTELMAL14','AIRTELNGR14','AIRTELNGR214','AIRTELNIGER14','AIRTELRWA14','AIRTELSEY14','AIRTELTANZ14','AIRTELTCHAD14','AIRTELZAM14','AKCB2011','ALJOUF15','ALRAJHI15','AMEELY12','AMEXSAU10','APE08','ASI13','AVISE07','AXTMRP08','B2U14','BAML13','BCCGDLS10','BCCGLS15','BCCPLATLS10','BCCPLS15','BPSHIP0710','CANON11','CCIT13','CEO13','CGSTAFFCOMP','CITI13','CITI14','COL02','COL06','COMZ0208,PPCOMMBK,PPCOMMERZ,PPCOMMERZ1','CORN02','CORNER13','DANFOSS14','DEXIA09','DREL2010','EMIRITG11','EUROPCAREN14','EZE13','FESTO13','FMDL12','FNB2011','GOMEXICO12','GRUN1511','HBSWEBUS10MC','HBSWEBUS10VS','HONEYWELL08','IAAT2015','KEYSLSTY2015','KEYSLSTY22015','LIBERTY15','LTSB0410','LTSB06','LTSB1010','MARD08','MBNA05','MCCOMP5FREE','MEHR09','MELIA2015','MOBILY13','MWSG1008','NBB13','NEB13','NMMS07','NO1T2010','NORD09','NORDICCORPAX06','NOV2015','OOREDOO15','OOREDOOMAL15','OOREDOOMALINV15','ORAG08','PORTAMEX06','PPACCIST17','PPAMIST2016','PPASLHVSP16','PPATPPG18','PPAXAST616','PPBARVSINF16','PPBPFPG16','PPBPFSP16','PPBSBE216','PPBU022015','PPBU062015','PPBU102015','PPBUPAPG17','PPCRSP16','PPDRGPPG17','PPDRGPSP17','PPHANPG17','PPHIFXPG17','PPKETPG16','PPMEDELSP17','PPMIKRCPG18','PPOEBPG2016','PPOEBSP2016','PPOLHPLPST2015','PPOMPCSP2016','PPOMPCSTD2015','PPOOST16','PPQUGSP17','PPRCLCST042015','PPSJC2016','PPSJCP2016','PPSJFCAST16','PPSJFCASTP16','PPTBSLSP17','PPTEEKAUS16','PPTEEKCON16','PPTEEKGAS16','PPTEEKSHU16','PPTEEKSPC16','PPTEEKSPG16','PPTRANSACT2016','PPTTCST16','PPTTCST316','PPWANUPST217','PPWBLNPG16','PURE13','QUI0012P2,QUI0012P','RCIREG05','REWORLD14','RIEBER08','RIEBER09','SAXO14','SCENIC2015','SCHLUM06','SGPBH10','SKERRITTS14','SMITH12','SMITHPG18','SMITHSP18','SWCAEC05','TCGMCCOMPS','TCGSTAFFCOMPS','TEEK07','TNB12015','TNB52015','TRANS07','TRANSACT11','TRCAFF11','TVLC08','UCB1508','ULSTER09/CIMSUBS04','UNICTYSU08','VODAFONE0213','VODAFONE0413','VODAFONE1013','VODAFONE1513','WELLWOOD2015','WEXAS09','YKM15'</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{674837F5-9363-462E-AEBD-743EF773A654}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression=" (DT_WSTR,20) DateAdd(&quot;Month&quot;, 0,  @[User::dtStartDate])"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strStartDate_YMD">
      <DTS:VariableValue
        DTS:DataType="8">2018-07-01 00:00:00</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{BE206111-920F-4971-BF44-33D861E2AF64}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strStoredProcedureName">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F69BF1A4-C182-47C2-B8A3-CD055B72AF94}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[System::PackageName] + &quot; Fails to execute.Please check Package and run again&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strSubject">
      <DTS:VariableValue
        DTS:DataType="8">04_src2dest_ppass_bi02_visits_extract Fails to execute.Please check Package and run again</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7CE5D68F-1E88-45EF-A134-FFAD150AF89B}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[$Project::ToEmail]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strToEmail">
      <DTS:VariableValue
        DTS:DataType="8">TE-BI@collinsongroup.com</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{92AA8854-12B5-44BE-81FA-6C9FF23212E5}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="strUnknownFolder">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{DB7E56A6-8725-4C90-8999-6231806195F7}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;SET FMTONLY ON&#xA;SELECT CAST(NULL AS date) AS report_month ,CAST(NULL AS nvarchar(4000)) AS [Process month] ,CAST(NULL AS varchar(15)) AS Source_Code ,CAST(NULL AS varchar(30)) AS Source_code_desc ,CAST(NULL AS bigint) AS Member_No ,&#xA;CAST(NULL AS int) AS consumer_no ,CAST(NULL AS int) AS purchase_no ,CAST(NULL AS varchar(18)) AS CCard_No ,CAST(NULL AS varchar(30)) AS ppid ,CAST(NULL AS varchar(10)) AS bin ,CAST(NULL AS varchar(15)) AS Title ,CAST(NULL AS varchar(15)) AS First_Name ,&#xA;CAST(NULL AS varchar(30)) AS Last_Name ,CAST(NULL AS varchar(7)) AS Membership_Plan ,CAST(NULL AS varchar(2)) AS Member_Status ,CAST(NULL AS datetime2(2)) AS Paid_To_date ,CAST(NULL AS datetime2(2)) AS Visit_Date ,&#xA;CAST(NULL AS datetime2(2)) AS Visit_Date2 ,CAST(NULL AS datetime2(2)) AS Date_Processed ,CAST(NULL AS varchar(2)) AS Visit_status ,CAST(NULL AS int) AS Visit_seq ,CAST(NULL AS smallint) AS GuestVisits ,&#xA;CAST(NULL AS int) AS Batch_No ,CAST(NULL AS varchar(2)) AS consumer_service_centre ,CAST(NULL AS varchar(1)) AS deal_service_centre ,CAST(NULL AS varchar(2)) AS retail_client_service_centre ,&#xA;CAST(NULL AS varchar(20)) AS Reference ,CAST(NULL AS varchar(10)) AS Lounge_Code ,CAST(NULL AS varchar(80)) AS Lounge ,CAST(NULL AS varchar(40)) AS domestic_int_lounge ,CAST(NULL AS varchar(50)) AS Airport ,&#xA;CAST(NULL AS varchar(100)) AS City ,CAST(NULL AS varchar(40)) AS Country ,CAST(NULL AS tinyint) AS Client_Pays_Member_Visit ,CAST(NULL AS tinyint) AS Inclusive_PP_Member_Visit ,&#xA;CAST(NULL AS tinyint) AS Complimentary_Member_Visit ,CAST(NULL AS tinyint) AS Cardholder_Pays_Member_Visit ,CAST(NULL AS tinyint) AS Client_Pays_Guest_Visit ,CAST(NULL AS tinyint) AS Inclusive_PP_Guest_Visit ,&#xA;CAST(NULL AS tinyint) AS Complimentary_Guest_Visit ,CAST(NULL AS tinyint) AS Cardholder_Pays_Guest_Visit ,CAST(NULL AS tinyint) AS Lounge_Visit_Offer ,CAST(NULL AS int) AS Client_Member ,&#xA;CAST(NULL AS int) AS Inclusive_PP_Member ,CAST(NULL AS int) AS Client_Guest ,CAST(NULL AS int) AS Inclusive_PP_Guest ,CAST(NULL AS int) AS Client_Member_Guest ,CAST(NULL AS int) AS Inclusive_PP_Member_Guest ,&#xA;CAST(NULL AS int) AS Complimentary_Member_Guest ,CAST(NULL AS varchar(2)) AS Client_Visit_Currency_Member ,CAST(NULL AS decimal(10,2)) AS Client_Visit_Amount_Member ,CAST(NULL AS varchar(2)) AS Client_Visit_Currency_Guest ,&#xA;CAST(NULL AS decimal(10,2)) AS Client_Visit_Amount_Guest ,CAST(NULL AS varchar(2)) AS Total_Client_Amount_Currency ,CAST(NULL AS decimal(11,2)) AS Total_Client_Amount ,&#xA;CAST(NULL AS varchar(2)) AS Cardholder_Visit_Currency_Member ,CAST(NULL AS decimal(10,2)) AS Cardholder_Visit_Amount_Member ,&#xA;CAST(NULL AS varchar(2)) AS Cardholder_Visit_Currency_Guest ,CAST(NULL AS decimal(10,2)) AS Cardholder_Visit_Amount_Guest ,CAST(NULL AS varchar(2)) AS Total_Cardholder_Amount_Currency ,&#xA;CAST(NULL AS decimal(11,2)) AS Total_Cardholder_Amount ,CAST(NULL AS varchar(10)) AS Cost_Centre ,CAST(NULL AS varchar(10)) AS Campaign_Code ,CAST(NULL AS varchar(10)) AS Vendor_Code ,CAST(NULL AS varchar(10)) AS User_Invitation_Code ,&#xA;CAST(NULL AS varchar(12)) AS VisitTime ,CAST(NULL AS nvarchar(25)) AS Unique_reference&#xA;SET FMTONLY OFF&#xA;&#xA;IF OBJECT_ID('tempdb..##visitsbysource') IS NOT NULL&#xA;    DROP TABLE ##visitsBySource;&#xA;&#xA;SELECT &#xA;                      CAST(CONCAT(YEAR(t.creation_date) , '-' , MONTH(t.creation_date) , '-01' ) AS DATE)&#x9; AS&#x9;[report_month],&#xA;&#x9;FORMAT(CAST('&quot;+ &#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;  +&quot;' AS DATE), 'MMM-yy') AS [Process month]&#xA;&#x9;,s.source_code&#x9;&#x9;&#x9;&#x9;&#x9;AS Source_Code&#xA;        ,s.source_desc                                  AS Source_code_desc&#xA;&#x9;,c.external_identifier&#x9;&#x9;&#x9;&#x9;&#x9;AS Member_No&#xA;        , c.consumer_no                                         AS consumer_no   &#xA;        ,p.[purchase_no]                                        AS purchase_no&#xA;&#x9;,P.trans_ccard_number                                   AS CCard_No&#xA;        ,CASE WHEN c.consumer_type_id IN (1,5) THEN t.unique_card_no END&#xA; AS ppid&#xA;        ,CASE WHEN CHARINDEX('*', t.unique_card_no) &gt; 0 THEN LEFT(p.trans_ccard_number, 10) ELSE NULL END  AS bin    &#xA;&#x9;--,0  AS CCard_No&#xA;&#x9;,c.title&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Title&#xA;&#x9;,c.forename&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS First_Name&#xA;&#x9;,c.surname&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Last_Name&#xA;&#x9;,p.product_version&#x9;&#x9;&#x9;&#x9;AS Membership_Plan&#xA;&#x9;,p.subs_status&#x9;&#x9;&#x9;&#x9;&#x9;AS Member_Status&#xA;&#x9;,p.paid_to_date&#x9;&#x9;&#x9;&#x9;&#x9;AS Paid_To_date&#xA;&#x9;,t.track_start&#x9;&#x9;&#x9;&#x9;&#x9;AS Visit_Date&#xA;&#x9;,t.[track_start_full]                           AS Visit_Date2&#xA;&#x9;,t.creation_date&#x9;&#x9;&#x9;&#x9;AS Date_Processed&#xA;&#x9;,t.track_status                                  AS Visit_status&#xA;&#x9;,t.track_seq                                     AS Visit_seq&#xA;&#x9;,t.track_guests&#x9;&#x9;&#x9;&#x9;&#x9;AS GuestVisits&#xA;&#x9;,t.track_batch&#x9;&#x9;&#x9;&#x9;&#x9;AS Batch_No&#xA;        ,c.service_centre                              AS consumer_service_centre&#xA;        ,s.servicecentre                               AS deal_service_centre&#xA;        ,COALESCE(NULLIF(s.servicecentre, ''), NULLIF(c.service_centre, '')) AS retail_client_service_centre&#xA;&#x9;,t.external_ref&#x9;&#x9;&#x9;&#x9;&#x9;AS Reference&#xA;&#x9;,t.track_from&#x9;&#x9;&#x9;&#x9;&#x9;AS Lounge_Code&#xA;&#x9;,l.lounge_name&#x9;&#x9;&#x9;&#x9;&#x9;AS Lounge&#xA;&#x9;,dom.code_desc                                  AS domestic_int_lounge&#xA;&#x9;,a.pp_short_name&#x9;&#x9;&#x9;&#x9;AS Airport&#xA;&#x9;,a.airport_city &#x9;&#x9;&#x9;&#x9;AS City&#xA;&#x9;,COU.code_desc&#x9;&#x9;&#x9;&#x9;&#x9;AS Country&#xA;&#x9;,pvsd.[count_mem_cli]&#x9;&#x9;&#x9;AS Client_Pays_Member_Visit&#xA;&#x9;,pvsd.[count_mem_pp]&#x9;&#x9;&#x9;AS Inclusive_PP_Member_Visit&#xA;&#x9;,pvsd.[count_mem_comp]&#x9;&#x9;&#x9;AS Complimentary_Member_Visit&#xA;&#x9;,pvsd.[count_mem_mem]&#x9;&#x9;&#x9;AS Cardholder_Pays_Member_Visit&#xA;&#x9;,pvsd.[count_gue_cli]&#x9;&#x9;&#x9;AS Client_Pays_Guest_Visit&#xA;&#x9;,pvsd.[count_gue_pp]&#x9;&#x9;&#x9;AS Inclusive_PP_Guest_Visit&#xA;&#x9;,pvsd.[count_gue_comp]&#x9;&#x9;&#x9;AS Complimentary_Guest_Visit&#xA;&#x9;,pvsd.[count_gue_mem]&#x9;&#x9;&#x9;AS Cardholder_Pays_Guest_Visit&#xA;&#x9;,pvsd.[count_gue_lou]&#x9;&#x9;&#x9;AS Lounge_Visit_Offer&#xA;&#x9;,0 &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Client_Member&#xA;&#x9;,0 &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Inclusive_PP_Member&#xA;&#x9;,0 &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Client_Guest&#xA;&#x9;,0 &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Inclusive_PP_Guest&#xA;&#x9;,0 &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Client_Member_Guest&#xA;&#x9;,0 &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Inclusive_PP_Member_Guest&#xA;&#x9;,0 &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Complimentary_Member_Guest&#xA;&#x9;,pvsd.[fee_mem_cli_curr]&#x9;&#x9;AS Client_Visit_Currency_Member&#xA;&#x9;,pvsd.[fee_mem_cli]&#x9;&#x9;&#x9;&#x9;AS Client_Visit_Amount_Member&#xA;&#x9;,pvsd.[fee_gue_cli_curr]&#x9;&#x9;AS Client_Visit_Currency_Guest&#xA;&#x9;,pvsd.[fee_gue_cli]&#x9;&#x9;&#x9;&#x9;AS Client_Visit_Amount_Guest&#xA;&#x9;,CASE &#xA;&#x9;&#x9;WHEN len(pvsd.[fee_mem_cli_curr]) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.[fee_mem_cli_curr] &#xA;&#x9;&#x9;WHEN len(pvsd.[fee_gue_cli_curr]) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.[fee_gue_cli_curr] &#xA;&#x9;&#x9;ELSE ' ' &#xA;&#x9;END&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Total_Client_Amount_Currency&#xA;&#x9;,CASE &#xA;&#x9;&#x9;WHEN (pvsd.fee_mem_cli_curr = pvsd.fee_gue_cli_curr) AND Len(pvsd.fee_mem_cli_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_mem_cli + pvsd.fee_gue_cli&#xA;&#x9;&#x9;WHEN Len(pvsd.fee_mem_cli_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_mem_cli&#xA;&#x9;&#x9;WHEN Len(pvsd.fee_gue_cli_curr) &gt; 0 THEN pvsd.fee_gue_cli&#xA;&#x9;       ELSE 0.00&#xA;&#x9;END AS Total_Client_Amount&#x9; &#xA;&#x9;,pvsd.fee_mem_mem_curr&#x9;AS Cardholder_Visit_Currency_Member&#x9;&#xA;&#x9;,pvsd.fee_mem_mem&#x9;&#x9;AS Cardholder_Visit_Amount_Member&#x9;&#xA;&#x9;,pvsd.fee_gue_mem_curr&#x9;AS Cardholder_Visit_Currency_Guest&#x9;&#xA;&#x9;,pvsd.fee_gue_mem&#x9;&#x9;AS Cardholder_Visit_Amount_Guest&#x9;&#xA;&#x9;,CASE &#xA;&#x9;&#x9;WHEN Len(pvsd.fee_mem_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_mem_mem_curr&#xA;&#x9;&#x9;WHEN Len(pvsd.fee_gue_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_gue_mem_curr&#xA;&#x9;&#x9;ELSE ' '&#xA;    END&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Total_Cardholder_Amount_Currency&#x9;&#xA;&#x9;,CASE &#xA;&#x9;&#x9;WHEN (pvsd.fee_mem_mem_curr = pvsd.fee_gue_mem_curr) AND Len(pvsd.fee_mem_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_mem_mem + pvsd.fee_gue_mem&#xA;&#x9;&#x9;WHEN Len(pvsd.fee_mem_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_mem_mem&#xA;&#x9;&#x9;WHEN Len(pvsd.fee_gue_mem_curr) &gt; 0 &#xA;&#x9;&#x9;&#x9;THEN pvsd.fee_gue_mem&#xA;&#x9;&#x9;ELSE 0.00&#xA;&#x9;END&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS Total_Cardholder_Amount&#x9;&#xA;&#x9;,left(p.old_system_ref,10)&#x9;&#x9;&#x9;AS Cost_Centre&#x9;&#xA;&#x9;,s.campaign_code&#x9;&#x9;&#x9;&#x9;&#x9;AS Campaign_Code&#x9;&#xA;&#x9;,siv.vendor_tracking_code&#x9;&#x9;&#x9;AS Vendor_Code&#x9;&#xA;&#x9;,siv.user_invitation_code&#x9;&#x9;&#x9;AS User_Invitation_Code&#x9;&#xA;&#x9;,case when CHARINDEX(t.track_from, t.external_ref) &gt; 0 then  substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, '') ,7,50),1,2)+ ':' + substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, '') ,7,50),3,2) + ':' + substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, '') ,7,50),5,2) +'.' + case when (SUBSTRING(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, ''),7,50),7,3) ='' OR ISDATE(substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, '') ,7,50),7,3))&lt;&gt;1)then '000' else substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, ''),7,50),7,3) end&#x9;else '00:00:00.000' END as VisitTime&#xA;&#x9;   ,CAST(CAST(ISNULL(c.external_identifier,'') AS NVARCHAR(max))+ISNULL(convert(varchar, t.track_start,12),'')+ISNULL(t.track_from,'') AS NVARCHAR(25)) Unique_reference&#xA;INTO   ##visitsbysource&#xA;FROM   [PPASS].[dbo].[source_deal_config]&#x9;&#x9;&#x9;&#x9;AS sdc WITH (Nolock)&#xA;       INNER JOIN [PPASS].[dbo].[source]&#x9;&#x9;&#x9;&#x9;AS s   WITH (Nolock) ON sdc.source_code = s.source_code&#xA;       INNER JOIN [PPASS].[dbo].[source_subscription] AS ss  WITH (Nolock) ON sdc.source_deal_config_id = ss.source_deal_config_id&#xA;       LEFT  JOIN [PPASS].[dbo].[subscription_level] scl WITH (Nolock) ON ss.subscription_level_id = scl.subscription_level_id&#xA;&#x9;   INNER JOIN [PPASS].[dbo].[purchase_subscription_link] AS psl WITH (Nolock) ON ss.source_subscription_id = psl.source_subscription_id&#xA;       INNER JOIN [PPASS].[dbo].[purchase]&#x9;&#x9;&#x9;AS p WITH (Nolock) ON psl.purchase_no = p.purchase_no&#xA;       INNER JOIN [PPASS].[dbo].[consumer]&#x9;&#x9;&#x9;AS c WITH (Nolock)  ON p.consumer_no = c.consumer_no&#xA;       INNER JOIN [PPASS].[dbo].[tracking]&#x9;&#x9;&#x9;AS t WITH (Nolock) ON p.purchase_no = t.purchase_no&#xA;       INNER JOIN [PPASS].[dbo].[lounge]&#x9;&#x9;&#x9;AS l WITH (Nolock) ON l.lounge_code = t.track_from&#xA;&#x9;   ----INNER JOIN PPASS.dbo.code&#x9;&#x9;&#x9;&#x9;AS c1 ON c1.code = l.airport AND c1.codetype = 'AIRPORT'&#xA;&#x9;     INNER JOIN  [PPASS].[dbo].[airport] AS a WITH (NOLOCK) ON a.iso_airport_code = l.airport&#xA;       LEFT OUTER JOIN [PPASS].[dbo].[code] AS COU WITH (Nolock) ON COU.code = l.country_code AND COU.codetype = 'CTRY'&#xA;&#x9;   LEFT OUTER JOIN [PPASS].[dbo].[code] AS dom WITH (Nolock) ON dom.code = l.lounge_type AND dom.codetype = 'LOUNGETYPE'&#xA;       LEFT OUTER JOIN [PPASS].[dbo].[source_invitation_validation] siv WITH (Nolock) ON siv.consumer_no = c.consumer_no&#xA;       LEFT OUTER JOIN [PPASS].[dbo].[consumer_bank_detail] cdb&#x9;WITH (Nolock)&#x9;  ON cdb.consumer_no = c.consumer_no&#xA;       LEFT OUTER JOIN [PPASS].[dbo].[partner_consumer_ext_detail_lk] pcdlk WITH (Nolock)&#x9;ON pcdlk.consumer_no = c.consumer_no&#xA;       LEFT OUTER JOIN [PPASS].[dbo].[partner_consumer_ext_detail] pcd WITH (Nolock)&#x9;ON pcd.partner_consumer_ext_detail_id = pcdlk.partner_consumer_ext_detail_id&#xA;       INNER JOIN [PPASS].[dbo].[purchase_visit_summary_data] AS pvsd&#x9;WITH (Nolock)&#x9;&#x9;ON t.purchase_no = pvsd.purchase_no&#xA;&#x9;&#x9;AND t.track_seq = pvsd.track_seq&#xA;WHERE  &#xA; t.track_status &lt;&gt; 'NA'&#xA;AND p.isDeleted = 0 &#xA;and s.source_code in ( &#xA;&quot;+@[User::strSource_Code_from_master] +&quot; )&#xA;AND CAST(DATEFROMPARTS(YEAR(t.creation_date) ,MONTH(t.creation_date),1)&#x9;AS DATE)= '&quot;+ &#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;  +&quot;' ORDER by  s.source_code;&quot;&#xA;  +&quot;/*1 query for Client_Member --1#visitor type id =1  MEM  ,,2#  Client 1 Pays  charge_owner_id 22  */&#xA;&#xA;IF OBJECT_ID('tempdb..#derived_visit_allocation1') IS NOT NULL&#xA;    DROP TABLE #derived_visit_allocation1;&#xA;&#xA;SELECT      pva.visit_count_from,&#xA;            pva.visit_count_to,&#xA;            pva.visit_validity_type_id,&#xA;            CASE&#xA;                 WHEN pva.visit_count_to = 9999 THEN 9999&#xA;                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)&#xA;                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,&#xA;            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;            pur.purchase_no,&#xA;            'Inclusive_PP_Member' colName&#xA;INTO        #derived_visit_allocation1&#xA;  FROM      purchase pur&#xA; INNER JOIN purchase_visit_allocation_link pval&#xA;    ON pval.purchase_no                      = pur.purchase_no&#xA; INNER JOIN purchase_visit_allocation_grp pvag&#xA;    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA; INNER JOIN purchase_visit_allocation pva&#xA;    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id&#xA;   AND pva.charge_owner_id                   = 22&#xA;   AND pva.visitor_type_id                   = 1&#xA;   AND pva.visit_allocation_type_id          &lt;&gt; 3&#xA;   AND pur.isdeleted                         = 0&#xA;   AND EXISTS (   SELECT 1&#xA;                    FROM ##visitsbysource temp2&#xA;                   WHERE temp2.purchase_no = pval.purchase_no)&#xA;  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,&#xA;                            pvah2.purchase_visit_allocation_id&#xA;                  FROM      purchase_visit_allocation_his AS pvah2&#xA;                 INNER JOIN purchase_visit_allocation pva2&#xA;                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id&#xA;                 INNER JOIN purchase_visit_allocation_link pval2&#xA;                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;                 WHERE      EXISTS (   SELECT 1&#xA;                                         FROM ##visitsbysource temp2&#xA;                                        WHERE temp2.purchase_no = pval2.purchase_no)&#xA;                   AND      pvah2.isdeleted      = 0&#xA;                   AND      pva2.visitor_type_id = 1&#xA;                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations&#xA;    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id&#xA; WHERE      (   (   pva.valid_from &lt;= '&quot;+&#xA; (DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;' AND pva.valid_to &gt;= '&quot;+&#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;')  OR   pva.visit_validity_type_id = 2);&quot;&#xA;+&quot;&#xA;IF OBJECT_ID('tempdb..#calculated_visit_allocation1') IS NOT NULL&#xA;    DROP TABLE #calculated_visit_allocation1;&#xA;&#xA;&#xA;SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;                         CASE&#xA;                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;                              WHEN derived_visit_allocation.visit_count_from = 0 THEN&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;                              ELSE&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END&#xA;                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,&#xA;      derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;       derived_visit_allocation.purchase_no,&#xA;       derived_visit_allocation.colname&#xA;INTO   #calculated_visit_allocation1&#xA;  FROM #derived_visit_allocation1 AS derived_visit_allocation;&#xA;&#xA;&#xA;UPDATE      t&#xA;   SET      t.Client_Member = ISNULL(c.value, 0)&#xA;  FROM      ##visitsbysource t&#xA;  LEFT JOIN #calculated_visit_allocation1 c&#xA;    ON t.purchase_no = c.purchase_no;&#xA;&#xA;&#xA;/*2 query for Inclusive_PP_Member --1#visitor type id =1  MEM  ,,2#PP Pays charge_owner_id 21 */&#xA;&#xA;IF OBJECT_ID('tempdb..#derived_visit_allocation2') IS NOT NULL&#xA;    DROP TABLE #derived_visit_allocation2;&#xA;&#xA;SELECT      pva.visit_count_from,&#xA;            pva.visit_count_to,&#xA;            pva.visit_validity_type_id,&#xA;            CASE&#xA;                 WHEN pva.visit_count_to = 9999 THEN 9999&#xA;                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)&#xA;                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,&#xA;            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;            pur.purchase_no,&#xA;            'Inclusive_PP_Member' colname&#xA;INTO        #derived_visit_allocation2&#xA;  FROM      purchase pur&#xA; INNER JOIN purchase_visit_allocation_link pval&#xA;    ON pval.purchase_no                      = pur.purchase_no&#xA; INNER JOIN purchase_visit_allocation_grp pvag&#xA;    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA; INNER JOIN purchase_visit_allocation pva&#xA;    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id&#xA;   AND pva.charge_owner_id                   = 21&#xA;   AND pva.visitor_type_id                   = 1&#xA;   AND pva.visit_allocation_type_id          &lt;&gt; 3&#xA;   AND pur.isdeleted                         = 0&#xA;   AND EXISTS (   SELECT 1&#xA;                    FROM ##visitsbysource temp2&#xA;                   WHERE temp2.purchase_no = pval.purchase_no)&#xA;  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,&#xA;                            pvah2.purchase_visit_allocation_id&#xA;                  FROM      purchase_visit_allocation_his AS pvah2&#xA;                 INNER JOIN purchase_visit_allocation pva2&#xA;                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id&#xA;                 INNER JOIN purchase_visit_allocation_link pval2&#xA;                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;                 WHERE      EXISTS (   SELECT 1&#xA;                                         FROM ##visitsbysource temp2&#xA;                                        WHERE temp2.purchase_no = pval2.purchase_no)&#xA;                   AND      pvah2.isdeleted      = 0&#xA;                   AND      pva2.visitor_type_id = 1&#xA;                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations&#xA;    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id&#xA; WHERE      (   (   pva.valid_from &lt;= '&quot;+&#xA; (DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;' AND pva.valid_to &gt;= '&quot;+&#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;')  OR   pva.visit_validity_type_id = 2);&quot;&#xA;+&quot;&#xA;IF OBJECT_ID('tempdb..#calculated_visit_allocation2') IS NOT NULL&#xA;    DROP TABLE #calculated_visit_allocation2;&#xA;&#xA;SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;                         CASE&#xA;                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;                              WHEN derived_visit_allocation.visit_count_from = 0 THEN&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;                              ELSE&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END&#xA;                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,&#xA;      derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;       derived_visit_allocation.purchase_no,&#xA;       derived_visit_allocation.colname&#xA;INTO   #calculated_visit_allocation2&#xA;  FROM #derived_visit_allocation2 AS derived_visit_allocation;&#xA;&#xA;UPDATE      t&#xA;   SET      t.Inclusive_PP_Member = ISNULL(c.value, 0)&#xA;  FROM      ##visitsbysource t&#xA;  LEFT JOIN #calculated_visit_allocation2 c&#xA;    ON t.purchase_no = c.purchase_no;&#xA;&#xA;&#xA;/*3 query for Client_guest ----1#visitor type id =2  GUE  ,,2#  Client 1 Pays charge_owner_id 22  */&#xA;IF OBJECT_ID('tempdb..#derived_visit_allocation3') IS NOT NULL&#xA;    DROP TABLE #derived_visit_allocation3;&#xA;&#xA;SELECT      pva.visit_count_from,&#xA;            pva.visit_count_to,&#xA;            pva.visit_validity_type_id,&#xA;            CASE&#xA;                 WHEN pva.visit_count_to = 9999 THEN 9999&#xA;                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)&#xA;                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,&#xA;            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;            pur.purchase_no,&#xA;            'Client_guest' colname&#xA;  &#x9;INTO    #derived_visit_allocation3&#xA;  FROM      purchase pur&#xA; INNER JOIN purchase_visit_allocation_link pval&#xA;    ON pval.purchase_no                      = pur.purchase_no&#xA; INNER JOIN purchase_visit_allocation_grp pvag&#xA;    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA; INNER JOIN purchase_visit_allocation pva&#xA;    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id&#xA;   AND pva.charge_owner_id                   = 22&#xA;   AND pva.visitor_type_id                   = 2&#xA;   AND pva.visit_allocation_type_id          &lt;&gt; 3&#xA;   AND pur.isdeleted                         = 0&#xA;   AND EXISTS (   SELECT 1&#xA;                    FROM ##visitsbysource temp2&#xA;                   WHERE temp2.purchase_no = pval.purchase_no)&#xA;  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,&#xA;                            pvah2.purchase_visit_allocation_id&#xA;                  FROM      purchase_visit_allocation_his AS pvah2&#xA;                 INNER JOIN purchase_visit_allocation pva2&#xA;                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id&#xA;                 INNER JOIN purchase_visit_allocation_link pval2&#xA;                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;                 WHERE      EXISTS (   SELECT 1&#xA;                                         FROM ##visitsbysource temp2&#xA;                                        WHERE temp2.purchase_no = pval2.purchase_no)&#xA;                   AND      pvah2.isdeleted      = 0&#xA;                   AND      pva2.visitor_type_id = 2&#xA;                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations&#xA;    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id&#xA; WHERE      (   (   pva.valid_from &lt;= '&quot;+&#xA; (DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;' AND pva.valid_to &gt;= '&quot;+&#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;')  OR   pva.visit_validity_type_id = 2);&quot;&#xA;+&quot;&#xA;&#xA;IF OBJECT_ID('tempdb..#calculated_visit_allocation3') IS NOT NULL&#xA;    DROP TABLE #calculated_visit_allocation3;&#xA;&#xA;SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;                         CASE&#xA;                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;                              WHEN derived_visit_allocation.visit_count_from = 0 THEN&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;                              ELSE&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END&#xA;                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,&#xA;      derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;       derived_visit_allocation.purchase_no,&#xA;       derived_visit_allocation.colname&#xA;INTO   #calculated_visit_allocation3&#xA;  FROM #derived_visit_allocation3 AS derived_visit_allocation;&#xA;&#xA;&#xA;UPDATE      t&#xA;   SET      t.Client_Guest = ISNULL(c.value, 0)&#xA;  FROM      ##visitsbysource t&#xA;  LEFT JOIN #calculated_visit_allocation3 c&#xA;    ON t.purchase_no = c.purchase_no;&#xA;&#xA;&#xA;/*4 query for Inclusive PP GUEST ----1#visitor type id =2  GUE  ,,2#PP Pays charge_owner_id 21 */&#xA;IF OBJECT_ID('tempdb..#derived_visit_allocation4') IS NOT NULL&#xA;    DROP TABLE #derived_visit_allocation4;&#xA;&#xA;SELECT      pva.visit_count_from,&#xA;            pva.visit_count_to,&#xA;            pva.visit_validity_type_id,&#xA;            CASE&#xA;                 WHEN pva.visit_count_to = 9999 THEN 9999&#xA;                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)&#xA;                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,&#xA;            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;            pur.purchase_no,&#xA;            'Inclusive_PP_Guest' colname&#xA;  &#x9;INTO    #derived_visit_allocation4&#xA;  FROM      purchase pur&#xA; INNER JOIN purchase_visit_allocation_link pval&#xA;    ON pval.purchase_no                      = pur.purchase_no&#xA; INNER JOIN purchase_visit_allocation_grp pvag&#xA;    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA; INNER JOIN purchase_visit_allocation pva&#xA;    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id&#xA;   AND pva.charge_owner_id                   = 21&#xA;   AND pva.visitor_type_id                   = 2&#xA;   AND pva.visit_allocation_type_id          &lt;&gt; 3&#xA;   AND pur.isdeleted                         = 0&#xA;   AND EXISTS (   SELECT 1&#xA;                    FROM ##visitsbysource temp2&#xA;                   WHERE temp2.purchase_no = pval.purchase_no)&#xA;  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,&#xA;                            pvah2.purchase_visit_allocation_id&#xA;                  FROM      purchase_visit_allocation_his AS pvah2&#xA;                 INNER JOIN purchase_visit_allocation pva2&#xA;                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id&#xA;                 INNER JOIN purchase_visit_allocation_link pval2&#xA;                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;                 WHERE      EXISTS (   SELECT 1&#xA;                                         FROM ##visitsbysource temp2&#xA;                                        WHERE temp2.purchase_no = pval2.purchase_no)&#xA;                   AND      pvah2.isdeleted      = 0&#xA;                   AND      pva2.visitor_type_id = 2&#xA;                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations&#xA;    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id&#xA; WHERE      (   (   pva.valid_from &lt;= '&quot;+&#xA; (DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;' AND pva.valid_to &gt;= '&quot;+&#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;')  OR   pva.visit_validity_type_id = 2);&quot;&#xA;+&quot;&#xA;IF OBJECT_ID('tempdb..#calculated_visit_allocation4') IS NOT NULL&#xA;    DROP TABLE #calculated_visit_allocation4;&#xA;&#xA;SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;                         CASE&#xA;                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;                              WHEN derived_visit_allocation.visit_count_from = 0 THEN&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;                              ELSE&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END&#xA;                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,&#xA;      derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;       derived_visit_allocation.purchase_no,&#xA;       derived_visit_allocation.colname&#xA;INTO   #calculated_visit_allocation4&#xA;  FROM #derived_visit_allocation4 AS derived_visit_allocation;&#xA;&#xA;&#xA;UPDATE      t&#xA;   SET      t.Inclusive_PP_Guest = ISNULL(c.value, 0)&#xA;  FROM      ##visitsbysource t&#xA;  LEFT JOIN #calculated_visit_allocation4 c&#xA;    ON t.purchase_no = c.purchase_no;&#xA;&#xA;&#xA;/*5 Client Member/GUEST    --1#visitor type id =3  Member/Guest  ,,,2#  Client 1 Pays  charge_owner_id 22 */&#xA;IF OBJECT_ID('tempdb..#derived_visit_allocation5') IS NOT NULL&#xA;    DROP TABLE #derived_visit_allocation5;&#xA;&#xA;SELECT      pva.visit_count_from,&#xA;            pva.visit_count_to,&#xA;            pva.visit_validity_type_id,&#xA;            CASE&#xA;                 WHEN pva.visit_count_to = 9999 THEN 9999&#xA;                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)&#xA;                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,&#xA;            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;            pur.purchase_no,&#xA;            'client_member_guest' colname&#xA;  &#x9;INTO    #derived_visit_allocation5&#xA;  FROM      purchase pur&#xA; INNER JOIN purchase_visit_allocation_link pval&#xA;    ON pval.purchase_no                      = pur.purchase_no&#xA; INNER JOIN purchase_visit_allocation_grp pvag&#xA;    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA; INNER JOIN purchase_visit_allocation pva&#xA;    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id&#xA;   AND pva.charge_owner_id                   = 22&#xA;   AND pva.visitor_type_id                   = 3&#xA;   AND pva.visit_allocation_type_id          &lt;&gt; 3&#xA;   AND pur.isdeleted                         = 0&#xA;   AND EXISTS (   SELECT 1&#xA;                    FROM ##visitsbysource temp2&#xA;                   WHERE temp2.purchase_no = pval.purchase_no)&#xA;  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,&#xA;                            pvah2.purchase_visit_allocation_id&#xA;                  FROM      purchase_visit_allocation_his AS pvah2&#xA;                 INNER JOIN purchase_visit_allocation pva2&#xA;                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id&#xA;                 INNER JOIN purchase_visit_allocation_link pval2&#xA;                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;                 WHERE      EXISTS (   SELECT 1&#xA;                                         FROM ##visitsbysource temp2&#xA;                                        WHERE temp2.purchase_no = pval2.purchase_no)&#xA;                   AND      pvah2.isdeleted      = 0&#xA;                   AND      pva2.visitor_type_id = 3&#xA;                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations&#xA;    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id&#xA; WHERE      (   (   pva.valid_from &lt;= '&quot;+&#xA; (DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;' AND pva.valid_to &gt;= '&quot;+&#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;')  OR   pva.visit_validity_type_id = 2);&quot;&#xA;+&quot;&#xA;&#xA;IF OBJECT_ID('tempdb..#calculated_visit_allocation5') IS NOT NULL&#xA;    DROP TABLE #calculated_visit_allocation5;&#xA;&#xA;SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;                         CASE&#xA;                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;                              WHEN derived_visit_allocation.visit_count_from = 0 THEN&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;                              ELSE&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END&#xA;                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,&#xA;      derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;       derived_visit_allocation.purchase_no,&#xA;       derived_visit_allocation.colname&#xA;INTO   #calculated_visit_allocation5&#xA;  FROM #derived_visit_allocation5 AS derived_visit_allocation;&#xA;&#xA;&#xA;UPDATE      t&#xA;   SET      t.Client_Member_Guest = ISNULL(c.value, 0)&#xA;  FROM      ##visitsbysource t&#xA;  LEFT JOIN #calculated_visit_allocation5 c&#xA;    ON t.purchase_no = c.purchase_no;&#xA;&#xA;/*6 query for Inclusive PP Member/GUEST  --1#visitor type id =3  Member/Guest  ,,,2#PP Pays charge_owner_id 21 */&#xA;IF OBJECT_ID('tempdb..#derived_visit_allocation6') IS NOT NULL&#xA;    DROP TABLE #derived_visit_allocation6;&#xA;&#xA;SELECT      pva.visit_count_from,&#xA;            pva.visit_count_to,&#xA;            pva.visit_validity_type_id,&#xA;            CASE&#xA;                 WHEN pva.visit_count_to = 9999 THEN 9999&#xA;                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)&#xA;                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,&#xA;            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;            pur.purchase_no,&#xA;            'Inclusive_PP_Member_guest' colname&#xA;  &#x9;INTO    #derived_visit_allocation6&#xA;  FROM      purchase pur&#xA; INNER JOIN purchase_visit_allocation_link pval&#xA;    ON pval.purchase_no                      = pur.purchase_no&#xA; INNER JOIN purchase_visit_allocation_grp pvag&#xA;    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA; INNER JOIN purchase_visit_allocation pva&#xA;    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id&#xA;   AND pva.charge_owner_id                   = 21&#xA;   AND pva.visitor_type_id                   = 3&#xA;   AND pva.visit_allocation_type_id          &lt;&gt; 3&#xA;   AND pur.isdeleted                         = 0&#xA;   AND EXISTS (   SELECT 1&#xA;                    FROM ##visitsbysource temp2&#xA;                   WHERE temp2.purchase_no = pval.purchase_no)&#xA;  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,&#xA;                            pvah2.purchase_visit_allocation_id&#xA;                  FROM      purchase_visit_allocation_his AS pvah2&#xA;                 INNER JOIN purchase_visit_allocation pva2&#xA;                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id&#xA;                 INNER JOIN purchase_visit_allocation_link pval2&#xA;                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;                 WHERE      EXISTS (   SELECT 1&#xA;                                         FROM ##visitsbysource temp2&#xA;                                        WHERE temp2.purchase_no = pval2.purchase_no)&#xA;                   AND      pvah2.isdeleted      = 0&#xA;                   AND      pva2.visitor_type_id = 3&#xA;                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations&#xA;    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id&#xA; WHERE      (   (   pva.valid_from &lt;= '&quot;+&#xA; (DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;' AND pva.valid_to &gt;= '&quot;+&#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;')  OR   pva.visit_validity_type_id = 2);&quot;&#xA;+&quot;&#xA;&#xA;IF OBJECT_ID('tempdb..#calculated_visit_allocation6') IS NOT NULL&#xA;    DROP TABLE #calculated_visit_allocation6;&#xA;&#xA;SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;                         CASE&#xA;                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;                              WHEN derived_visit_allocation.visit_count_from = 0 THEN&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;                              ELSE&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END&#xA;                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,&#xA;      derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;       derived_visit_allocation.purchase_no,&#xA;       derived_visit_allocation.colname&#xA;INTO   #calculated_visit_allocation6&#xA;  FROM #derived_visit_allocation6 AS derived_visit_allocation;&#xA;&#xA;&#xA;UPDATE      t&#xA;   SET      t.Inclusive_PP_Member_Guest = ISNULL(c.value, 0)&#xA;  FROM      ##visitsbysource t&#xA;  LEFT JOIN #calculated_visit_allocation6 c&#xA;    ON t.purchase_no = c.purchase_no;&#xA;&#xA;/*7 query for Complimentary Member/GUEST ----1#visitor type id =3  Member/Guest  ,,,2#  LPAYVISIT&#x9;  charge_owner_id 24   */&#xA;IF OBJECT_ID('tempdb..#derived_visit_allocation7') IS NOT NULL&#xA;    DROP TABLE #derived_visit_allocation7;&#xA;&#xA;SELECT      pva.visit_count_from,&#xA;            pva.visit_count_to,&#xA;            pva.visit_validity_type_id,&#xA;            CASE&#xA;                 WHEN pva.visit_count_to = 9999 THEN 9999&#xA;                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)&#xA;                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,&#xA;            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,&#xA;            pur.purchase_no,&#xA;            'Complimentary_Member_Guest' colname&#xA;INTO        #derived_visit_allocation7&#xA;  FROM      purchase pur&#xA; INNER JOIN purchase_visit_allocation_link pval&#xA;    ON pval.purchase_no                      = pur.purchase_no&#xA; INNER JOIN purchase_visit_allocation_grp pvag&#xA;    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id&#xA; INNER JOIN purchase_visit_allocation pva&#xA;    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id&#xA;   AND pva.charge_owner_id                   = 24&#xA;   AND pva.visitor_type_id                   = 3&#xA;   AND pva.visit_allocation_type_id          &lt;&gt; 3&#xA;   AND pur.isdeleted                         = 0&#xA;   AND EXISTS (   SELECT 1&#xA;                    FROM ##visitsbysource temp2&#xA;                   WHERE temp2.purchase_no = pval.purchase_no)&#xA;  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,&#xA;                            pvah2.purchase_visit_allocation_id&#xA;                  FROM      purchase_visit_allocation_his AS pvah2&#xA;                 INNER JOIN purchase_visit_allocation pva2&#xA;                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id&#xA;                 INNER JOIN purchase_visit_allocation_link pval2&#xA;                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id&#xA;                 WHERE      EXISTS (   SELECT 1&#xA;                                         FROM ##visitsbysource temp2&#xA;                                        WHERE temp2.purchase_no = pval2.purchase_no)&#xA;                   AND      pvah2.isdeleted      = 0&#xA;                   AND      pva2.visitor_type_id = 3&#xA;                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations&#xA;    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id&#xA; WHERE      (   (   pva.valid_from &lt;= '&quot;+&#xA; (DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;' AND pva.valid_to &gt;= '&quot;+&#xA;(DT_WSTR, 4) year( @[User::dtStartDate])+&quot;-&quot;+ right(&quot;00&quot; + (DT_WSTR, 2) month( @[User::dtStartDate] ),2) +&quot;-&quot;+right(&quot;00&quot; + (DT_WSTR, 2) day( @[User::dtStartDate] ),2)&#xA;+&quot;')  OR   pva.visit_validity_type_id = 2);&quot;&#xA;+&quot;&#xA;&#xA;IF OBJECT_ID('tempdb..#calculated_visit_allocation7') IS NOT NULL&#xA;    DROP TABLE #calculated_visit_allocation7;&#xA;&#xA;SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN&#xA;                         CASE&#xA;                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999&#xA;                              WHEN derived_visit_allocation.visit_count_from = 0 THEN&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)&#xA;                              ELSE&#xA;    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END&#xA;                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,&#xA;      derived_visit_allocation.used_visit_count AS used_visit_number,&#xA;       derived_visit_allocation.purchase_no,&#xA;       derived_visit_allocation.colname&#xA;INTO   #calculated_visit_allocation7&#xA;  FROM #derived_visit_allocation7 AS derived_visit_allocation;&#xA;&#xA;&#xA;UPDATE      t&#xA;   SET      t.Complimentary_Member_Guest = ISNULL(c.value, 0)&#xA;  FROM      ##visitsbysource t&#xA;  LEFT JOIN #calculated_visit_allocation7 c&#xA;    ON t.purchase_no = c.purchase_no;&#xA;&#xA;&#x9;SELECT * FROM ##visitsbysource&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="testVariable">
      <DTS:VariableValue
        DTS:DataType="8">SET FMTONLY ON
SELECT CAST(NULL AS date) AS report_month ,CAST(NULL AS nvarchar(4000)) AS [Process month] ,CAST(NULL AS varchar(15)) AS Source_Code ,CAST(NULL AS varchar(30)) AS Source_code_desc ,CAST(NULL AS bigint) AS Member_No ,
CAST(NULL AS int) AS consumer_no ,CAST(NULL AS int) AS purchase_no ,CAST(NULL AS varchar(18)) AS CCard_No ,CAST(NULL AS varchar(30)) AS ppid ,CAST(NULL AS varchar(10)) AS bin ,CAST(NULL AS varchar(15)) AS Title ,CAST(NULL AS varchar(15)) AS First_Name ,
CAST(NULL AS varchar(30)) AS Last_Name ,CAST(NULL AS varchar(7)) AS Membership_Plan ,CAST(NULL AS varchar(2)) AS Member_Status ,CAST(NULL AS datetime2(2)) AS Paid_To_date ,CAST(NULL AS datetime2(2)) AS Visit_Date ,
CAST(NULL AS datetime2(2)) AS Visit_Date2 ,CAST(NULL AS datetime2(2)) AS Date_Processed ,CAST(NULL AS varchar(2)) AS Visit_status ,CAST(NULL AS int) AS Visit_seq ,CAST(NULL AS smallint) AS GuestVisits ,
CAST(NULL AS int) AS Batch_No ,CAST(NULL AS varchar(2)) AS consumer_service_centre ,CAST(NULL AS varchar(1)) AS deal_service_centre ,CAST(NULL AS varchar(2)) AS retail_client_service_centre ,
CAST(NULL AS varchar(20)) AS Reference ,CAST(NULL AS varchar(10)) AS Lounge_Code ,CAST(NULL AS varchar(80)) AS Lounge ,CAST(NULL AS varchar(40)) AS domestic_int_lounge ,CAST(NULL AS varchar(50)) AS Airport ,
CAST(NULL AS varchar(100)) AS City ,CAST(NULL AS varchar(40)) AS Country ,CAST(NULL AS tinyint) AS Client_Pays_Member_Visit ,CAST(NULL AS tinyint) AS Inclusive_PP_Member_Visit ,
CAST(NULL AS tinyint) AS Complimentary_Member_Visit ,CAST(NULL AS tinyint) AS Cardholder_Pays_Member_Visit ,CAST(NULL AS tinyint) AS Client_Pays_Guest_Visit ,CAST(NULL AS tinyint) AS Inclusive_PP_Guest_Visit ,
CAST(NULL AS tinyint) AS Complimentary_Guest_Visit ,CAST(NULL AS tinyint) AS Cardholder_Pays_Guest_Visit ,CAST(NULL AS tinyint) AS Lounge_Visit_Offer ,CAST(NULL AS int) AS Client_Member ,
CAST(NULL AS int) AS Inclusive_PP_Member ,CAST(NULL AS int) AS Client_Guest ,CAST(NULL AS int) AS Inclusive_PP_Guest ,CAST(NULL AS int) AS Client_Member_Guest ,CAST(NULL AS int) AS Inclusive_PP_Member_Guest ,
CAST(NULL AS int) AS Complimentary_Member_Guest ,CAST(NULL AS varchar(2)) AS Client_Visit_Currency_Member ,CAST(NULL AS decimal(10,2)) AS Client_Visit_Amount_Member ,CAST(NULL AS varchar(2)) AS Client_Visit_Currency_Guest ,
CAST(NULL AS decimal(10,2)) AS Client_Visit_Amount_Guest ,CAST(NULL AS varchar(2)) AS Total_Client_Amount_Currency ,CAST(NULL AS decimal(11,2)) AS Total_Client_Amount ,
CAST(NULL AS varchar(2)) AS Cardholder_Visit_Currency_Member ,CAST(NULL AS decimal(10,2)) AS Cardholder_Visit_Amount_Member ,
CAST(NULL AS varchar(2)) AS Cardholder_Visit_Currency_Guest ,CAST(NULL AS decimal(10,2)) AS Cardholder_Visit_Amount_Guest ,CAST(NULL AS varchar(2)) AS Total_Cardholder_Amount_Currency ,
CAST(NULL AS decimal(11,2)) AS Total_Cardholder_Amount ,CAST(NULL AS varchar(10)) AS Cost_Centre ,CAST(NULL AS varchar(10)) AS Campaign_Code ,CAST(NULL AS varchar(10)) AS Vendor_Code ,CAST(NULL AS varchar(10)) AS User_Invitation_Code ,
CAST(NULL AS varchar(12)) AS VisitTime ,CAST(NULL AS nvarchar(25)) AS Unique_reference
SET FMTONLY OFF

IF OBJECT_ID('tempdb..##visitsbysource') IS NOT NULL
    DROP TABLE ##visitsBySource;

SELECT 
                      CAST(CONCAT(YEAR(t.creation_date) , '-' , MONTH(t.creation_date) , '-01' ) AS DATE)	 AS	[report_month],
	FORMAT(CAST('2018-07-01' AS DATE), 'MMM-yy') AS [Process month]
	,s.source_code					AS Source_Code
        ,s.source_desc                                  AS Source_code_desc
	,c.external_identifier					AS Member_No
        , c.consumer_no                                         AS consumer_no   
        ,p.[purchase_no]                                        AS purchase_no
	,P.trans_ccard_number                                   AS CCard_No
        ,CASE WHEN c.consumer_type_id IN (1,5) THEN t.unique_card_no END
 AS ppid
        ,CASE WHEN CHARINDEX('*', t.unique_card_no) &gt; 0 THEN LEFT(p.trans_ccard_number, 10) ELSE NULL END  AS bin    
	--,0  AS CCard_No
	,c.title						AS Title
	,c.forename						AS First_Name
	,c.surname						AS Last_Name
	,p.product_version				AS Membership_Plan
	,p.subs_status					AS Member_Status
	,p.paid_to_date					AS Paid_To_date
	,t.track_start					AS Visit_Date
	,t.[track_start_full]                           AS Visit_Date2
	,t.creation_date				AS Date_Processed
	,t.track_status                                  AS Visit_status
	,t.track_seq                                     AS Visit_seq
	,t.track_guests					AS GuestVisits
	,t.track_batch					AS Batch_No
        ,c.service_centre                              AS consumer_service_centre
        ,s.servicecentre                               AS deal_service_centre
        ,COALESCE(NULLIF(s.servicecentre, ''), NULLIF(c.service_centre, '')) AS retail_client_service_centre
	,t.external_ref					AS Reference
	,t.track_from					AS Lounge_Code
	,l.lounge_name					AS Lounge
	,dom.code_desc                                  AS domestic_int_lounge
	,a.pp_short_name				AS Airport
	,a.airport_city 				AS City
	,COU.code_desc					AS Country
	,pvsd.[count_mem_cli]			AS Client_Pays_Member_Visit
	,pvsd.[count_mem_pp]			AS Inclusive_PP_Member_Visit
	,pvsd.[count_mem_comp]			AS Complimentary_Member_Visit
	,pvsd.[count_mem_mem]			AS Cardholder_Pays_Member_Visit
	,pvsd.[count_gue_cli]			AS Client_Pays_Guest_Visit
	,pvsd.[count_gue_pp]			AS Inclusive_PP_Guest_Visit
	,pvsd.[count_gue_comp]			AS Complimentary_Guest_Visit
	,pvsd.[count_gue_mem]			AS Cardholder_Pays_Guest_Visit
	,pvsd.[count_gue_lou]			AS Lounge_Visit_Offer
	,0 								AS Client_Member
	,0 								AS Inclusive_PP_Member
	,0 								AS Client_Guest
	,0 								AS Inclusive_PP_Guest
	,0 								AS Client_Member_Guest
	,0 								AS Inclusive_PP_Member_Guest
	,0 								AS Complimentary_Member_Guest
	,pvsd.[fee_mem_cli_curr]		AS Client_Visit_Currency_Member
	,pvsd.[fee_mem_cli]				AS Client_Visit_Amount_Member
	,pvsd.[fee_gue_cli_curr]		AS Client_Visit_Currency_Guest
	,pvsd.[fee_gue_cli]				AS Client_Visit_Amount_Guest
	,CASE 
		WHEN len(pvsd.[fee_mem_cli_curr]) &gt; 0 
			THEN pvsd.[fee_mem_cli_curr] 
		WHEN len(pvsd.[fee_gue_cli_curr]) &gt; 0 
			THEN pvsd.[fee_gue_cli_curr] 
		ELSE ' ' 
	END								AS Total_Client_Amount_Currency
	,CASE 
		WHEN (pvsd.fee_mem_cli_curr = pvsd.fee_gue_cli_curr) AND Len(pvsd.fee_mem_cli_curr) &gt; 0 
			THEN pvsd.fee_mem_cli + pvsd.fee_gue_cli
		WHEN Len(pvsd.fee_mem_cli_curr) &gt; 0 
			THEN pvsd.fee_mem_cli
		WHEN Len(pvsd.fee_gue_cli_curr) &gt; 0 THEN pvsd.fee_gue_cli
	       ELSE 0.00
	END AS Total_Client_Amount	 
	,pvsd.fee_mem_mem_curr	AS Cardholder_Visit_Currency_Member	
	,pvsd.fee_mem_mem		AS Cardholder_Visit_Amount_Member	
	,pvsd.fee_gue_mem_curr	AS Cardholder_Visit_Currency_Guest	
	,pvsd.fee_gue_mem		AS Cardholder_Visit_Amount_Guest	
	,CASE 
		WHEN Len(pvsd.fee_mem_mem_curr) &gt; 0 
			THEN pvsd.fee_mem_mem_curr
		WHEN Len(pvsd.fee_gue_mem_curr) &gt; 0 
			THEN pvsd.fee_gue_mem_curr
		ELSE ' '
    END						AS Total_Cardholder_Amount_Currency	
	,CASE 
		WHEN (pvsd.fee_mem_mem_curr = pvsd.fee_gue_mem_curr) AND Len(pvsd.fee_mem_mem_curr) &gt; 0 
			THEN pvsd.fee_mem_mem + pvsd.fee_gue_mem
		WHEN Len(pvsd.fee_mem_mem_curr) &gt; 0 
			THEN pvsd.fee_mem_mem
		WHEN Len(pvsd.fee_gue_mem_curr) &gt; 0 
			THEN pvsd.fee_gue_mem
		ELSE 0.00
	END						AS Total_Cardholder_Amount	
	,left(p.old_system_ref,10)			AS Cost_Centre	
	,s.campaign_code					AS Campaign_Code	
	,siv.vendor_tracking_code			AS Vendor_Code	
	,siv.user_invitation_code			AS User_Invitation_Code	
	,case when CHARINDEX(t.track_from, t.external_ref) &gt; 0 then  substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, '') ,7,50),1,2)+ ':' + substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, '') ,7,50),3,2) + ':' + substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, '') ,7,50),5,2) +'.' + case when (SUBSTRING(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, ''),7,50),7,3) ='' OR ISDATE(substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, '') ,7,50),7,3))&lt;&gt;1)then '000' else substring(substring(replace(REPLACE(t.external_ref,' ',''),t.track_from, ''),7,50),7,3) end	else '00:00:00.000' END as VisitTime
	   ,CAST(CAST(ISNULL(c.external_identifier,'') AS NVARCHAR(max))+ISNULL(convert(varchar, t.track_start,12),'')+ISNULL(t.track_from,'') AS NVARCHAR(25)) Unique_reference
INTO   ##visitsbysource
FROM   [PPASS].[dbo].[source_deal_config]				AS sdc WITH (Nolock)
       INNER JOIN [PPASS].[dbo].[source]				AS s   WITH (Nolock) ON sdc.source_code = s.source_code
       INNER JOIN [PPASS].[dbo].[source_subscription] AS ss  WITH (Nolock) ON sdc.source_deal_config_id = ss.source_deal_config_id
       LEFT  JOIN [PPASS].[dbo].[subscription_level] scl WITH (Nolock) ON ss.subscription_level_id = scl.subscription_level_id
	   INNER JOIN [PPASS].[dbo].[purchase_subscription_link] AS psl WITH (Nolock) ON ss.source_subscription_id = psl.source_subscription_id
       INNER JOIN [PPASS].[dbo].[purchase]			AS p WITH (Nolock) ON psl.purchase_no = p.purchase_no
       INNER JOIN [PPASS].[dbo].[consumer]			AS c WITH (Nolock)  ON p.consumer_no = c.consumer_no
       INNER JOIN [PPASS].[dbo].[tracking]			AS t WITH (Nolock) ON p.purchase_no = t.purchase_no
       INNER JOIN [PPASS].[dbo].[lounge]			AS l WITH (Nolock) ON l.lounge_code = t.track_from
	   ----INNER JOIN PPASS.dbo.code				AS c1 ON c1.code = l.airport AND c1.codetype = 'AIRPORT'
	     INNER JOIN  [PPASS].[dbo].[airport] AS a WITH (NOLOCK) ON a.iso_airport_code = l.airport
       LEFT OUTER JOIN [PPASS].[dbo].[code] AS COU WITH (Nolock) ON COU.code = l.country_code AND COU.codetype = 'CTRY'
	   LEFT OUTER JOIN [PPASS].[dbo].[code] AS dom WITH (Nolock) ON dom.code = l.lounge_type AND dom.codetype = 'LOUNGETYPE'
       LEFT OUTER JOIN [PPASS].[dbo].[source_invitation_validation] siv WITH (Nolock) ON siv.consumer_no = c.consumer_no
       LEFT OUTER JOIN [PPASS].[dbo].[consumer_bank_detail] cdb	WITH (Nolock)	  ON cdb.consumer_no = c.consumer_no
       LEFT OUTER JOIN [PPASS].[dbo].[partner_consumer_ext_detail_lk] pcdlk WITH (Nolock)	ON pcdlk.consumer_no = c.consumer_no
       LEFT OUTER JOIN [PPASS].[dbo].[partner_consumer_ext_detail] pcd WITH (Nolock)	ON pcd.partner_consumer_ext_detail_id = pcdlk.partner_consumer_ext_detail_id
       INNER JOIN [PPASS].[dbo].[purchase_visit_summary_data] AS pvsd	WITH (Nolock)		ON t.purchase_no = pvsd.purchase_no
		AND t.track_seq = pvsd.track_seq
WHERE  
 t.track_status &lt;&gt; 'NA'
AND p.isDeleted = 0 
and s.source_code in ( 
'2WLS12','2WLS14','ABC13','ABRSM10','AFA14','AIF11','AIRPLUS09','AIRTELGBN14','AIRTELGHA14','AIRTELKEN14','AIRTELMAD14','AIRTELMAL14','AIRTELNGR14','AIRTELNGR214','AIRTELNIGER14','AIRTELRWA14','AIRTELSEY14','AIRTELTANZ14','AIRTELTCHAD14','AIRTELZAM14','AKCB2011','ALJOUF15','ALRAJHI15','AMEELY12','AMEXSAU10','APE08','ASI13','AVISE07','AXTMRP08','B2U14','BAML13','BCCGDLS10','BCCGLS15','BCCPLATLS10','BCCPLS15','BPSHIP0710','CANON11','CCIT13','CEO13','CGSTAFFCOMP','CITI13','CITI14','COL02','COL06','COMZ0208,PPCOMMBK,PPCOMMERZ,PPCOMMERZ1','CORN02','CORNER13','DANFOSS14','DEXIA09','DREL2010','EMIRITG11','EUROPCAREN14','EZE13','FESTO13','FMDL12','FNB2011','GOMEXICO12','GRUN1511','HBSWEBUS10MC','HBSWEBUS10VS','HONEYWELL08','IAAT2015','KEYSLSTY2015','KEYSLSTY22015','LIBERTY15','LTSB0410','LTSB06','LTSB1010','MARD08','MBNA05','MCCOMP5FREE','MEHR09','MELIA2015','MOBILY13','MWSG1008','NBB13','NEB13','NMMS07','NO1T2010','NORD09','NORDICCORPAX06','NOV2015','OOREDOO15','OOREDOOMAL15','OOREDOOMALINV15','ORAG08','PORTAMEX06','PPACCIST17','PPAMIST2016','PPASLHVSP16','PPATPPG18','PPAXAST616','PPBARVSINF16','PPBPFPG16','PPBPFSP16','PPBSBE216','PPBU022015','PPBU062015','PPBU102015','PPBUPAPG17','PPCRSP16','PPDRGPPG17','PPDRGPSP17','PPHANPG17','PPHIFXPG17','PPKETPG16','PPMEDELSP17','PPMIKRCPG18','PPOEBPG2016','PPOEBSP2016','PPOLHPLPST2015','PPOMPCSP2016','PPOMPCSTD2015','PPOOST16','PPQUGSP17','PPRCLCST042015','PPSJC2016','PPSJCP2016','PPSJFCAST16','PPSJFCASTP16','PPTBSLSP17','PPTEEKAUS16','PPTEEKCON16','PPTEEKGAS16','PPTEEKSHU16','PPTEEKSPC16','PPTEEKSPG16','PPTRANSACT2016','PPTTCST16','PPTTCST316','PPWANUPST217','PPWBLNPG16','PURE13','QUI0012P2,QUI0012P','RCIREG05','REWORLD14','RIEBER08','RIEBER09','SAXO14','SCENIC2015','SCHLUM06','SGPBH10','SKERRITTS14','SMITH12','SMITHPG18','SMITHSP18','SWCAEC05','TCGMCCOMPS','TCGSTAFFCOMPS','TEEK07','TNB12015','TNB52015','TRANS07','TRANSACT11','TRCAFF11','TVLC08','UCB1508','ULSTER09/CIMSUBS04','UNICTYSU08','VODAFONE0213','VODAFONE0413','VODAFONE1013','VODAFONE1513','WELLWOOD2015','WEXAS09','YKM15' )
AND CAST(DATEFROMPARTS(YEAR(t.creation_date) ,MONTH(t.creation_date),1)	AS DATE)= '2018-07-01' ORDER by  s.source_code;/*1 query for Client_Member --1#visitor type id =1  MEM  ,,2#  Client 1 Pays  charge_owner_id 22  */

IF OBJECT_ID('tempdb..#derived_visit_allocation1') IS NOT NULL
    DROP TABLE #derived_visit_allocation1;

SELECT      pva.visit_count_from,
            pva.visit_count_to,
            pva.visit_validity_type_id,
            CASE
                 WHEN pva.visit_count_to = 9999 THEN 9999
                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)
                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,
            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
            pur.purchase_no,
            'Inclusive_PP_Member' colName
INTO        #derived_visit_allocation1
  FROM      purchase pur
 INNER JOIN purchase_visit_allocation_link pval
    ON pval.purchase_no                      = pur.purchase_no
 INNER JOIN purchase_visit_allocation_grp pvag
    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
 INNER JOIN purchase_visit_allocation pva
    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id
   AND pva.charge_owner_id                   = 22
   AND pva.visitor_type_id                   = 1
   AND pva.visit_allocation_type_id          &lt;&gt; 3
   AND pur.isdeleted                         = 0
   AND EXISTS (   SELECT 1
                    FROM ##visitsbysource temp2
                   WHERE temp2.purchase_no = pval.purchase_no)
  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,
                            pvah2.purchase_visit_allocation_id
                  FROM      purchase_visit_allocation_his AS pvah2
                 INNER JOIN purchase_visit_allocation pva2
                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id
                 INNER JOIN purchase_visit_allocation_link pval2
                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
                 WHERE      EXISTS (   SELECT 1
                                         FROM ##visitsbysource temp2
                                        WHERE temp2.purchase_no = pval2.purchase_no)
                   AND      pvah2.isdeleted      = 0
                   AND      pva2.visitor_type_id = 1
                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations
    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id
 WHERE      (   (   pva.valid_from &lt;= '2018-07-01' AND pva.valid_to &gt;= '2018-07-01')  OR   pva.visit_validity_type_id = 2);
IF OBJECT_ID('tempdb..#calculated_visit_allocation1') IS NOT NULL
    DROP TABLE #calculated_visit_allocation1;


SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
                         CASE
                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
                              WHEN derived_visit_allocation.visit_count_from = 0 THEN
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
                              ELSE
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END
                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,
      derived_visit_allocation.used_visit_count AS used_visit_number,
       derived_visit_allocation.purchase_no,
       derived_visit_allocation.colname
INTO   #calculated_visit_allocation1
  FROM #derived_visit_allocation1 AS derived_visit_allocation;


UPDATE      t
   SET      t.Client_Member = ISNULL(c.value, 0)
  FROM      ##visitsbysource t
  LEFT JOIN #calculated_visit_allocation1 c
    ON t.purchase_no = c.purchase_no;


/*2 query for Inclusive_PP_Member --1#visitor type id =1  MEM  ,,2#PP Pays charge_owner_id 21 */

IF OBJECT_ID('tempdb..#derived_visit_allocation2') IS NOT NULL
    DROP TABLE #derived_visit_allocation2;

SELECT      pva.visit_count_from,
            pva.visit_count_to,
            pva.visit_validity_type_id,
            CASE
                 WHEN pva.visit_count_to = 9999 THEN 9999
                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)
                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,
            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
            pur.purchase_no,
            'Inclusive_PP_Member' colname
INTO        #derived_visit_allocation2
  FROM      purchase pur
 INNER JOIN purchase_visit_allocation_link pval
    ON pval.purchase_no                      = pur.purchase_no
 INNER JOIN purchase_visit_allocation_grp pvag
    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
 INNER JOIN purchase_visit_allocation pva
    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id
   AND pva.charge_owner_id                   = 21
   AND pva.visitor_type_id                   = 1
   AND pva.visit_allocation_type_id          &lt;&gt; 3
   AND pur.isdeleted                         = 0
   AND EXISTS (   SELECT 1
                    FROM ##visitsbysource temp2
                   WHERE temp2.purchase_no = pval.purchase_no)
  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,
                            pvah2.purchase_visit_allocation_id
                  FROM      purchase_visit_allocation_his AS pvah2
                 INNER JOIN purchase_visit_allocation pva2
                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id
                 INNER JOIN purchase_visit_allocation_link pval2
                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
                 WHERE      EXISTS (   SELECT 1
                                         FROM ##visitsbysource temp2
                                        WHERE temp2.purchase_no = pval2.purchase_no)
                   AND      pvah2.isdeleted      = 0
                   AND      pva2.visitor_type_id = 1
                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations
    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id
 WHERE      (   (   pva.valid_from &lt;= '2018-07-01' AND pva.valid_to &gt;= '2018-07-01')  OR   pva.visit_validity_type_id = 2);
IF OBJECT_ID('tempdb..#calculated_visit_allocation2') IS NOT NULL
    DROP TABLE #calculated_visit_allocation2;

SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
                         CASE
                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
                              WHEN derived_visit_allocation.visit_count_from = 0 THEN
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
                              ELSE
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END
                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,
      derived_visit_allocation.used_visit_count AS used_visit_number,
       derived_visit_allocation.purchase_no,
       derived_visit_allocation.colname
INTO   #calculated_visit_allocation2
  FROM #derived_visit_allocation2 AS derived_visit_allocation;

UPDATE      t
   SET      t.Inclusive_PP_Member = ISNULL(c.value, 0)
  FROM      ##visitsbysource t
  LEFT JOIN #calculated_visit_allocation2 c
    ON t.purchase_no = c.purchase_no;


/*3 query for Client_guest ----1#visitor type id =2  GUE  ,,2#  Client 1 Pays charge_owner_id 22  */
IF OBJECT_ID('tempdb..#derived_visit_allocation3') IS NOT NULL
    DROP TABLE #derived_visit_allocation3;

SELECT      pva.visit_count_from,
            pva.visit_count_to,
            pva.visit_validity_type_id,
            CASE
                 WHEN pva.visit_count_to = 9999 THEN 9999
                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)
                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,
            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
            pur.purchase_no,
            'Client_guest' colname
  	INTO    #derived_visit_allocation3
  FROM      purchase pur
 INNER JOIN purchase_visit_allocation_link pval
    ON pval.purchase_no                      = pur.purchase_no
 INNER JOIN purchase_visit_allocation_grp pvag
    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
 INNER JOIN purchase_visit_allocation pva
    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id
   AND pva.charge_owner_id                   = 22
   AND pva.visitor_type_id                   = 2
   AND pva.visit_allocation_type_id          &lt;&gt; 3
   AND pur.isdeleted                         = 0
   AND EXISTS (   SELECT 1
                    FROM ##visitsbysource temp2
                   WHERE temp2.purchase_no = pval.purchase_no)
  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,
                            pvah2.purchase_visit_allocation_id
                  FROM      purchase_visit_allocation_his AS pvah2
                 INNER JOIN purchase_visit_allocation pva2
                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id
                 INNER JOIN purchase_visit_allocation_link pval2
                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
                 WHERE      EXISTS (   SELECT 1
                                         FROM ##visitsbysource temp2
                                        WHERE temp2.purchase_no = pval2.purchase_no)
                   AND      pvah2.isdeleted      = 0
                   AND      pva2.visitor_type_id = 2
                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations
    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id
 WHERE      (   (   pva.valid_from &lt;= '2018-07-01' AND pva.valid_to &gt;= '2018-07-01')  OR   pva.visit_validity_type_id = 2);

IF OBJECT_ID('tempdb..#calculated_visit_allocation3') IS NOT NULL
    DROP TABLE #calculated_visit_allocation3;

SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
                         CASE
                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
                              WHEN derived_visit_allocation.visit_count_from = 0 THEN
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
                              ELSE
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END
                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,
      derived_visit_allocation.used_visit_count AS used_visit_number,
       derived_visit_allocation.purchase_no,
       derived_visit_allocation.colname
INTO   #calculated_visit_allocation3
  FROM #derived_visit_allocation3 AS derived_visit_allocation;


UPDATE      t
   SET      t.Client_Guest = ISNULL(c.value, 0)
  FROM      ##visitsbysource t
  LEFT JOIN #calculated_visit_allocation3 c
    ON t.purchase_no = c.purchase_no;


/*4 query for Inclusive PP GUEST ----1#visitor type id =2  GUE  ,,2#PP Pays charge_owner_id 21 */
IF OBJECT_ID('tempdb..#derived_visit_allocation4') IS NOT NULL
    DROP TABLE #derived_visit_allocation4;

SELECT      pva.visit_count_from,
            pva.visit_count_to,
            pva.visit_validity_type_id,
            CASE
                 WHEN pva.visit_count_to = 9999 THEN 9999
                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)
                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,
            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
            pur.purchase_no,
            'Inclusive_PP_Guest' colname
  	INTO    #derived_visit_allocation4
  FROM      purchase pur
 INNER JOIN purchase_visit_allocation_link pval
    ON pval.purchase_no                      = pur.purchase_no
 INNER JOIN purchase_visit_allocation_grp pvag
    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
 INNER JOIN purchase_visit_allocation pva
    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id
   AND pva.charge_owner_id                   = 21
   AND pva.visitor_type_id                   = 2
   AND pva.visit_allocation_type_id          &lt;&gt; 3
   AND pur.isdeleted                         = 0
   AND EXISTS (   SELECT 1
                    FROM ##visitsbysource temp2
                   WHERE temp2.purchase_no = pval.purchase_no)
  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,
                            pvah2.purchase_visit_allocation_id
                  FROM      purchase_visit_allocation_his AS pvah2
                 INNER JOIN purchase_visit_allocation pva2
                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id
                 INNER JOIN purchase_visit_allocation_link pval2
                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
                 WHERE      EXISTS (   SELECT 1
                                         FROM ##visitsbysource temp2
                                        WHERE temp2.purchase_no = pval2.purchase_no)
                   AND      pvah2.isdeleted      = 0
                   AND      pva2.visitor_type_id = 2
                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations
    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id
 WHERE      (   (   pva.valid_from &lt;= '2018-07-01' AND pva.valid_to &gt;= '2018-07-01')  OR   pva.visit_validity_type_id = 2);
IF OBJECT_ID('tempdb..#calculated_visit_allocation4') IS NOT NULL
    DROP TABLE #calculated_visit_allocation4;

SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
                         CASE
                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
                              WHEN derived_visit_allocation.visit_count_from = 0 THEN
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
                              ELSE
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END
                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,
      derived_visit_allocation.used_visit_count AS used_visit_number,
       derived_visit_allocation.purchase_no,
       derived_visit_allocation.colname
INTO   #calculated_visit_allocation4
  FROM #derived_visit_allocation4 AS derived_visit_allocation;


UPDATE      t
   SET      t.Inclusive_PP_Guest = ISNULL(c.value, 0)
  FROM      ##visitsbysource t
  LEFT JOIN #calculated_visit_allocation4 c
    ON t.purchase_no = c.purchase_no;


/*5 Client Member/GUEST    --1#visitor type id =3  Member/Guest  ,,,2#  Client 1 Pays  charge_owner_id 22 */
IF OBJECT_ID('tempdb..#derived_visit_allocation5') IS NOT NULL
    DROP TABLE #derived_visit_allocation5;

SELECT      pva.visit_count_from,
            pva.visit_count_to,
            pva.visit_validity_type_id,
            CASE
                 WHEN pva.visit_count_to = 9999 THEN 9999
                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)
                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,
            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
            pur.purchase_no,
            'client_member_guest' colname
  	INTO    #derived_visit_allocation5
  FROM      purchase pur
 INNER JOIN purchase_visit_allocation_link pval
    ON pval.purchase_no                      = pur.purchase_no
 INNER JOIN purchase_visit_allocation_grp pvag
    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
 INNER JOIN purchase_visit_allocation pva
    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id
   AND pva.charge_owner_id                   = 22
   AND pva.visitor_type_id                   = 3
   AND pva.visit_allocation_type_id          &lt;&gt; 3
   AND pur.isdeleted                         = 0
   AND EXISTS (   SELECT 1
                    FROM ##visitsbysource temp2
                   WHERE temp2.purchase_no = pval.purchase_no)
  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,
                            pvah2.purchase_visit_allocation_id
                  FROM      purchase_visit_allocation_his AS pvah2
                 INNER JOIN purchase_visit_allocation pva2
                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id
                 INNER JOIN purchase_visit_allocation_link pval2
                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
                 WHERE      EXISTS (   SELECT 1
                                         FROM ##visitsbysource temp2
                                        WHERE temp2.purchase_no = pval2.purchase_no)
                   AND      pvah2.isdeleted      = 0
                   AND      pva2.visitor_type_id = 3
                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations
    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id
 WHERE      (   (   pva.valid_from &lt;= '2018-07-01' AND pva.valid_to &gt;= '2018-07-01')  OR   pva.visit_validity_type_id = 2);

IF OBJECT_ID('tempdb..#calculated_visit_allocation5') IS NOT NULL
    DROP TABLE #calculated_visit_allocation5;

SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
                         CASE
                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
                              WHEN derived_visit_allocation.visit_count_from = 0 THEN
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
                              ELSE
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END
                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,
      derived_visit_allocation.used_visit_count AS used_visit_number,
       derived_visit_allocation.purchase_no,
       derived_visit_allocation.colname
INTO   #calculated_visit_allocation5
  FROM #derived_visit_allocation5 AS derived_visit_allocation;


UPDATE      t
   SET      t.Client_Member_Guest = ISNULL(c.value, 0)
  FROM      ##visitsbysource t
  LEFT JOIN #calculated_visit_allocation5 c
    ON t.purchase_no = c.purchase_no;

/*6 query for Inclusive PP Member/GUEST  --1#visitor type id =3  Member/Guest  ,,,2#PP Pays charge_owner_id 21 */
IF OBJECT_ID('tempdb..#derived_visit_allocation6') IS NOT NULL
    DROP TABLE #derived_visit_allocation6;

SELECT      pva.visit_count_from,
            pva.visit_count_to,
            pva.visit_validity_type_id,
            CASE
                 WHEN pva.visit_count_to = 9999 THEN 9999
                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)
                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,
            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
            pur.purchase_no,
            'Inclusive_PP_Member_guest' colname
  	INTO    #derived_visit_allocation6
  FROM      purchase pur
 INNER JOIN purchase_visit_allocation_link pval
    ON pval.purchase_no                      = pur.purchase_no
 INNER JOIN purchase_visit_allocation_grp pvag
    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
 INNER JOIN purchase_visit_allocation pva
    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id
   AND pva.charge_owner_id                   = 21
   AND pva.visitor_type_id                   = 3
   AND pva.visit_allocation_type_id          &lt;&gt; 3
   AND pur.isdeleted                         = 0
   AND EXISTS (   SELECT 1
                    FROM ##visitsbysource temp2
                   WHERE temp2.purchase_no = pval.purchase_no)
  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,
                            pvah2.purchase_visit_allocation_id
                  FROM      purchase_visit_allocation_his AS pvah2
                 INNER JOIN purchase_visit_allocation pva2
                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id
                 INNER JOIN purchase_visit_allocation_link pval2
                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
                 WHERE      EXISTS (   SELECT 1
                                         FROM ##visitsbysource temp2
                                        WHERE temp2.purchase_no = pval2.purchase_no)
                   AND      pvah2.isdeleted      = 0
                   AND      pva2.visitor_type_id = 3
                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations
    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id
 WHERE      (   (   pva.valid_from &lt;= '2018-07-01' AND pva.valid_to &gt;= '2018-07-01')  OR   pva.visit_validity_type_id = 2);

IF OBJECT_ID('tempdb..#calculated_visit_allocation6') IS NOT NULL
    DROP TABLE #calculated_visit_allocation6;

SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
                         CASE
                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
                              WHEN derived_visit_allocation.visit_count_from = 0 THEN
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
                              ELSE
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END
                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,
      derived_visit_allocation.used_visit_count AS used_visit_number,
       derived_visit_allocation.purchase_no,
       derived_visit_allocation.colname
INTO   #calculated_visit_allocation6
  FROM #derived_visit_allocation6 AS derived_visit_allocation;


UPDATE      t
   SET      t.Inclusive_PP_Member_Guest = ISNULL(c.value, 0)
  FROM      ##visitsbysource t
  LEFT JOIN #calculated_visit_allocation6 c
    ON t.purchase_no = c.purchase_no;

/*7 query for Complimentary Member/GUEST ----1#visitor type id =3  Member/Guest  ,,,2#  LPAYVISIT	  charge_owner_id 24   */
IF OBJECT_ID('tempdb..#derived_visit_allocation7') IS NOT NULL
    DROP TABLE #derived_visit_allocation7;

SELECT      pva.visit_count_from,
            pva.visit_count_to,
            pva.visit_validity_type_id,
            CASE
                 WHEN pva.visit_count_to = 9999 THEN 9999
                 WHEN pva.visit_count_from = 0 THEN (pva.visit_count_to - pva.visit_count_from)
                 ELSE (pva.visit_count_to - pva.visit_count_from) + 1 END AS allocated_visit_count,
            ISNULL(used_visit_allocations.used_visit_count, 0) AS used_visit_count,
            pur.purchase_no,
            'Complimentary_Member_Guest' colname
INTO        #derived_visit_allocation7
  FROM      purchase pur
 INNER JOIN purchase_visit_allocation_link pval
    ON pval.purchase_no                      = pur.purchase_no
 INNER JOIN purchase_visit_allocation_grp pvag
    ON pvag.purchase_visit_allocation_grp_id = pval.purchase_visit_allocation_grp_id
 INNER JOIN purchase_visit_allocation pva
    ON pva.purchase_visit_allocation_grp_id  = pvag.purchase_visit_allocation_grp_id
   AND pva.charge_owner_id                   = 24
   AND pva.visitor_type_id                   = 3
   AND pva.visit_allocation_type_id          &lt;&gt; 3
   AND pur.isdeleted                         = 0
   AND EXISTS (   SELECT 1
                    FROM ##visitsbysource temp2
                   WHERE temp2.purchase_no = pval.purchase_no)
  LEFT JOIN (   SELECT      COUNT(1) AS used_visit_count,
                            pvah2.purchase_visit_allocation_id
                  FROM      purchase_visit_allocation_his AS pvah2
                 INNER JOIN purchase_visit_allocation pva2
                    ON pvah2.purchase_visit_allocation_id    = pva2.purchase_visit_allocation_id
                 INNER JOIN purchase_visit_allocation_link pval2
                    ON pva2.purchase_visit_allocation_grp_id = pval2.purchase_visit_allocation_grp_id
                 WHERE      EXISTS (   SELECT 1
                                         FROM ##visitsbysource temp2
                                        WHERE temp2.purchase_no = pval2.purchase_no)
                   AND      pvah2.isdeleted      = 0
                   AND      pva2.visitor_type_id = 3
                 GROUP BY pvah2.purchase_visit_allocation_id) AS used_visit_allocations
    ON pva.purchase_visit_allocation_id      = used_visit_allocations.purchase_visit_allocation_id
 WHERE      (   (   pva.valid_from &lt;= '2018-07-01' AND pva.valid_to &gt;= '2018-07-01')  OR   pva.visit_validity_type_id = 2);

IF OBJECT_ID('tempdb..#calculated_visit_allocation7') IS NOT NULL
    DROP TABLE #calculated_visit_allocation7;

SELECT CASE WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
            ELSE CASE  WHEN derived_visit_allocation.visit_validity_type_id = 2 THEN
                         CASE
                              WHEN derived_visit_allocation.visit_count_to = 9999 THEN 9999
                              WHEN derived_visit_allocation.visit_count_from = 0 THEN
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from)
                              ELSE
    (derived_visit_allocation.visit_count_to - derived_visit_allocation.visit_count_from) + 1 END
                     ELSE (derived_visit_allocation.allocated_visit_count - derived_visit_allocation.used_visit_count) END END AS value,
      derived_visit_allocation.used_visit_count AS used_visit_number,
       derived_visit_allocation.purchase_no,
       derived_visit_allocation.colname
INTO   #calculated_visit_allocation7
  FROM #derived_visit_allocation7 AS derived_visit_allocation;


UPDATE      t
   SET      t.Complimentary_Member_Guest = ISNULL(c.value, 0)
  FROM      ##visitsbysource t
  LEFT JOIN #calculated_visit_allocation7 c
    ON t.purchase_no = c.purchase_no;

	SELECT * FROM ##visitsbysource</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Flag Data Load Complete"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{CA412D61-CA2C-45EB-99BA-60D3A75A8252}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Flag Data Load Complete"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{AD9148F2-0821-4BCD-B61C-CEAC1CD3ACC2}"
          SQLTask:SqlStatementSource="EXECUTE [audit_log].[usp_updDataloadWorkflowStepStatus] ?, ?, ?, ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::int_DataloadWorkFlowID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::intRecInsertedCount"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::intRecUpdatedCount"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="User::intRecWithIssueCount"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="4"
            SQLTask:DtsVariableName="User::strLoadCompletion"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Flag Data Load Failed"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E4A63B78-F35F-48C9-8054-44FCD126FA76}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Flag Data Load Failed"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{AD9148F2-0821-4BCD-B61C-CEAC1CD3ACC2}"
          SQLTask:SqlStatementSource="EXECUTE [audit_log].[usp_updDataloadWorkflowStepStatus] ?, Null, Null, Null, 'Failed'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::int_DataloadWorkFlowID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Flag Dataload as Start"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{9ADFA91B-A9BC-4A99-B4A5-D207D90D22BB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Flag Dataload as Start"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{AD9148F2-0821-4BCD-B61C-CEAC1CD3ACC2}"
          SQLTask:SqlStatementSource="EXECUTE [audit_log].[usp_updDataloadWorkflowStepStatus] ?, ?, ?, ?, 'Start'" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::int_DataloadWorkFlowID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::intRecInsertedCount"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::intRecUpdatedCount"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="User::intRecWithIssueCount"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Get the Configuration"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:DelayValidation="True"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{C6C926BC-9D0E-4277-8598-A9F59C3EE6A8}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Get the Configuration"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{AD9148F2-0821-4BCD-B61C-CEAC1CD3ACC2}"
          SQLTask:SqlStatementSource="EXECUTE [audit_log].[usp_getDataloadWorkflowStepConfiguration] ?"
          SQLTask:ResultType="ResultSetType_Rowset" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::rsWorkflowStep_Configuration" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="$Package::int_DataloadWorkFlowID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Sequence Container"
      DTS:CreationName="STOCK:SEQUENCE"
      DTS:Description="Sequence Container"
      DTS:DTSID="{78F50683-A2DD-46EF-9A49-6AD6341F5336}"
      DTS:ExecutableType="STOCK:SEQUENCE"
      DTS:LocaleID="-1"
      DTS:ObjectName="Sequence Container">
      <DTS:Variables />
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package\Sequence Container\Sequence Container"
          DTS:CreationName="STOCK:SEQUENCE"
          DTS:Description="Sequence Container"
          DTS:DTSID="{B0E4FD3D-A991-4FD8-9D82-D10D366CCE0C}"
          DTS:ExecutableType="STOCK:SEQUENCE"
          DTS:LocaleID="-1"
          DTS:ObjectName="Sequence Container">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::Int_EnableWorkflow]&gt;0</DTS:PropertyExpression>
          <DTS:Executables>
            <DTS:Executable
              DTS:refId="Package\Sequence Container\Sequence Container\Archive existing Visits"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Data Flow Task"
              DTS:Disabled="True"
              DTS:DTSID="{B940E7ED-8B72-40A5-8B52-0A79BD48EAD5}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Archive existing Visits"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column"
                      componentClassID="Microsoft.DerivedColumn"
                      contactInfo="Derived Column;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
                      description="Creates new column values by applying expressions to transformation input columns. Create new columns or overwrite existing ones. For example, concatenate the values from the 'first name' and 'last name' column to make a 'full name' column."
                      name="Derived Column"
                      usesDispositions="true">
                      <inputs>
                        <input
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Inputs[Derived Column Input]"
                          description="Input to the Derived Column Transformation"
                          name="Derived Column Input">
                          <externalMetadataColumns />
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output]"
                          description="Default Output of the Derived Column Transformation"
                          exclusionGroup="1"
                          name="Derived Column Output"
                          synchronousInputId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Inputs[Derived Column Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[d_CreatedDate]"
                              dataType="date"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[d_CreatedDate]"
                              name="d_CreatedDate"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">@[System::ContainerStartTime]</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">@[System::ContainerStartTime]</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[d_CreatedBy]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              length="100"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[d_CreatedBy]"
                              name="d_CreatedBy"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">(DT_STR,100,1252)@[System::UserName]</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">(DT_STR,100,1252)@[System::UserName]</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[DataloadWorkFlowID]"
                              dataType="i4"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[DataloadWorkFlowID]"
                              name="DataloadWorkFlowID"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">@[$Package::int_DataloadWorkFlowID]</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">@[$Package::int_DataloadWorkFlowID]</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[DataloadID]"
                              dataType="i4"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[DataloadID]"
                              name="DataloadID"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">@[User::intDataLoadID]</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">@[User::intDataLoadID]</property>
                              </properties>
                            </outputColumn>
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                        <output
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Error Output]"
                          description="Error Output of the Derived Column Transformation"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Derived Column Error Output"
                          synchronousInputId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Inputs[Derived Column Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive"
                      componentClassID="Microsoft.OLEDBDestination"
                      contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="OLE DB Destination"
                      name="Destination tblMCLKLoungeVisits archive"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.String"
                          description="Specifies the name of the database object used to open a rowset."
                          name="OpenRowset">[archive].[tblMCLKLoungeVisits]</property>
                        <property
                          dataType="System.String"
                          description="Specifies the variable that contains the name of the database object used to open a rowset."
                          name="OpenRowsetVariable"></property>
                        <property
                          dataType="System.String"
                          description="The SQL command to be executed."
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the column code page to use when code page information is unavailable from the data source."
                          name="DefaultCodePage">1252</property>
                        <property
                          dataType="System.Boolean"
                          description="Forces the use of the DefaultCodePage property value when describing character data."
                          name="AlwaysUseDefaultCodePage">false</property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the mode used to access the database."
                          name="AccessMode"
                          typeConverter="AccessMode">3</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                          name="FastLoadKeepIdentity">false</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                          name="FastLoadKeepNulls">false</property>
                        <property
                          dataType="System.String"
                          description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                          name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                        <property
                          dataType="System.Int32"
                          description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                          name="FastLoadMaxInsertCommitSize">2147483647</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Connections[OleDbConnection]"
                          connectionManagerID="{51C9D58E-AE67-47D5-B3E1-78381F8A7B44}:invalid"
                          connectionManagerRefId="{51C9D58E-AE67-47D5-B3E1-78381F8A7B44}:invalid"
                          description="The OLE DB runtime connection used to access the database."
                          name="OleDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input]"
                          errorOrTruncationOperation="Insert"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="OLE DB Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[DataloadID]"
                              cachedDataType="i4"
                              cachedName="DataloadID"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[archive_dataload_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[DataloadID]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[d_CreatedDate]"
                              cachedDataType="date"
                              cachedName="d_CreatedDate"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[archive_createddate]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[d_CreatedDate]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[d_CreatedBy]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="100"
                              cachedName="d_CreatedBy"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[archive_createdby]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[d_CreatedBy]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[tbl_index]"
                              cachedDataType="i4"
                              cachedName="tbl_index"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[tbl_index]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[tbl_index]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[subscription_level_desc]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="subscription_level_desc"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[subscription_level_desc]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[subscription_level_desc]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[is_current]"
                              cachedDataType="i4"
                              cachedName="is_current"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[is_current]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[is_current]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[is_deleted]"
                              cachedDataType="i4"
                              cachedName="is_deleted"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[is_deleted]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[is_deleted]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[report_month]"
                              cachedDataType="dbDate"
                              cachedName="report_month"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[report_month]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[report_month]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[process_month]"
                              cachedDataType="wstr"
                              cachedLength="255"
                              cachedName="process_month"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[process_month]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[process_month]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[bin_number]"
                              cachedDataType="i8"
                              cachedName="bin_number"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[bin_number]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[bin_number]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[issuer]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="issuer"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[issuer]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[issuer]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[selected_nonselected]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="selected_nonselected"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[selected_nonselected]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[selected_nonselected]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[issuer_country]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="issuer_country"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[issuer_country]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[issuer_country]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[mc_region]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="mc_region"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[mc_region]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[mc_region]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[ica]"
                              cachedDataType="i4"
                              cachedName="ica"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[ica]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[ica]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[deal_type]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="deal_type"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[deal_type]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[deal_type]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[optional_core]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="optional_core"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[optional_core]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[optional_core]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[po]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="po"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[po]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[po]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[product]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="product"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[product]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[product]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[visit_time]"
                              cachedDataType="wstr"
                              cachedLength="50"
                              cachedName="visit_time"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[visit_time]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[visit_time]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[unique_reference]"
                              cachedDataType="wstr"
                              cachedLength="50"
                              cachedName="unique_reference"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[unique_reference]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[unique_reference]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[source_code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="source_code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[source_code]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[source_code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[member_no]"
                              cachedDataType="i4"
                              cachedName="member_no"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[member_no]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[member_no]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[ccard_no]"
                              cachedDataType="i8"
                              cachedName="ccard_no"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[ccard_no]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[ccard_no]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[title]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="15"
                              cachedName="title"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[title]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[title]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[first_name]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="first_name"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[first_name]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[first_name]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[last_name]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="last_name"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[last_name]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[last_name]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[membership_plan]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="membership_plan"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[membership_plan]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[membership_plan]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[member_status]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="20"
                              cachedName="member_status"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[member_status]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[member_status]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[paid_to_date]"
                              cachedDataType="dbDate"
                              cachedName="paid_to_date"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[paid_to_date]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[paid_to_date]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[visit_date]"
                              cachedDataType="dbDate"
                              cachedName="visit_date"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[visit_date]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[visit_date]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[date_processed]"
                              cachedDataType="dbDate"
                              cachedName="date_processed"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[date_processed]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[date_processed]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[guestvisits]"
                              cachedDataType="i4"
                              cachedName="guestvisits"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[guestvisits]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[guestvisits]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[batch_no]"
                              cachedDataType="i4"
                              cachedName="batch_no"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[batch_no]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[batch_no]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[reference]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="50"
                              cachedName="reference"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[reference]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[reference]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[lounge_code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="20"
                              cachedName="lounge_code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[lounge_code]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge_code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[lounge]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="lounge"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[lounge]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[airport]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="airport"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[airport]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[airport]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[city]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="100"
                              cachedName="city"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[city]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[city]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[country]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="40"
                              cachedName="country"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[country]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[country]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_pays_member_visit]"
                              cachedDataType="i4"
                              cachedName="client_pays_member_visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_pays_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_pays_member_visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[inclusive_pp_member_visit]"
                              cachedDataType="i4"
                              cachedName="inclusive_pp_member_visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member_visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[complimentary_member_visit]"
                              cachedDataType="i4"
                              cachedName="complimentary_member_visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_member_visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[cardholder_pays_member_visit]"
                              cachedDataType="i4"
                              cachedName="cardholder_pays_member_visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_pays_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_pays_member_visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_pays_guest_visit]"
                              cachedDataType="i4"
                              cachedName="client_pays_guest_visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_pays_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_pays_guest_visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[inclusive_pp_guest_visit]"
                              cachedDataType="i4"
                              cachedName="inclusive_pp_guest_visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_guest_visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[complimentary_guest_visit]"
                              cachedDataType="i4"
                              cachedName="complimentary_guest_visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_guest_visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[cardholder_pays_guest_visit]"
                              cachedDataType="i4"
                              cachedName="cardholder_pays_guest_visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_pays_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_pays_guest_visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[lounge_visit_offer]"
                              cachedDataType="i4"
                              cachedName="lounge_visit_offer"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[lounge_visit_offer]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge_visit_offer]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_member]"
                              cachedDataType="i4"
                              cachedName="client_member"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[inclusive_pp_member]"
                              cachedDataType="i4"
                              cachedName="inclusive_pp_member"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_guest]"
                              cachedDataType="i4"
                              cachedName="client_guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[inclusive_pp_guest]"
                              cachedDataType="i4"
                              cachedName="inclusive_pp_guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_member_guest]"
                              cachedDataType="i4"
                              cachedName="client_member_guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_member_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[inclusive_pp_member_guest]"
                              cachedDataType="i4"
                              cachedName="inclusive_pp_member_guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[complimentary_member_guest]"
                              cachedDataType="i4"
                              cachedName="complimentary_member_guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_member_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_visit_currency_member]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="5"
                              cachedName="client_visit_currency_member"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_currency_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_currency_member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_visit_amount_member]"
                              cachedDataType="numeric"
                              cachedName="client_visit_amount_member"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_amount_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_amount_member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_visit_currency_guest]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="5"
                              cachedName="client_visit_currency_guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_currency_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_currency_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[client_visit_amount_guest]"
                              cachedDataType="numeric"
                              cachedName="client_visit_amount_guest"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_amount_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_amount_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[total_client_amount_currency]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="5"
                              cachedName="total_client_amount_currency"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[total_client_amount_currency]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_client_amount_currency]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[total_client_amount]"
                              cachedDataType="numeric"
                              cachedName="total_client_amount"
                              cachedPrecision="11"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[total_client_amount]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_client_amount]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[cardholder_visit_currency_member]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="5"
                              cachedName="cardholder_visit_currency_member"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_currency_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_currency_member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[cardholder_visit_amount_member]"
                              cachedDataType="numeric"
                              cachedName="cardholder_visit_amount_member"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_amount_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_amount_member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[cardholder_visit_currency_guest]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="5"
                              cachedName="cardholder_visit_currency_guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_currency_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_currency_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[cardholder_visit_amount_guest]"
                              cachedDataType="numeric"
                              cachedName="cardholder_visit_amount_guest"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_amount_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_amount_guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[total_cardholder_amount_currency]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="5"
                              cachedName="total_cardholder_amount_currency"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[total_cardholder_amount_currency]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_cardholder_amount_currency]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[total_cardholder_amount]"
                              cachedDataType="numeric"
                              cachedName="total_cardholder_amount"
                              cachedPrecision="11"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[total_cardholder_amount]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_cardholder_amount]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[cost_centre]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="cost_centre"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cost_centre]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cost_centre]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[campaign_code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="campaign_code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[campaign_code]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[campaign_code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[vendor_code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="vendor_code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[vendor_code]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[vendor_code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[user_invitation_code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="user_invitation_code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[user_invitation_code]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[user_invitation_code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[domestic_int_lounge]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="40"
                              cachedName="domestic_int_lounge"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[domestic_int_lounge]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[domestic_int_lounge]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[src_ref_id]"
                              cachedDataType="i4"
                              cachedName="src_ref_id"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[src_ref_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[src_ref_id]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[po_ref_id]"
                              cachedDataType="i4"
                              cachedName="po_ref_id"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[po_ref_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[po_ref_id]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[dataload_id]"
                              cachedDataType="i4"
                              cachedName="dataload_id"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[initial_dataload_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[dataload_id]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[createddate]"
                              cachedDataType="dbDate"
                              cachedName="createddate"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[initial_createddate]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[createddate]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[DataloadWorkFlowID]"
                              cachedDataType="i4"
                              cachedName="DataloadWorkFlowID"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[archive_dataload_workflow_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output].Columns[DataloadWorkFlowID]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[dataload_workflow_id]"
                              cachedDataType="i4"
                              cachedName="dataload_workflow_id"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[initial_dataload_workflow_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[dataload_workflow_id]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].Columns[createdby]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="createdby"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[initial_createdby]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[createdby]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[tbl_index]"
                              dataType="i4"
                              name="tbl_index" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[subscription_level_desc]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="subscription_level_desc" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[is_current]"
                              dataType="i4"
                              name="is_current" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[is_deleted]"
                              dataType="i4"
                              name="is_deleted" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[archive_dataload_workflow_id]"
                              dataType="i4"
                              name="archive_dataload_workflow_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[report_month]"
                              dataType="dbDate"
                              name="report_month" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[process_month]"
                              dataType="wstr"
                              length="255"
                              name="process_month" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[bin_number]"
                              dataType="i8"
                              name="bin_number" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[issuer]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="issuer" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[selected_nonselected]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="selected_nonselected" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[issuer_country]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="issuer_country" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[mc_region]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="mc_region" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[ica]"
                              dataType="i4"
                              name="ica" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[deal_type]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="deal_type" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[optional_core]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="optional_core" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[po]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="po" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[product]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="product" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[visit_time]"
                              dataType="wstr"
                              length="50"
                              name="visit_time" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[unique_reference]"
                              dataType="wstr"
                              length="50"
                              name="unique_reference" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[source_code]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="source_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[member_no]"
                              dataType="i4"
                              name="member_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[ccard_no]"
                              dataType="i4"
                              name="ccard_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[title]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              name="title" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[first_name]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="first_name" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[last_name]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="last_name" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[membership_plan]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="membership_plan" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[member_status]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              name="member_status" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[paid_to_date]"
                              dataType="dbDate"
                              name="paid_to_date" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[visit_date]"
                              dataType="dbDate"
                              name="visit_date" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[date_processed]"
                              dataType="dbDate"
                              name="date_processed" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[guestvisits]"
                              dataType="i4"
                              name="guestvisits" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[batch_no]"
                              dataType="i4"
                              name="batch_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[reference]"
                              codePage="1252"
                              dataType="str"
                              length="50"
                              name="reference" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[lounge_code]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              name="lounge_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[lounge]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="lounge" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[airport]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="airport" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[city]"
                              codePage="1252"
                              dataType="str"
                              length="100"
                              name="city" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[country]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              name="country" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_pays_member_visit]"
                              dataType="i4"
                              name="client_pays_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member_visit]"
                              dataType="i4"
                              name="inclusive_pp_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_member_visit]"
                              dataType="i4"
                              name="complimentary_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_pays_member_visit]"
                              dataType="i4"
                              name="cardholder_pays_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_pays_guest_visit]"
                              dataType="i4"
                              name="client_pays_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_guest_visit]"
                              dataType="i4"
                              name="inclusive_pp_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_guest_visit]"
                              dataType="i4"
                              name="complimentary_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_pays_guest_visit]"
                              dataType="i4"
                              name="cardholder_pays_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[lounge_visit_offer]"
                              dataType="i4"
                              name="lounge_visit_offer" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_member]"
                              dataType="i4"
                              name="client_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member]"
                              dataType="i4"
                              name="inclusive_pp_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_guest]"
                              dataType="i4"
                              name="client_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_guest]"
                              dataType="i4"
                              name="inclusive_pp_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_member_guest]"
                              dataType="i4"
                              name="client_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member_guest]"
                              dataType="i4"
                              name="inclusive_pp_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_member_guest]"
                              dataType="i4"
                              name="complimentary_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="client_visit_currency_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_amount_member]"
                              dataType="numeric"
                              name="client_visit_amount_member"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="client_visit_currency_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_amount_guest]"
                              dataType="numeric"
                              name="client_visit_amount_guest"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[total_client_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="total_client_amount_currency" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[total_client_amount]"
                              dataType="numeric"
                              name="total_client_amount"
                              precision="11"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="cardholder_visit_currency_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_amount_member]"
                              dataType="numeric"
                              name="cardholder_visit_amount_member"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="cardholder_visit_currency_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_amount_guest]"
                              dataType="numeric"
                              name="cardholder_visit_amount_guest"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[total_cardholder_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="total_cardholder_amount_currency" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[total_cardholder_amount]"
                              dataType="numeric"
                              name="total_cardholder_amount"
                              precision="11"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[cost_centre]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="cost_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[campaign_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="campaign_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[vendor_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="vendor_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[user_invitation_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="user_invitation_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[domestic_int_lounge]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              name="domestic_int_lounge" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[initial_dataload_workflow_id]"
                              dataType="i4"
                              name="initial_dataload_workflow_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[initial_dataload_id]"
                              dataType="i4"
                              name="initial_dataload_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[initial_createddate]"
                              dataType="dbDate"
                              name="initial_createddate" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[initial_createdby]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="initial_createdby" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[archive_dataload_id]"
                              dataType="i4"
                              name="archive_dataload_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[archive_createddate]"
                              dataType="dbDate"
                              name="archive_createddate" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[archive_createdby]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="archive_createdby" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[src_ref_id]"
                              dataType="i4"
                              name="src_ref_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input].ExternalColumns[po_ref_id]"
                              dataType="i4"
                              name="po_ref_id" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Outputs[OLE DB Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="OLE DB Destination Error Output"
                          synchronousInputId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Row Count"
                      componentClassID="Microsoft.RowCount"
                      contactInfo="Row Count;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
                      description="Counts rows as they pass through a data flow. For example, use the number of rows processed to determine whether or not to perform cleanup operations, or update text in an e-mail message to communicate processing status."
                      name="Row Count">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the variable to hold the row count."
                          name="VariableName">User::intRecWithIssueCount</property>
                      </properties>
                      <inputs>
                        <input
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Row Count.Inputs[Row Count Input 1]"
                          hasSideEffects="true"
                          name="Row Count Input 1">
                          <externalMetadataColumns />
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Row Count.Outputs[Row Count Output 1]"
                          name="Row Count Output 1"
                          synchronousInputId="Package\Sequence Container\Sequence Container\Archive existing Visits\Row Count.Inputs[Row Count Input 1]">
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits"
                      componentClassID="Microsoft.OLEDBSource"
                      contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
                      description="OLE DB Source"
                      name="Source tblMCLKLoungeVisits"
                      usesDispositions="true"
                      version="7">
                      <properties>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.String"
                          description="Specifies the name of the database object used to open a rowset."
                          name="OpenRowset">[dbo].[stg_mc_lk_mastersheet]</property>
                        <property
                          dataType="System.String"
                          description="Specifies the variable that contains the name of the database object used to open a rowset."
                          name="OpenRowsetVariable"></property>
                        <property
                          dataType="System.String"
                          description="The SQL command to be executed."
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">SELECT * FROM [Rprt].[tblMCLKLoungeVisits]
WHERE  Report_month=?</property>
                        <property
                          dataType="System.String"
                          description="The variable that contains the SQL command to be executed."
                          name="SqlCommandVariable"></property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the column code page to use when code page information is unavailable from the data source."
                          name="DefaultCodePage">1252</property>
                        <property
                          dataType="System.Boolean"
                          description="Forces the use of the DefaultCodePage property value when describing character data."
                          name="AlwaysUseDefaultCodePage">false</property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the mode used to access the database."
                          name="AccessMode"
                          typeConverter="AccessMode">2</property>
                        <property
                          dataType="System.String"
                          description="The mappings between the parameters in the SQL command and variables."
                          name="ParameterMapping">"0:Input",{99575F65-B9EC-462B-A955-0B1AB4E0A04A};</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Connections[OleDbConnection]"
                          connectionManagerID="{51C9D58E-AE67-47D5-B3E1-78381F8A7B44}:invalid"
                          connectionManagerRefId="{51C9D58E-AE67-47D5-B3E1-78381F8A7B44}:invalid"
                          description="The OLE DB runtime connection used to access the database."
                          name="OleDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output]"
                          name="OLE DB Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[tbl_index]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[tbl_index]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[tbl_index]"
                              name="tbl_index"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[subscription_level_desc]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[subscription_level_desc]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[subscription_level_desc]"
                              name="subscription_level_desc"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[is_current]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[is_current]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[is_current]"
                              name="is_current"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[is_deleted]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[is_deleted]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[is_deleted]"
                              name="is_deleted"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[dataload_workflow_id]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[dataload_workflow_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[dataload_workflow_id]"
                              name="dataload_workflow_id"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[report_month]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[report_month]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[report_month]"
                              name="report_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[process_month]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[process_month]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[process_month]"
                              name="process_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[bin_number]"
                              dataType="i8"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[bin_number]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[bin_number]"
                              name="bin_number"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[issuer]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[issuer]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[issuer]"
                              name="issuer"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[selected_nonselected]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[selected_nonselected]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[selected_nonselected]"
                              name="selected_nonselected"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[issuer_country]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[issuer_country]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[issuer_country]"
                              name="issuer_country"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[mc_region]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[mc_region]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[mc_region]"
                              name="mc_region"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[ica]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[ica]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[ica]"
                              name="ica"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[deal_type]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[deal_type]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[deal_type]"
                              name="deal_type"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[optional_core]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[optional_core]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[optional_core]"
                              name="optional_core"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[po]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[po]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[po]"
                              name="po"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[product]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[product]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[product]"
                              name="product"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[visit_time]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[visit_time]"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[visit_time]"
                              name="visit_time"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[unique_reference]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[unique_reference]"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[unique_reference]"
                              name="unique_reference"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[source_code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[source_code]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[source_code]"
                              name="source_code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[member_no]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[member_no]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[member_no]"
                              name="member_no"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[ccard_no]"
                              dataType="i8"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[ccard_no]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[ccard_no]"
                              name="ccard_no"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[title]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[title]"
                              length="15"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[title]"
                              name="title"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[first_name]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[first_name]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[first_name]"
                              name="first_name"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[last_name]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[last_name]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[last_name]"
                              name="last_name"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[membership_plan]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[membership_plan]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[membership_plan]"
                              name="membership_plan"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[member_status]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[member_status]"
                              length="20"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[member_status]"
                              name="member_status"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[paid_to_date]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[paid_to_date]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[paid_to_date]"
                              name="paid_to_date"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[visit_date]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[visit_date]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[visit_date]"
                              name="visit_date"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[date_processed]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[date_processed]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[date_processed]"
                              name="date_processed"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[guestvisits]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[guestvisits]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[guestvisits]"
                              name="guestvisits"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[batch_no]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[batch_no]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[batch_no]"
                              name="batch_no"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[reference]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[reference]"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[reference]"
                              name="reference"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge_code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[lounge_code]"
                              length="20"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge_code]"
                              name="lounge_code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[lounge]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge]"
                              name="lounge"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[airport]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[airport]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[airport]"
                              name="airport"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[city]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[city]"
                              length="100"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[city]"
                              name="city"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[country]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[country]"
                              length="40"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[country]"
                              name="country"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_pays_member_visit]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_pays_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_pays_member_visit]"
                              name="client_pays_member_visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member_visit]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member_visit]"
                              name="inclusive_pp_member_visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_member_visit]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[complimentary_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_member_visit]"
                              name="complimentary_member_visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_pays_member_visit]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_pays_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_pays_member_visit]"
                              name="cardholder_pays_member_visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_pays_guest_visit]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_pays_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_pays_guest_visit]"
                              name="client_pays_guest_visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_guest_visit]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_guest_visit]"
                              name="inclusive_pp_guest_visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_guest_visit]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[complimentary_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_guest_visit]"
                              name="complimentary_guest_visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_pays_guest_visit]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_pays_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_pays_guest_visit]"
                              name="cardholder_pays_guest_visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge_visit_offer]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[lounge_visit_offer]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[lounge_visit_offer]"
                              name="lounge_visit_offer"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_member]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_member]"
                              name="client_member"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member]"
                              name="inclusive_pp_member"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_guest]"
                              name="client_guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_guest]"
                              name="inclusive_pp_guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_member_guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_member_guest]"
                              name="client_member_guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member_guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[inclusive_pp_member_guest]"
                              name="inclusive_pp_member_guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_member_guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[complimentary_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[complimentary_member_guest]"
                              name="complimentary_member_guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_visit_currency_member]"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_currency_member]"
                              name="client_visit_currency_member"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_amount_member]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_visit_amount_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_amount_member]"
                              name="client_visit_amount_member"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_visit_currency_guest]"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_currency_guest]"
                              name="client_visit_currency_guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_amount_guest]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_visit_amount_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[client_visit_amount_guest]"
                              name="client_visit_amount_guest"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_client_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[total_client_amount_currency]"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_client_amount_currency]"
                              name="total_client_amount_currency"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_client_amount]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[total_client_amount]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_client_amount]"
                              name="total_client_amount"
                              precision="11"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_visit_currency_member]"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_currency_member]"
                              name="cardholder_visit_currency_member"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_amount_member]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_visit_amount_member]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_amount_member]"
                              name="cardholder_visit_amount_member"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_visit_currency_guest]"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_currency_guest]"
                              name="cardholder_visit_currency_guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_amount_guest]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_visit_amount_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cardholder_visit_amount_guest]"
                              name="cardholder_visit_amount_guest"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_cardholder_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[total_cardholder_amount_currency]"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_cardholder_amount_currency]"
                              name="total_cardholder_amount_currency"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_cardholder_amount]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[total_cardholder_amount]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[total_cardholder_amount]"
                              name="total_cardholder_amount"
                              precision="11"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cost_centre]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cost_centre]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[cost_centre]"
                              name="cost_centre"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[campaign_code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[campaign_code]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[campaign_code]"
                              name="campaign_code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[vendor_code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[vendor_code]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[vendor_code]"
                              name="vendor_code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[user_invitation_code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[user_invitation_code]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[user_invitation_code]"
                              name="user_invitation_code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[domestic_int_lounge]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[domestic_int_lounge]"
                              length="40"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[domestic_int_lounge]"
                              name="domestic_int_lounge"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[createddate]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[createddate]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[createddate]"
                              name="createddate"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[createdby]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[createdby]"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[createdby]"
                              name="createdby"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[dataload_id]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[dataload_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[dataload_id]"
                              name="dataload_id"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[src_ref_id]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[src_ref_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[src_ref_id]"
                              name="src_ref_id"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[po_ref_id]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[po_ref_id]"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].Columns[po_ref_id]"
                              name="po_ref_id"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[tbl_index]"
                              dataType="i4"
                              name="tbl_index" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[subscription_level_desc]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="subscription_level_desc" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[is_current]"
                              dataType="i4"
                              name="is_current" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[is_deleted]"
                              dataType="i4"
                              name="is_deleted" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[dataload_workflow_id]"
                              dataType="i4"
                              name="dataload_workflow_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[report_month]"
                              dataType="dbDate"
                              name="report_month" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[process_month]"
                              dataType="wstr"
                              length="255"
                              name="process_month" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[bin_number]"
                              dataType="i8"
                              name="bin_number" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[issuer]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="issuer" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[selected_nonselected]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="selected_nonselected" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[issuer_country]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="issuer_country" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[mc_region]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="mc_region" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[ica]"
                              dataType="i4"
                              name="ica" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[deal_type]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="deal_type" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[optional_core]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="optional_core" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[po]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="po" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[product]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="product" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[visit_time]"
                              dataType="wstr"
                              length="50"
                              name="visit_time" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[unique_reference]"
                              dataType="wstr"
                              length="50"
                              name="unique_reference" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[source_code]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="source_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[member_no]"
                              dataType="i4"
                              name="member_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[ccard_no]"
                              dataType="i8"
                              name="ccard_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[title]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              name="title" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[first_name]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="first_name" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[last_name]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="last_name" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[membership_plan]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="membership_plan" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[member_status]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              name="member_status" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[paid_to_date]"
                              dataType="dbDate"
                              name="paid_to_date" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[visit_date]"
                              dataType="dbDate"
                              name="visit_date" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[date_processed]"
                              dataType="dbDate"
                              name="date_processed" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[guestvisits]"
                              dataType="i4"
                              name="guestvisits" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[batch_no]"
                              dataType="i4"
                              name="batch_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[reference]"
                              codePage="1252"
                              dataType="str"
                              length="50"
                              name="reference" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[lounge_code]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              name="lounge_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[lounge]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="lounge" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[airport]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="airport" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[city]"
                              codePage="1252"
                              dataType="str"
                              length="100"
                              name="city" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[country]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              name="country" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_pays_member_visit]"
                              dataType="i4"
                              name="client_pays_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_member_visit]"
                              dataType="i4"
                              name="inclusive_pp_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[complimentary_member_visit]"
                              dataType="i4"
                              name="complimentary_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_pays_member_visit]"
                              dataType="i4"
                              name="cardholder_pays_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_pays_guest_visit]"
                              dataType="i4"
                              name="client_pays_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_guest_visit]"
                              dataType="i4"
                              name="inclusive_pp_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[complimentary_guest_visit]"
                              dataType="i4"
                              name="complimentary_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_pays_guest_visit]"
                              dataType="i4"
                              name="cardholder_pays_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[lounge_visit_offer]"
                              dataType="i4"
                              name="lounge_visit_offer" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_member]"
                              dataType="i4"
                              name="client_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_member]"
                              dataType="i4"
                              name="inclusive_pp_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_guest]"
                              dataType="i4"
                              name="client_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_guest]"
                              dataType="i4"
                              name="inclusive_pp_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_member_guest]"
                              dataType="i4"
                              name="client_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[inclusive_pp_member_guest]"
                              dataType="i4"
                              name="inclusive_pp_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[complimentary_member_guest]"
                              dataType="i4"
                              name="complimentary_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="client_visit_currency_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_visit_amount_member]"
                              dataType="numeric"
                              name="client_visit_amount_member"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="client_visit_currency_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[client_visit_amount_guest]"
                              dataType="numeric"
                              name="client_visit_amount_guest"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[total_client_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="total_client_amount_currency" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[total_client_amount]"
                              dataType="numeric"
                              name="total_client_amount"
                              precision="11"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="cardholder_visit_currency_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_visit_amount_member]"
                              dataType="numeric"
                              name="cardholder_visit_amount_member"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="cardholder_visit_currency_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cardholder_visit_amount_guest]"
                              dataType="numeric"
                              name="cardholder_visit_amount_guest"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[total_cardholder_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="total_cardholder_amount_currency" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[total_cardholder_amount]"
                              dataType="numeric"
                              name="total_cardholder_amount"
                              precision="11"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[cost_centre]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="cost_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[campaign_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="campaign_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[vendor_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="vendor_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[user_invitation_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="user_invitation_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[domestic_int_lounge]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              name="domestic_int_lounge" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[createddate]"
                              dataType="dbDate"
                              name="createddate" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[createdby]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="createdby" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[dataload_id]"
                              dataType="i4"
                              name="dataload_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[src_ref_id]"
                              dataType="i4"
                              name="src_ref_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output].ExternalColumns[po_ref_id]"
                              dataType="i4"
                              name="po_ref_id" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output]"
                          isErrorOut="true"
                          name="OLE DB Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[tbl_index]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[tbl_index]"
                              name="tbl_index" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[subscription_level_desc]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[subscription_level_desc]"
                              name="subscription_level_desc" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[is_current]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[is_current]"
                              name="is_current" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[is_deleted]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[is_deleted]"
                              name="is_deleted" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[dataload_workflow_id]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[dataload_workflow_id]"
                              name="dataload_workflow_id" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[report_month]"
                              dataType="dbDate"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[report_month]"
                              name="report_month" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[process_month]"
                              dataType="wstr"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[process_month]"
                              name="process_month" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[bin_number]"
                              dataType="i8"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[bin_number]"
                              name="bin_number" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[issuer]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[issuer]"
                              name="issuer" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[selected_nonselected]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[selected_nonselected]"
                              name="selected_nonselected" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[issuer_country]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[issuer_country]"
                              name="issuer_country" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[mc_region]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[mc_region]"
                              name="mc_region" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[ica]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[ica]"
                              name="ica" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[deal_type]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[deal_type]"
                              name="deal_type" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[optional_core]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[optional_core]"
                              name="optional_core" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[po]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[po]"
                              name="po" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[product]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[product]"
                              name="product" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[visit_time]"
                              dataType="wstr"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[visit_time]"
                              name="visit_time" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[unique_reference]"
                              dataType="wstr"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[unique_reference]"
                              name="unique_reference" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[source_code]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[source_code]"
                              name="source_code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[member_no]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[member_no]"
                              name="member_no" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[ccard_no]"
                              dataType="i8"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[ccard_no]"
                              name="ccard_no" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[title]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[title]"
                              name="title" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[first_name]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[first_name]"
                              name="first_name" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[last_name]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[last_name]"
                              name="last_name" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[membership_plan]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[membership_plan]"
                              name="membership_plan" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[member_status]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[member_status]"
                              name="member_status" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[paid_to_date]"
                              dataType="dbDate"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[paid_to_date]"
                              name="paid_to_date" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[visit_date]"
                              dataType="dbDate"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[visit_date]"
                              name="visit_date" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[date_processed]"
                              dataType="dbDate"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[date_processed]"
                              name="date_processed" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[guestvisits]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[guestvisits]"
                              name="guestvisits" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[batch_no]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[batch_no]"
                              name="batch_no" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[reference]"
                              codePage="1252"
                              dataType="str"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[reference]"
                              name="reference" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[lounge_code]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[lounge_code]"
                              name="lounge_code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[lounge]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[lounge]"
                              name="lounge" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[airport]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[airport]"
                              name="airport" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[city]"
                              codePage="1252"
                              dataType="str"
                              length="100"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[city]"
                              name="city" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[country]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[country]"
                              name="country" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_pays_member_visit]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_pays_member_visit]"
                              name="client_pays_member_visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_member_visit]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_member_visit]"
                              name="inclusive_pp_member_visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[complimentary_member_visit]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[complimentary_member_visit]"
                              name="complimentary_member_visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_pays_member_visit]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_pays_member_visit]"
                              name="cardholder_pays_member_visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_pays_guest_visit]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_pays_guest_visit]"
                              name="client_pays_guest_visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_guest_visit]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_guest_visit]"
                              name="inclusive_pp_guest_visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[complimentary_guest_visit]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[complimentary_guest_visit]"
                              name="complimentary_guest_visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_pays_guest_visit]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_pays_guest_visit]"
                              name="cardholder_pays_guest_visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[lounge_visit_offer]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[lounge_visit_offer]"
                              name="lounge_visit_offer" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_member]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_member]"
                              name="client_member" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_member]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_member]"
                              name="inclusive_pp_member" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_guest]"
                              name="client_guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_guest]"
                              name="inclusive_pp_guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_member_guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_member_guest]"
                              name="client_member_guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_member_guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[inclusive_pp_member_guest]"
                              name="inclusive_pp_member_guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[complimentary_member_guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[complimentary_member_guest]"
                              name="complimentary_member_guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_visit_currency_member]"
                              name="client_visit_currency_member" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_visit_amount_member]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_visit_amount_member]"
                              name="client_visit_amount_member"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_visit_currency_guest]"
                              name="client_visit_currency_guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_visit_amount_guest]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[client_visit_amount_guest]"
                              name="client_visit_amount_guest"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[total_client_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[total_client_amount_currency]"
                              name="total_client_amount_currency" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[total_client_amount]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[total_client_amount]"
                              name="total_client_amount"
                              precision="11"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_visit_currency_member]"
                              name="cardholder_visit_currency_member" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_visit_amount_member]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_visit_amount_member]"
                              name="cardholder_visit_amount_member"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_visit_currency_guest]"
                              name="cardholder_visit_currency_guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_visit_amount_guest]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cardholder_visit_amount_guest]"
                              name="cardholder_visit_amount_guest"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[total_cardholder_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[total_cardholder_amount_currency]"
                              name="total_cardholder_amount_currency" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[total_cardholder_amount]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[total_cardholder_amount]"
                              name="total_cardholder_amount"
                              precision="11"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cost_centre]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[cost_centre]"
                              name="cost_centre" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[campaign_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[campaign_code]"
                              name="campaign_code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[vendor_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[vendor_code]"
                              name="vendor_code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[user_invitation_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[user_invitation_code]"
                              name="user_invitation_code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[domestic_int_lounge]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[domestic_int_lounge]"
                              name="domestic_int_lounge" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[createddate]"
                              dataType="dbDate"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[createddate]"
                              name="createddate" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[createdby]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[createdby]"
                              name="createdby" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[dataload_id]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[dataload_id]"
                              name="dataload_id" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[src_ref_id]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[src_ref_id]"
                              name="src_ref_id" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[po_ref_id]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Error Output].Columns[po_ref_id]"
                              name="po_ref_id" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Sequence Container\Sequence Container\Archive existing Visits.Paths[Derived Column Output]"
                      endId="Package\Sequence Container\Sequence Container\Archive existing Visits\Row Count.Inputs[Row Count Input 1]"
                      name="Derived Column Output"
                      startId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Outputs[Derived Column Output]" />
                    <path
                      refId="Package\Sequence Container\Sequence Container\Archive existing Visits.Paths[OLE DB Source Output]"
                      endId="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column.Inputs[Derived Column Input]"
                      name="OLE DB Source Output"
                      startId="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits.Outputs[OLE DB Source Output]" />
                    <path
                      refId="Package\Sequence Container\Sequence Container\Archive existing Visits.Paths[Row Count Output 1]"
                      endId="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive.Inputs[OLE DB Destination Input]"
                      name="Row Count Output 1"
                      startId="Package\Sequence Container\Sequence Container\Archive existing Visits\Row Count.Outputs[Row Count Output 1]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container\Sequence Container\Delete tblDBWSLoungeVisits"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{BCCB34BF-E717-486C-935D-544B380419F5}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Delete tblDBWSLoungeVisits"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{7E223649-2142-4D1E-B44E-5D4EF88BC859}"
                  SQLTask:SqlStatementSource="DELETE FROM rprt.tblDBWSLoungeVisits WHERE report_month=?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="User::dtStartDate"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="7"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container\Sequence Container\Get Current Reporting Month"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{04C334B7-5336-4CA2-A67E-DA2F4E38B62D}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Get Current Reporting Month"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{FA9B9F91-82BB-4568-B60B-E116A5532FCB}"
                  SQLTask:SqlStatementSource="Execute [dbo].[usp_ReportMonth_Sel_ByClient]  ?, ? , ? output  , ? output  , ? output" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="2"
                    SQLTask:DtsVariableName="User::dtStartDate"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="135"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="3"
                    SQLTask:DtsVariableName="User::dtEndDate"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="135"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="4"
                    SQLTask:DtsVariableName="User::dtReportMonth"
                    SQLTask:ParameterDirection="Output"
                    SQLTask:DataType="135"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="0"
                    SQLTask:DtsVariableName="User::strClientName"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="129"
                    SQLTask:ParameterSize="-1" />
                  <SQLTask:ParameterBinding
                    SQLTask:ParameterName="1"
                    SQLTask:DtsVariableName="$Package::int_DataloadWorkFlowID"
                    SQLTask:ParameterDirection="Input"
                    SQLTask:DataType="3"
                    SQLTask:ParameterSize="-1" />
                </SQLTask:SqlTaskData>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container\Sequence Container\Populate dbwsvisitsbysource"
              DTS:CreationName="Microsoft.ExecuteSQLTask"
              DTS:Description="Execute SQL Task"
              DTS:DTSID="{FCAE54A7-75A8-40C7-A210-7365658ADBC9}"
              DTS:ExecutableType="Microsoft.ExecuteSQLTask"
              DTS:LocaleID="-1"
              DTS:ObjectName="Populate dbwsvisitsbysource"
              DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
              DTS:ThreadHint="0">
              <DTS:Variables />
              <DTS:ObjectData>
                <SQLTask:SqlTaskData
                  SQLTask:Connection="{36CE4184-F162-41D7-BC4F-227B15E1C904}"
                  SQLTask:SqlStmtSourceType="Variable"
                  SQLTask:SqlStatementSource="User::strPPDB_Source_Query" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:DelayValidation="True"
              DTS:Description="Data Flow Task"
              DTS:DTSID="{A2BC8B19-92F0-43C4-B08F-8377BBBF6528}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="PPDB DBWS_Visits"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits"
                      componentClassID="Microsoft.OLEDBDestination"
                      contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
                      description="OLE DB Destination"
                      name="Destination tblDBWSLoungeVisits"
                      usesDispositions="true"
                      version="4">
                      <properties>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.String"
                          description="Specifies the name of the database object used to open a rowset."
                          name="OpenRowset">[rprt].[tblDBWSLoungeVisits]</property>
                        <property
                          dataType="System.String"
                          description="Specifies the variable that contains the name of the database object used to open a rowset."
                          name="OpenRowsetVariable"></property>
                        <property
                          dataType="System.String"
                          description="The SQL command to be executed."
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"></property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the column code page to use when code page information is unavailable from the data source."
                          name="DefaultCodePage">1252</property>
                        <property
                          dataType="System.Boolean"
                          description="Forces the use of the DefaultCodePage property value when describing character data."
                          name="AlwaysUseDefaultCodePage">false</property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the mode used to access the database."
                          name="AccessMode"
                          typeConverter="AccessMode">3</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                          name="FastLoadKeepIdentity">false</property>
                        <property
                          dataType="System.Boolean"
                          description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                          name="FastLoadKeepNulls">false</property>
                        <property
                          dataType="System.String"
                          description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                          name="FastLoadOptions">TABLOCK</property>
                        <property
                          dataType="System.Int32"
                          description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                          name="FastLoadMaxInsertCommitSize">2147483647</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Connections[OleDbConnection]"
                          connectionManagerID="{7E223649-2142-4D1E-B44E-5D4EF88BC859}:external"
                          connectionManagerRefId="Project.ConnectionManagers[BI02]"
                          description="The OLE DB runtime connection used to access the database."
                          name="OleDbConnection" />
                      </connections>
                      <inputs>
                        <input
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input]"
                          errorOrTruncationOperation="Insert"
                          errorRowDisposition="FailComponent"
                          hasSideEffects="true"
                          name="OLE DB Destination Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[DataLoadWorkFlowID]"
                              cachedDataType="i4"
                              cachedName="DataLoadWorkFlowID"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[dataload_workflow_id]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DataLoadWorkFlowID]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[DV_CreatedDate]"
                              cachedDataType="date"
                              cachedName="DV_CreatedDate"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[createddate]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DV_CreatedDate]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[DV_CreatedBy]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="255"
                              cachedName="DV_CreatedBy"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[createdby]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DV_CreatedBy]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[DataLoadId]"
                              cachedDataType="i4"
                              cachedName="DataLoadId"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[dataload_id]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DataLoadId]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[report_month]"
                              cachedDataType="dbDate"
                              cachedName="report_month"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[report_month]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[report_month]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Source_Code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="15"
                              cachedName="Source_Code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[source_code]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Source_Code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Member_No]"
                              cachedDataType="i8"
                              cachedName="Member_No"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[member_no]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Member_No]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[consumer_no]"
                              cachedDataType="i4"
                              cachedName="consumer_no"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[consumer_no]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[consumer_no]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[purchase_no]"
                              cachedDataType="i4"
                              cachedName="purchase_no"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[purchase_no]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[purchase_no]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[CCard_No]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="18"
                              cachedName="CCard_No"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[ccard_no]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[CCard_No]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[ppid]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="30"
                              cachedName="ppid"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[ppid]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[ppid]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Title]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="15"
                              cachedName="Title"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[title]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Title]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[First_Name]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="15"
                              cachedName="First_Name"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[first_name]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[First_Name]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Last_Name]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="30"
                              cachedName="Last_Name"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[last_name]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Last_Name]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Membership_Plan]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="7"
                              cachedName="Membership_Plan"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[membership_plan]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Membership_Plan]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Member_Status]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="Member_Status"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[member_status]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Member_Status]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Paid_To_date]"
                              cachedDataType="dbTimeStamp2"
                              cachedName="Paid_To_date"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[paid_to_date]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Paid_To_date]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Visit_Date]"
                              cachedDataType="dbTimeStamp2"
                              cachedName="Visit_Date"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_date]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_Date]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Visit_Date2]"
                              cachedDataType="dbTimeStamp2"
                              cachedName="Visit_Date2"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_date2]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_Date2]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Date_Processed]"
                              cachedDataType="dbTimeStamp2"
                              cachedName="Date_Processed"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[date_processed]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Date_Processed]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Visit_status]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="Visit_status"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_status]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_status]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Visit_seq]"
                              cachedDataType="i4"
                              cachedName="Visit_seq"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_seq]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_seq]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[GuestVisits]"
                              cachedDataType="i2"
                              cachedName="GuestVisits"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[guestvisits]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[GuestVisits]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Batch_No]"
                              cachedDataType="i4"
                              cachedName="Batch_No"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[batch_no]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Batch_No]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[consumer_service_centre]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="consumer_service_centre"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[consumer_service_centre]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[consumer_service_centre]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[deal_service_centre]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="1"
                              cachedName="deal_service_centre"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[deal_service_centre]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[deal_service_centre]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[retail_client_service_centre]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="retail_client_service_centre"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[retail_client_service_centre]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[retail_client_service_centre]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Reference]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="20"
                              cachedName="Reference"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[reference]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Reference]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Lounge_Code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="Lounge_Code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[lounge_code]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge_Code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Lounge]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="80"
                              cachedName="Lounge"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[lounge]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[domestic_int_lounge]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="40"
                              cachedName="domestic_int_lounge"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[domestic_int_lounge]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[domestic_int_lounge]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[City]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="100"
                              cachedName="City"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[city]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[City]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Country]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="40"
                              cachedName="Country"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[country]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Country]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Pays_Member_Visit]"
                              cachedDataType="ui1"
                              cachedName="Client_Pays_Member_Visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_pays_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Pays_Member_Visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Inclusive_PP_Member_Visit]"
                              cachedDataType="ui1"
                              cachedName="Inclusive_PP_Member_Visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member_Visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Complimentary_Member_Visit]"
                              cachedDataType="ui1"
                              cachedName="Complimentary_Member_Visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Member_Visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Cardholder_Pays_Member_Visit]"
                              cachedDataType="ui1"
                              cachedName="Cardholder_Pays_Member_Visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_pays_member_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Pays_Member_Visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Pays_Guest_Visit]"
                              cachedDataType="ui1"
                              cachedName="Client_Pays_Guest_Visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_pays_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Pays_Guest_Visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Inclusive_PP_Guest_Visit]"
                              cachedDataType="ui1"
                              cachedName="Inclusive_PP_Guest_Visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Guest_Visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Complimentary_Guest_Visit]"
                              cachedDataType="ui1"
                              cachedName="Complimentary_Guest_Visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Guest_Visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Cardholder_Pays_Guest_Visit]"
                              cachedDataType="ui1"
                              cachedName="Cardholder_Pays_Guest_Visit"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_pays_guest_visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Pays_Guest_Visit]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Lounge_Visit_Offer]"
                              cachedDataType="ui1"
                              cachedName="Lounge_Visit_Offer"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[lounge_visit_offer]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge_Visit_Offer]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Member]"
                              cachedDataType="i4"
                              cachedName="Client_Member"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Inclusive_PP_Member]"
                              cachedDataType="i4"
                              cachedName="Inclusive_PP_Member"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Guest]"
                              cachedDataType="i4"
                              cachedName="Client_Guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Inclusive_PP_Guest]"
                              cachedDataType="i4"
                              cachedName="Inclusive_PP_Guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Member_Guest]"
                              cachedDataType="i4"
                              cachedName="Client_Member_Guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Member_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Inclusive_PP_Member_Guest]"
                              cachedDataType="i4"
                              cachedName="Inclusive_PP_Member_Guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Complimentary_Member_Guest]"
                              cachedDataType="i4"
                              cachedName="Complimentary_Member_Guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_member_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Member_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Visit_Currency_Member]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="Client_Visit_Currency_Member"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_currency_member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Currency_Member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Visit_Amount_Member]"
                              cachedDataType="numeric"
                              cachedName="Client_Visit_Amount_Member"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_amount_member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Amount_Member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Visit_Currency_Guest]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="Client_Visit_Currency_Guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_currency_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Currency_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Client_Visit_Amount_Guest]"
                              cachedDataType="numeric"
                              cachedName="Client_Visit_Amount_Guest"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_amount_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Amount_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Total_Client_Amount_Currency]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="Total_Client_Amount_Currency"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[total_client_amount_currency]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Client_Amount_Currency]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Total_Client_Amount]"
                              cachedDataType="numeric"
                              cachedName="Total_Client_Amount"
                              cachedPrecision="11"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[total_client_amount]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Client_Amount]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Cardholder_Visit_Currency_Member]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="Cardholder_Visit_Currency_Member"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_currency_member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Currency_Member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Cardholder_Visit_Amount_Member]"
                              cachedDataType="numeric"
                              cachedName="Cardholder_Visit_Amount_Member"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_amount_member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Amount_Member]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Cardholder_Visit_Currency_Guest]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="Cardholder_Visit_Currency_Guest"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_currency_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Currency_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Cardholder_Visit_Amount_Guest]"
                              cachedDataType="numeric"
                              cachedName="Cardholder_Visit_Amount_Guest"
                              cachedPrecision="10"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_amount_guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Amount_Guest]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Total_Cardholder_Amount_Currency]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="2"
                              cachedName="Total_Cardholder_Amount_Currency"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[total_cardholder_amount_currency]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Cardholder_Amount_Currency]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Total_Cardholder_Amount]"
                              cachedDataType="numeric"
                              cachedName="Total_Cardholder_Amount"
                              cachedPrecision="11"
                              cachedScale="2"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[total_cardholder_amount]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Cardholder_Amount]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Cost_Centre]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="Cost_Centre"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cost_centre]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cost_Centre]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Campaign_Code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="Campaign_Code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[campaign_code]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Campaign_Code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Vendor_Code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="Vendor_Code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[vendor_code]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Vendor_Code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[User_Invitation_Code]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="10"
                              cachedName="User_Invitation_Code"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[user_invitation_code]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[User_Invitation_Code]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Unique_reference]"
                              cachedDataType="wstr"
                              cachedLength="25"
                              cachedName="Unique_reference"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[unique_reference]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Unique_reference]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Process month1]"
                              cachedDataType="wstr"
                              cachedLength="255"
                              cachedName="Process month1"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[process_month]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[Process month1]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[VisitTime1]"
                              cachedDataType="wstr"
                              cachedLength="50"
                              cachedName="VisitTime1"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_time]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[VisitTime1]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Source_code_desc]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="30"
                              cachedName="Source_code_desc"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[source_code_desc]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Source_code_desc]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].Columns[Airport]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="50"
                              cachedName="Airport"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[airport]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Airport]" />
                          </inputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[subscription_level_desc]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="subscription_level_desc" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[dataload_workflow_id]"
                              dataType="i4"
                              name="dataload_workflow_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[is_current]"
                              dataType="i4"
                              name="is_current" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[is_deleted]"
                              dataType="i4"
                              name="is_deleted" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[tbl_index]"
                              dataType="i4"
                              name="tbl_index" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[report_month]"
                              dataType="dbDate"
                              name="report_month" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[process_month]"
                              dataType="wstr"
                              length="255"
                              name="process_month" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[bin_number]"
                              dataType="i8"
                              name="bin_number" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[issuer]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="issuer" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[selected_nonselected]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="selected_nonselected" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[issuer_country]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="issuer_country" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[ica]"
                              dataType="i4"
                              name="ica" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[deal_type]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="deal_type" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[optional_core]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="optional_core" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[po]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="po" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[product]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="product" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_time]"
                              dataType="wstr"
                              length="50"
                              name="visit_time" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[unique_reference]"
                              dataType="wstr"
                              length="50"
                              name="unique_reference" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[source_code]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="source_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[member_no]"
                              dataType="i8"
                              name="member_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[ccard_no]"
                              dataType="i8"
                              name="ccard_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[title]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              name="title" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[first_name]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="first_name" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[last_name]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="last_name" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[membership_plan]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="membership_plan" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[member_status]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              name="member_status" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[paid_to_date]"
                              dataType="dbTimeStamp"
                              name="paid_to_date" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_date]"
                              dataType="dbTimeStamp"
                              name="visit_date" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[date_processed]"
                              dataType="dbTimeStamp"
                              name="date_processed" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[guestvisits]"
                              dataType="i4"
                              name="guestvisits" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[batch_no]"
                              dataType="i4"
                              name="batch_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[reference]"
                              codePage="1252"
                              dataType="str"
                              length="50"
                              name="reference" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[lounge_code]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              name="lounge_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[lounge]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="lounge" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[airport]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="airport" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[city]"
                              codePage="1252"
                              dataType="str"
                              length="100"
                              name="city" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[country]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              name="country" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_pays_member_visit]"
                              dataType="i4"
                              name="client_pays_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member_visit]"
                              dataType="i4"
                              name="inclusive_pp_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_member_visit]"
                              dataType="i4"
                              name="complimentary_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_pays_member_visit]"
                              dataType="i4"
                              name="cardholder_pays_member_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_pays_guest_visit]"
                              dataType="i4"
                              name="client_pays_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_guest_visit]"
                              dataType="i4"
                              name="inclusive_pp_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_guest_visit]"
                              dataType="i4"
                              name="complimentary_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_pays_guest_visit]"
                              dataType="i4"
                              name="cardholder_pays_guest_visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[lounge_visit_offer]"
                              dataType="i4"
                              name="lounge_visit_offer" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_member]"
                              dataType="i4"
                              name="client_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member]"
                              dataType="i4"
                              name="inclusive_pp_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_guest]"
                              dataType="i4"
                              name="client_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_guest]"
                              dataType="i4"
                              name="inclusive_pp_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_member_guest]"
                              dataType="i4"
                              name="client_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[inclusive_pp_member_guest]"
                              dataType="i4"
                              name="inclusive_pp_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[complimentary_member_guest]"
                              dataType="i4"
                              name="complimentary_member_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="client_visit_currency_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_amount_member]"
                              dataType="numeric"
                              name="client_visit_amount_member"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="client_visit_currency_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[client_visit_amount_guest]"
                              dataType="numeric"
                              name="client_visit_amount_guest"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[total_client_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="total_client_amount_currency" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[total_client_amount]"
                              dataType="numeric"
                              name="total_client_amount"
                              precision="11"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_currency_member]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="cardholder_visit_currency_member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_amount_member]"
                              dataType="numeric"
                              name="cardholder_visit_amount_member"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_currency_guest]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="cardholder_visit_currency_guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cardholder_visit_amount_guest]"
                              dataType="numeric"
                              name="cardholder_visit_amount_guest"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[total_cardholder_amount_currency]"
                              codePage="1252"
                              dataType="str"
                              length="5"
                              name="total_cardholder_amount_currency" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[total_cardholder_amount]"
                              dataType="numeric"
                              name="total_cardholder_amount"
                              precision="11"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cost_centre]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="cost_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[campaign_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="campaign_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[vendor_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="vendor_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[user_invitation_code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="user_invitation_code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[domestic_int_lounge]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              name="domestic_int_lounge" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[createddate]"
                              dataType="dbDate"
                              name="createddate" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[createdby]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="createdby" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[dataload_id]"
                              dataType="i4"
                              name="dataload_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[src_ref_id]"
                              dataType="i4"
                              name="src_ref_id" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[consumer_no]"
                              dataType="i8"
                              name="consumer_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[purchase_no]"
                              dataType="i8"
                              name="purchase_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[ppid]"
                              dataType="i8"
                              name="ppid" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[consumer_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="consumer_service_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[deal_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="deal_service_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[retail_client_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="retail_client_service_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_status]"
                              codePage="1252"
                              dataType="str"
                              length="50"
                              name="visit_status" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_seq]"
                              dataType="i4"
                              name="visit_seq" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[visit_date2]"
                              dataType="dbTimeStamp"
                              name="visit_date2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[cc_marker]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="cc_marker" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input].ExternalColumns[source_code_desc]"
                              codePage="1252"
                              dataType="str"
                              length="255"
                              name="source_code_desc" />
                          </externalMetadataColumns>
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Outputs[OLE DB Destination Error Output]"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="OLE DB Destination Error Output"
                          synchronousInputId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID"
                      componentClassID="Microsoft.DerivedColumn"
                      contactInfo="Derived Column;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
                      description="Creates new column values by applying expressions to transformation input columns. Create new columns or overwrite existing ones. For example, concatenate the values from the 'first name' and 'last name' column to make a 'full name' column."
                      name="Get DataLoadWorkFlowID"
                      usesDispositions="true">
                      <inputs>
                        <input
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Inputs[Derived Column Input]"
                          description="Input to the Derived Column Transformation"
                          name="Derived Column Input">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Inputs[Derived Column Input].Columns[Process month]"
                              cachedDataType="wstr"
                              cachedLength="4000"
                              cachedName="Process month"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Process month]" />
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Inputs[Derived Column Input].Columns[VisitTime]"
                              cachedCodepage="1252"
                              cachedDataType="str"
                              cachedLength="12"
                              cachedName="VisitTime"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[VisitTime]" />
                          </inputColumns>
                          <externalMetadataColumns />
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output]"
                          description="Default Output of the Derived Column Transformation"
                          exclusionGroup="1"
                          name="Derived Column Output"
                          synchronousInputId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Inputs[Derived Column Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DataLoadWorkFlowID]"
                              dataType="i4"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DataLoadWorkFlowID]"
                              name="DataLoadWorkFlowID"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">@[$Package::int_DataloadWorkFlowID]</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">@[$Package::int_DataloadWorkFlowID]</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DV_CreatedDate]"
                              dataType="date"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DV_CreatedDate]"
                              name="DV_CreatedDate"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">@[System::ContainerStartTime]</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">@[System::ContainerStartTime]</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DV_CreatedBy]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DV_CreatedBy]"
                              name="DV_CreatedBy"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">(DT_STR,255,1252)@[System::UserName]</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">(DT_STR,255,1252)@[System::UserName]</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DataLoadId]"
                              dataType="i4"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[DataLoadId]"
                              name="DataLoadId"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">@[User::intDataLoadID]</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">@[User::intDataLoadID]</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[VisitTime1]"
                              dataType="wstr"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[VisitTime1]"
                              name="VisitTime1"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">(DT_WSTR,50)#{Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[VisitTime]}</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">(DT_WSTR,50)VisitTime</property>
                              </properties>
                            </outputColumn>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[Process month1]"
                              dataType="wstr"
                              errorOrTruncationOperation="Computation"
                              errorRowDisposition="FailComponent"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output].Columns[Process month1]"
                              name="Process month1"
                              truncationRowDisposition="FailComponent">
                              <properties>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Expression"
                                  name="Expression">(DT_WSTR,255)#{Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Process month]}</property>
                                <property
                                  containsID="true"
                                  dataType="System.String"
                                  description="Derived Column Friendly Expression"
                                  expressionType="Notify"
                                  name="FriendlyExpression">(DT_WSTR,255)[Process month]</property>
                              </properties>
                            </outputColumn>
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                        <output
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Error Output]"
                          description="Error Output of the Derived Column Transformation"
                          exclusionGroup="1"
                          isErrorOut="true"
                          name="Derived Column Error Output"
                          synchronousInputId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Inputs[Derived Column Input]">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Row Count"
                      componentClassID="Microsoft.RowCount"
                      contactInfo="Row Count;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
                      description="Counts rows as they pass through a data flow. For example, use the number of rows processed to determine whether or not to perform cleanup operations, or update text in an e-mail message to communicate processing status."
                      name="Row Count">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the variable to hold the row count."
                          name="VariableName">User::intRecInsertedCount</property>
                      </properties>
                      <inputs>
                        <input
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Row Count.Inputs[Row Count Input 1]"
                          hasSideEffects="true"
                          name="Row Count Input 1">
                          <externalMetadataColumns />
                        </input>
                      </inputs>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Row Count.Outputs[Row Count Output 1]"
                          name="Row Count Output 1"
                          synchronousInputId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Row Count.Inputs[Row Count Input 1]">
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource"
                      componentClassID="Microsoft.OLEDBSource"
                      contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
                      description="OLE DB Source"
                      name="Source dbwsvisitsbysource"
                      usesDispositions="true"
                      validateExternalMetadata="False"
                      version="7">
                      <properties>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.String"
                          description="Specifies the name of the database object used to open a rowset."
                          name="OpenRowset"></property>
                        <property
                          dataType="System.String"
                          description="Specifies the variable that contains the name of the database object used to open a rowset."
                          name="OpenRowsetVariable"></property>
                        <property
                          dataType="System.String"
                          description="The SQL command to be executed."
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">SELECT * FROM ##dbwsvisitsbysource</property>
                        <property
                          dataType="System.String"
                          description="The variable that contains the SQL command to be executed."
                          name="SqlCommandVariable">User::testVariable</property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the column code page to use when code page information is unavailable from the data source."
                          name="DefaultCodePage">1252</property>
                        <property
                          dataType="System.Boolean"
                          description="Forces the use of the DefaultCodePage property value when describing character data."
                          name="AlwaysUseDefaultCodePage">false</property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the mode used to access the database."
                          name="AccessMode"
                          typeConverter="AccessMode">2</property>
                        <property
                          dataType="System.String"
                          description="The mappings between the parameters in the SQL command and variables."
                          name="ParameterMapping"></property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Connections[OleDbConnection]"
                          connectionManagerID="{36CE4184-F162-41D7-BC4F-227B15E1C904}:external"
                          connectionManagerRefId="Project.ConnectionManagers[PPDB]"
                          description="The OLE DB runtime connection used to access the database."
                          name="OleDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output]"
                          name="OLE DB Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[report_month]"
                              dataType="dbDate"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[report_month]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[report_month]"
                              name="report_month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Process month]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Process month]"
                              length="4000"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Process month]"
                              name="Process month"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Source_Code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Source_Code]"
                              length="15"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Source_Code]"
                              name="Source_Code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Member_No]"
                              dataType="i8"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Member_No]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Member_No]"
                              name="Member_No"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[consumer_no]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[consumer_no]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[consumer_no]"
                              name="consumer_no"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[purchase_no]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[purchase_no]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[purchase_no]"
                              name="purchase_no"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[CCard_No]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[CCard_No]"
                              length="18"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[CCard_No]"
                              name="CCard_No"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[ppid]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[ppid]"
                              length="30"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[ppid]"
                              name="ppid"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[bin]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[bin]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[bin]"
                              name="bin"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Title]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Title]"
                              length="15"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Title]"
                              name="Title"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[First_Name]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[First_Name]"
                              length="15"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[First_Name]"
                              name="First_Name"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Last_Name]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Last_Name]"
                              length="30"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Last_Name]"
                              name="Last_Name"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Membership_Plan]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Membership_Plan]"
                              length="7"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Membership_Plan]"
                              name="Membership_Plan"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Member_Status]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Member_Status]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Member_Status]"
                              name="Member_Status"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Paid_To_date]"
                              dataType="dbTimeStamp2"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Paid_To_date]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Paid_To_date]"
                              name="Paid_To_date"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_Date]"
                              dataType="dbTimeStamp2"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Visit_Date]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_Date]"
                              name="Visit_Date"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_Date2]"
                              dataType="dbTimeStamp2"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Visit_Date2]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_Date2]"
                              name="Visit_Date2"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Date_Processed]"
                              dataType="dbTimeStamp2"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Date_Processed]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Date_Processed]"
                              name="Date_Processed"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_status]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Visit_status]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_status]"
                              name="Visit_status"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_seq]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Visit_seq]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Visit_seq]"
                              name="Visit_seq"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[GuestVisits]"
                              dataType="i2"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[GuestVisits]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[GuestVisits]"
                              name="GuestVisits"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Batch_No]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Batch_No]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Batch_No]"
                              name="Batch_No"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[consumer_service_centre]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[consumer_service_centre]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[consumer_service_centre]"
                              name="consumer_service_centre"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[deal_service_centre]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[deal_service_centre]"
                              length="1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[deal_service_centre]"
                              name="deal_service_centre"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[retail_client_service_centre]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[retail_client_service_centre]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[retail_client_service_centre]"
                              name="retail_client_service_centre"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Reference]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Reference]"
                              length="20"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Reference]"
                              name="Reference"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge_Code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Lounge_Code]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge_Code]"
                              name="Lounge_Code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Lounge]"
                              length="80"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge]"
                              name="Lounge"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[domestic_int_lounge]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[domestic_int_lounge]"
                              length="40"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[domestic_int_lounge]"
                              name="domestic_int_lounge"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[City]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[City]"
                              length="100"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[City]"
                              name="City"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Country]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Country]"
                              length="40"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Country]"
                              name="Country"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Pays_Member_Visit]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Pays_Member_Visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Pays_Member_Visit]"
                              name="Client_Pays_Member_Visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member_Visit]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Member_Visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member_Visit]"
                              name="Inclusive_PP_Member_Visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Member_Visit]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Complimentary_Member_Visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Member_Visit]"
                              name="Complimentary_Member_Visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Pays_Member_Visit]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Pays_Member_Visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Pays_Member_Visit]"
                              name="Cardholder_Pays_Member_Visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Pays_Guest_Visit]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Pays_Guest_Visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Pays_Guest_Visit]"
                              name="Client_Pays_Guest_Visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Guest_Visit]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Guest_Visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Guest_Visit]"
                              name="Inclusive_PP_Guest_Visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Guest_Visit]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Complimentary_Guest_Visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Guest_Visit]"
                              name="Complimentary_Guest_Visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Pays_Guest_Visit]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Pays_Guest_Visit]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Pays_Guest_Visit]"
                              name="Cardholder_Pays_Guest_Visit"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge_Visit_Offer]"
                              dataType="ui1"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Lounge_Visit_Offer]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Lounge_Visit_Offer]"
                              name="Lounge_Visit_Offer"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Member]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Member]"
                              name="Client_Member"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member]"
                              name="Inclusive_PP_Member"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Guest]"
                              name="Client_Guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Guest]"
                              name="Inclusive_PP_Guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Member_Guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Member_Guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Member_Guest]"
                              name="Client_Member_Guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member_Guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Member_Guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Inclusive_PP_Member_Guest]"
                              name="Inclusive_PP_Member_Guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Member_Guest]"
                              dataType="i4"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Complimentary_Member_Guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Complimentary_Member_Guest]"
                              name="Complimentary_Member_Guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Currency_Member]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Visit_Currency_Member]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Currency_Member]"
                              name="Client_Visit_Currency_Member"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Amount_Member]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Visit_Amount_Member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Amount_Member]"
                              name="Client_Visit_Amount_Member"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Currency_Guest]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Visit_Currency_Guest]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Currency_Guest]"
                              name="Client_Visit_Currency_Guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Amount_Guest]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Visit_Amount_Guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Client_Visit_Amount_Guest]"
                              name="Client_Visit_Amount_Guest"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Client_Amount_Currency]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Total_Client_Amount_Currency]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Client_Amount_Currency]"
                              name="Total_Client_Amount_Currency"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Client_Amount]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Total_Client_Amount]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Client_Amount]"
                              name="Total_Client_Amount"
                              precision="11"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Currency_Member]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Visit_Currency_Member]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Currency_Member]"
                              name="Cardholder_Visit_Currency_Member"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Amount_Member]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Visit_Amount_Member]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Amount_Member]"
                              name="Cardholder_Visit_Amount_Member"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Currency_Guest]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Visit_Currency_Guest]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Currency_Guest]"
                              name="Cardholder_Visit_Currency_Guest"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Amount_Guest]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Visit_Amount_Guest]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cardholder_Visit_Amount_Guest]"
                              name="Cardholder_Visit_Amount_Guest"
                              precision="10"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Cardholder_Amount_Currency]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Total_Cardholder_Amount_Currency]"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Cardholder_Amount_Currency]"
                              name="Total_Cardholder_Amount_Currency"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Cardholder_Amount]"
                              dataType="numeric"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Total_Cardholder_Amount]"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Total_Cardholder_Amount]"
                              name="Total_Cardholder_Amount"
                              precision="11"
                              scale="2"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cost_Centre]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cost_Centre]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Cost_Centre]"
                              name="Cost_Centre"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Campaign_Code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Campaign_Code]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Campaign_Code]"
                              name="Campaign_Code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Vendor_Code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Vendor_Code]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Vendor_Code]"
                              name="Vendor_Code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[User_Invitation_Code]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[User_Invitation_Code]"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[User_Invitation_Code]"
                              name="User_Invitation_Code"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[VisitTime]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[VisitTime]"
                              length="12"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[VisitTime]"
                              name="VisitTime"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Unique_reference]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Unique_reference]"
                              length="25"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Unique_reference]"
                              name="Unique_reference"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Source_code_desc]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Source_code_desc]"
                              length="30"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Source_code_desc]"
                              name="Source_code_desc"
                              truncationRowDisposition="FailComponent" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Airport]"
                              codePage="1252"
                              dataType="str"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Airport]"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].Columns[Airport]"
                              name="Airport"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[report_month]"
                              dataType="dbDate"
                              name="report_month" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Process month]"
                              dataType="wstr"
                              length="4000"
                              name="Process month" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Source_Code]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              name="Source_Code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Member_No]"
                              dataType="i8"
                              name="Member_No" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[consumer_no]"
                              dataType="i4"
                              name="consumer_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[purchase_no]"
                              dataType="i4"
                              name="purchase_no" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[CCard_No]"
                              codePage="1252"
                              dataType="str"
                              length="18"
                              name="CCard_No" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[ppid]"
                              codePage="1252"
                              dataType="str"
                              length="30"
                              name="ppid" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[bin]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="bin" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Title]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              name="Title" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[First_Name]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              name="First_Name" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Last_Name]"
                              codePage="1252"
                              dataType="str"
                              length="30"
                              name="Last_Name" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Membership_Plan]"
                              codePage="1252"
                              dataType="str"
                              length="7"
                              name="Membership_Plan" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Member_Status]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="Member_Status" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Paid_To_date]"
                              dataType="dbTimeStamp2"
                              name="Paid_To_date"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Visit_Date]"
                              dataType="dbTimeStamp2"
                              name="Visit_Date"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Visit_Date2]"
                              dataType="dbTimeStamp2"
                              name="Visit_Date2"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Date_Processed]"
                              dataType="dbTimeStamp2"
                              name="Date_Processed"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Visit_status]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="Visit_status" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Visit_seq]"
                              dataType="i4"
                              name="Visit_seq" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[GuestVisits]"
                              dataType="i2"
                              name="GuestVisits" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Batch_No]"
                              dataType="i4"
                              name="Batch_No" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[consumer_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="consumer_service_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[deal_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="1"
                              name="deal_service_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[retail_client_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="retail_client_service_centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Reference]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              name="Reference" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Lounge_Code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="Lounge_Code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Lounge]"
                              codePage="1252"
                              dataType="str"
                              length="80"
                              name="Lounge" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[domestic_int_lounge]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              name="domestic_int_lounge" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Airport]"
                              codePage="1252"
                              dataType="str"
                              length="50"
                              name="Airport" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[City]"
                              codePage="1252"
                              dataType="str"
                              length="100"
                              name="City" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Country]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              name="Country" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Pays_Member_Visit]"
                              dataType="ui1"
                              name="Client_Pays_Member_Visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Member_Visit]"
                              dataType="ui1"
                              name="Inclusive_PP_Member_Visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Complimentary_Member_Visit]"
                              dataType="ui1"
                              name="Complimentary_Member_Visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Pays_Member_Visit]"
                              dataType="ui1"
                              name="Cardholder_Pays_Member_Visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Pays_Guest_Visit]"
                              dataType="ui1"
                              name="Client_Pays_Guest_Visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Guest_Visit]"
                              dataType="ui1"
                              name="Inclusive_PP_Guest_Visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Complimentary_Guest_Visit]"
                              dataType="ui1"
                              name="Complimentary_Guest_Visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Pays_Guest_Visit]"
                              dataType="ui1"
                              name="Cardholder_Pays_Guest_Visit" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Lounge_Visit_Offer]"
                              dataType="ui1"
                              name="Lounge_Visit_Offer" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Member]"
                              dataType="i4"
                              name="Client_Member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Member]"
                              dataType="i4"
                              name="Inclusive_PP_Member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Guest]"
                              dataType="i4"
                              name="Client_Guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Guest]"
                              dataType="i4"
                              name="Inclusive_PP_Guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Member_Guest]"
                              dataType="i4"
                              name="Client_Member_Guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Inclusive_PP_Member_Guest]"
                              dataType="i4"
                              name="Inclusive_PP_Member_Guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Complimentary_Member_Guest]"
                              dataType="i4"
                              name="Complimentary_Member_Guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Visit_Currency_Member]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="Client_Visit_Currency_Member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Visit_Amount_Member]"
                              dataType="numeric"
                              name="Client_Visit_Amount_Member"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Visit_Currency_Guest]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="Client_Visit_Currency_Guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Client_Visit_Amount_Guest]"
                              dataType="numeric"
                              name="Client_Visit_Amount_Guest"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Total_Client_Amount_Currency]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="Total_Client_Amount_Currency" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Total_Client_Amount]"
                              dataType="numeric"
                              name="Total_Client_Amount"
                              precision="11"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Visit_Currency_Member]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="Cardholder_Visit_Currency_Member" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Visit_Amount_Member]"
                              dataType="numeric"
                              name="Cardholder_Visit_Amount_Member"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Visit_Currency_Guest]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="Cardholder_Visit_Currency_Guest" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cardholder_Visit_Amount_Guest]"
                              dataType="numeric"
                              name="Cardholder_Visit_Amount_Guest"
                              precision="10"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Total_Cardholder_Amount_Currency]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              name="Total_Cardholder_Amount_Currency" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Total_Cardholder_Amount]"
                              dataType="numeric"
                              name="Total_Cardholder_Amount"
                              precision="11"
                              scale="2" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Cost_Centre]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="Cost_Centre" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Campaign_Code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="Campaign_Code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Vendor_Code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="Vendor_Code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[User_Invitation_Code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              name="User_Invitation_Code" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[VisitTime]"
                              codePage="1252"
                              dataType="str"
                              length="12"
                              name="VisitTime" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Unique_reference]"
                              dataType="wstr"
                              length="25"
                              name="Unique_reference" />
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output].ExternalColumns[Source_code_desc]"
                              codePage="1252"
                              dataType="str"
                              length="30"
                              name="Source_code_desc" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output]"
                          isErrorOut="true"
                          name="OLE DB Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[report_month]"
                              dataType="dbDate"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[report_month]"
                              name="report_month" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Process month]"
                              dataType="wstr"
                              length="4000"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Process month]"
                              name="Process month" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Source_Code]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Source_Code]"
                              name="Source_Code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Source_code_desc]"
                              codePage="1252"
                              dataType="str"
                              length="30"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Source_code_desc]"
                              name="Source_code_desc" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Member_No]"
                              dataType="i8"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Member_No]"
                              name="Member_No" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[consumer_no]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[consumer_no]"
                              name="consumer_no" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[purchase_no]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[purchase_no]"
                              name="purchase_no" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[CCard_No]"
                              codePage="1252"
                              dataType="str"
                              length="18"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[CCard_No]"
                              name="CCard_No" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[ppid]"
                              codePage="1252"
                              dataType="str"
                              length="30"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[ppid]"
                              name="ppid" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[bin]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[bin]"
                              name="bin" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Title]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Title]"
                              name="Title" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[First_Name]"
                              codePage="1252"
                              dataType="str"
                              length="15"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[First_Name]"
                              name="First_Name" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Last_Name]"
                              codePage="1252"
                              dataType="str"
                              length="30"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Last_Name]"
                              name="Last_Name" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Membership_Plan]"
                              codePage="1252"
                              dataType="str"
                              length="7"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Membership_Plan]"
                              name="Membership_Plan" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Member_Status]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Member_Status]"
                              name="Member_Status" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Paid_To_date]"
                              dataType="dbTimeStamp2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Paid_To_date]"
                              name="Paid_To_date"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Visit_Date]"
                              dataType="dbTimeStamp2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Visit_Date]"
                              name="Visit_Date"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Visit_Date2]"
                              dataType="dbTimeStamp2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Visit_Date2]"
                              name="Visit_Date2"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Date_Processed]"
                              dataType="dbTimeStamp2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Date_Processed]"
                              name="Date_Processed"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Visit_status]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Visit_status]"
                              name="Visit_status" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Visit_seq]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Visit_seq]"
                              name="Visit_seq" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[GuestVisits]"
                              dataType="i2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[GuestVisits]"
                              name="GuestVisits" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Batch_No]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Batch_No]"
                              name="Batch_No" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[consumer_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[consumer_service_centre]"
                              name="consumer_service_centre" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[deal_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[deal_service_centre]"
                              name="deal_service_centre" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[retail_client_service_centre]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[retail_client_service_centre]"
                              name="retail_client_service_centre" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Reference]"
                              codePage="1252"
                              dataType="str"
                              length="20"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Reference]"
                              name="Reference" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Lounge_Code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Lounge_Code]"
                              name="Lounge_Code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Lounge]"
                              codePage="1252"
                              dataType="str"
                              length="80"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Lounge]"
                              name="Lounge" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[domestic_int_lounge]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[domestic_int_lounge]"
                              name="domestic_int_lounge" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[City]"
                              codePage="1252"
                              dataType="str"
                              length="100"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[City]"
                              name="City" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Country]"
                              codePage="1252"
                              dataType="str"
                              length="40"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Country]"
                              name="Country" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Pays_Member_Visit]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Pays_Member_Visit]"
                              name="Client_Pays_Member_Visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Member_Visit]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Member_Visit]"
                              name="Inclusive_PP_Member_Visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Complimentary_Member_Visit]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Complimentary_Member_Visit]"
                              name="Complimentary_Member_Visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Pays_Member_Visit]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Pays_Member_Visit]"
                              name="Cardholder_Pays_Member_Visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Pays_Guest_Visit]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Pays_Guest_Visit]"
                              name="Client_Pays_Guest_Visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Guest_Visit]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Guest_Visit]"
                              name="Inclusive_PP_Guest_Visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Complimentary_Guest_Visit]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Complimentary_Guest_Visit]"
                              name="Complimentary_Guest_Visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Pays_Guest_Visit]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Pays_Guest_Visit]"
                              name="Cardholder_Pays_Guest_Visit" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Lounge_Visit_Offer]"
                              dataType="ui1"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Lounge_Visit_Offer]"
                              name="Lounge_Visit_Offer" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Member]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Member]"
                              name="Client_Member" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Member]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Member]"
                              name="Inclusive_PP_Member" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Guest]"
                              name="Client_Guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Guest]"
                              name="Inclusive_PP_Guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Member_Guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Member_Guest]"
                              name="Client_Member_Guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Member_Guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Inclusive_PP_Member_Guest]"
                              name="Inclusive_PP_Member_Guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Complimentary_Member_Guest]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Complimentary_Member_Guest]"
                              name="Complimentary_Member_Guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Visit_Currency_Member]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Visit_Currency_Member]"
                              name="Client_Visit_Currency_Member" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Visit_Amount_Member]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Visit_Amount_Member]"
                              name="Client_Visit_Amount_Member"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Visit_Currency_Guest]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Visit_Currency_Guest]"
                              name="Client_Visit_Currency_Guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Visit_Amount_Guest]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Client_Visit_Amount_Guest]"
                              name="Client_Visit_Amount_Guest"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Total_Client_Amount_Currency]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Total_Client_Amount_Currency]"
                              name="Total_Client_Amount_Currency" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Total_Client_Amount]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Total_Client_Amount]"
                              name="Total_Client_Amount"
                              precision="11"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Visit_Currency_Member]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Visit_Currency_Member]"
                              name="Cardholder_Visit_Currency_Member" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Visit_Amount_Member]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Visit_Amount_Member]"
                              name="Cardholder_Visit_Amount_Member"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Visit_Currency_Guest]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Visit_Currency_Guest]"
                              name="Cardholder_Visit_Currency_Guest" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Visit_Amount_Guest]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cardholder_Visit_Amount_Guest]"
                              name="Cardholder_Visit_Amount_Guest"
                              precision="10"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Total_Cardholder_Amount_Currency]"
                              codePage="1252"
                              dataType="str"
                              length="2"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Total_Cardholder_Amount_Currency]"
                              name="Total_Cardholder_Amount_Currency" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Total_Cardholder_Amount]"
                              dataType="numeric"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Total_Cardholder_Amount]"
                              name="Total_Cardholder_Amount"
                              precision="11"
                              scale="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cost_Centre]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Cost_Centre]"
                              name="Cost_Centre" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Campaign_Code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Campaign_Code]"
                              name="Campaign_Code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Vendor_Code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Vendor_Code]"
                              name="Vendor_Code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[User_Invitation_Code]"
                              codePage="1252"
                              dataType="str"
                              length="10"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[User_Invitation_Code]"
                              name="User_Invitation_Code" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[VisitTime]"
                              codePage="1252"
                              dataType="str"
                              length="12"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[VisitTime]"
                              name="VisitTime" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Unique_reference]"
                              dataType="wstr"
                              length="25"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Unique_reference]"
                              name="Unique_reference" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Airport]"
                              codePage="1252"
                              dataType="str"
                              length="50"
                              lineageId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Error Output].Columns[Airport]"
                              name="Airport" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits.Paths[Derived Column Output]"
                      endId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Row Count.Inputs[Row Count Input 1]"
                      name="Derived Column Output"
                      startId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Outputs[Derived Column Output]" />
                    <path
                      refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits.Paths[OLE DB Source Output]"
                      endId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID.Inputs[Derived Column Input]"
                      name="OLE DB Source Output"
                      startId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource.Outputs[OLE DB Source Output]" />
                    <path
                      refId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits.Paths[Row Count Output 1]"
                      endId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits.Inputs[OLE DB Destination Input]"
                      name="Row Count Output 1"
                      startId="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Row Count.Outputs[Row Count Output 1]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
            <DTS:Executable
              DTS:refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster"
              DTS:CreationName="Microsoft.Pipeline"
              DTS:Description="Data Flow Task"
              DTS:DTSID="{47A81532-F5DC-49F6-8495-C9DE7878FC24}"
              DTS:ExecutableType="Microsoft.Pipeline"
              DTS:LocaleID="-1"
              DTS:ObjectName="Source codes from vwGlobalSourceCodeMaster"
              DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
              <DTS:Variables />
              <DTS:ObjectData>
                <pipeline
                  version="1">
                  <components>
                    <component
                      refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster"
                      componentClassID="Microsoft.OLEDBSource"
                      contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
                      description="OLE DB Source"
                      name="Source codes from vwGlobalSourceCodeMaster"
                      usesDispositions="true"
                      version="7">
                      <properties>
                        <property
                          dataType="System.Int32"
                          description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                          name="CommandTimeout">0</property>
                        <property
                          dataType="System.String"
                          description="Specifies the name of the database object used to open a rowset."
                          name="OpenRowset"></property>
                        <property
                          dataType="System.String"
                          description="Specifies the variable that contains the name of the database object used to open a rowset."
                          name="OpenRowsetVariable"></property>
                        <property
                          dataType="System.String"
                          description="The SQL command to be executed."
                          name="SqlCommand"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">SELECT DISTINCT source_code FROM [source].[vwGlobalSourceCodeMaster] WHERE deal_type_code='DBWS' 
and report_month=?</property>
                        <property
                          dataType="System.String"
                          description="The variable that contains the SQL command to be executed."
                          name="SqlCommandVariable"></property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the column code page to use when code page information is unavailable from the data source."
                          name="DefaultCodePage">1252</property>
                        <property
                          dataType="System.Boolean"
                          description="Forces the use of the DefaultCodePage property value when describing character data."
                          name="AlwaysUseDefaultCodePage">false</property>
                        <property
                          dataType="System.Int32"
                          description="Specifies the mode used to access the database."
                          name="AccessMode"
                          typeConverter="AccessMode">2</property>
                        <property
                          dataType="System.String"
                          description="The mappings between the parameters in the SQL command and variables."
                          name="ParameterMapping">"0:Input",{99575F65-B9EC-462B-A955-0B1AB4E0A04A};</property>
                      </properties>
                      <connections>
                        <connection
                          refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Connections[OleDbConnection]"
                          connectionManagerID="{7E223649-2142-4D1E-B44E-5D4EF88BC859}:external"
                          connectionManagerRefId="Project.ConnectionManagers[BI02]"
                          description="The OLE DB runtime connection used to access the database."
                          name="OleDbConnection" />
                      </connections>
                      <outputs>
                        <output
                          refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Output]"
                          name="OLE DB Source Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Output].Columns[source_code]"
                              dataType="wstr"
                              errorOrTruncationOperation="Conversion"
                              errorRowDisposition="FailComponent"
                              externalMetadataColumnId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Output].ExternalColumns[source_code]"
                              length="400"
                              lineageId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Output].Columns[source_code]"
                              name="source_code"
                              truncationRowDisposition="FailComponent" />
                          </outputColumns>
                          <externalMetadataColumns
                            isUsed="True">
                            <externalMetadataColumn
                              refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Output].ExternalColumns[source_code]"
                              dataType="wstr"
                              length="255"
                              name="source_code" />
                          </externalMetadataColumns>
                        </output>
                        <output
                          refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Error Output]"
                          isErrorOut="true"
                          name="OLE DB Source Error Output">
                          <outputColumns>
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                              name="ErrorCode"
                              specialFlags="1" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                              dataType="i4"
                              lineageId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                              name="ErrorColumn"
                              specialFlags="2" />
                            <outputColumn
                              refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Error Output].Columns[source_code]"
                              dataType="wstr"
                              length="255"
                              lineageId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Error Output].Columns[source_code]"
                              name="source_code" />
                          </outputColumns>
                          <externalMetadataColumns />
                        </output>
                      </outputs>
                    </component>
                    <component
                      refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes to variable"
                      componentClassID="Microsoft.ManagedComponentHost"
                      contactInfo="Includes and runs custom script code. For example, apply a business rule that limits the range of valid values in an &quot;income&quot; column or add values in two columns and calculate the average of the sum.;Microsoft Corporation; Microsoft SQL Server; Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;10"
                      description="Includes and runs custom script code. For example, apply a business rule that limits the range of valid values in an &quot;income&quot; column or add values in two columns and calculate the average of the sum."
                      name="Source codes to variable"
                      version="10">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Stores the source code of the component"
                          isArray="true"
                          name="SourceCode"
                          state="cdata">
                          <arrayElements
                            arrayElementCount="30">
                            <arrayElement
                              dataType="System.String"><![CDATA[Properties\AssemblyInfo.cs]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[using System.Reflection;
using System.Runtime.CompilerServices;

//
// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
//
[assembly: AssemblyTitle("SC_8471113a8882499bb949d818da254699")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("Hewlett-Packard Company")]
[assembly: AssemblyProduct("SC_8471113a8882499bb949d818da254699")]
[assembly: AssemblyCopyright("Copyright @ Hewlett-Packard Company 2018")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]
//
// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Revision and Build Numbers 
// by using the '*' as shown below:

[assembly: AssemblyVersion("1.0.0.0")]
]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[SC_8471113a8882499bb949d818da254699.csproj]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectTypeGuids>{30D016F9-3734-4E33-A861-5E7D899E18F3};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{65DB0C08-19C2-4F2E-84D9-3922EDFF99A0}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>SC_8471113a8882499bb949d818da254699</RootNamespace>
    <AssemblyName>SC_8471113a8882499bb949d818da254699</AssemblyName>
    <TargetFrameworkVersion>v4.7</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>true</ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>
    <TargetFrameworkProfile></TargetFrameworkProfile>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>.\bin\Debug\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <DebugSymbols>false</DebugSymbols>
    <Optimize>true</Optimize>
    <OutputPath>.\bin\Release\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.TxScript, Version=13.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.DTSRuntimeWrap, Version=13.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.DTSPipelineWrap, Version=13.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.PipelineHost, Version=13.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
    <Compile Include="main.cs" />
    <Compile Include="BufferWrapper.cs" />
    <Compile Include="ComponentWrapper.cs" />
  </ItemGroup>
  <ItemGroup>
    <AppDesigner Include="Properties\" />
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
    </Compile>
  </ItemGroup>
  <!-- Include the build rules for a C# project.-->
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
  <!-- This section defines VSTA properties that describe the host-changable project properties. -->
  <ProjectExtensions>
    <VisualStudio>
      <FlavorProperties GUID="{30D016F9-3734-4E33-A861-5E7D899E18F3}">
        <ProjectProperties HostName="VSTAHostName" HostPackage="{B3A685AA-7EAF-4BC6-9940-57959FA5AC07}" ApplicationType="usd" Language="cs" TemplatesPath="" />
        <Host Name="ScriptComponent" IconIndex="0" />
        <ProjectClient>
          <HostIdentifier>SSIS_SC130</HostIdentifier>
        </ProjectClient>
      </FlavorProperties>
    </VisualStudio>
  </ProjectExtensions>
</Project>]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[main.cs]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[#region Help:  Introduction to the Script Component
/* The Script Component allows you to perform virtually any operation that can be accomplished in
 * a .Net application within the context of an Integration Services data flow.
 *
 * Expand the other regions which have "Help" prefixes for examples of specific ways to use
 * Integration Services features within this script component. */
#endregion

#region Namespaces
using System;
using System.Data;
using Microsoft.SqlServer.Dts.Pipeline.Wrapper;
using Microsoft.SqlServer.Dts.Runtime.Wrapper;
using Microsoft.SqlServer.Dts.Pipeline;
#endregion

/// <summary>
/// This is the class to which to add your code.  Do not change the name, attributes, or parent
/// of this class.
/// </summary>
[Microsoft.SqlServer.Dts.Pipeline.SSISScriptComponentEntryPointAttribute]
public class ScriptMain : UserComponent
{
    #region Help:  Using Integration Services variables and parameters
    /* To use a variable in this script, first ensure that the variable has been added to
     * either the list contained in the ReadOnlyVariables property or the list contained in
     * the ReadWriteVariables property of this script component, according to whether or not your
     * code needs to write into the variable.  To do so, save this script, close this instance of
     * Visual Studio, and update the ReadOnlyVariables and ReadWriteVariables properties in the
     * Script Transformation Editor window.
     * To use a parameter in this script, follow the same steps. Parameters are always read-only.
     *
     * Example of reading from a variable or parameter:
     *  DateTime startTime = Variables.MyStartTime;
     *
     * Example of writing to a variable:
     *  Variables.myStringVariable = "new value";
     */
    #endregion

    #region Help:  Using Integration Services Connnection Managers
    /* Some types of connection managers can be used in this script component.  See the help topic
     * "Working with Connection Managers Programatically" for details.
     *
     * To use a connection manager in this script, first ensure that the connection manager has
     * been added to either the list of connection managers on the Connection Managers page of the
     * script component editor.  To add the connection manager, save this script, close this instance of
     * Visual Studio, and add the Connection Manager to the list.
     *
     * If the component needs to hold a connection open while processing rows, override the
     * AcquireConnections and ReleaseConnections methods.
     * 
     * Example of using an ADO.Net connection manager to acquire a SqlConnection:
     *  object rawConnection = Connections.SalesDB.AcquireConnection(transaction);
     *  SqlConnection salesDBConn = (SqlConnection)rawConnection;
     *
     * Example of using a File connection manager to acquire a file path:
     *  object rawConnection = Connections.Prices_zip.AcquireConnection(transaction);
     *  string filePath = (string)rawConnection;
     *
     * Example of releasing a connection manager:
     *  Connections.SalesDB.ReleaseConnection(rawConnection);
     */
    #endregion

    #region Help:  Firing Integration Services Events
    /* This script component can fire events.
     *
     * Example of firing an error event:
     *  ComponentMetaData.FireError(10, "Process Values", "Bad value", "", 0, out cancel);
     *
     * Example of firing an information event:
     *  ComponentMetaData.FireInformation(10, "Process Values", "Processing has started", "", 0, fireAgain);
     *
     * Example of firing a warning event:
     *  ComponentMetaData.FireWarning(10, "Process Values", "No rows were received", "", 0);
     */
    #endregion

    string sourcecode;
    /// <summary>
    /// This method is called once, before rows begin to be processed in the data flow.
    ///
    /// You can remove this method if you don't need to do anything here.
    /// </summary>
    public override void PreExecute()
    {
        base.PreExecute();
        /*
         * Add your code here
         */

        //strSource_Code_from_master
       // Variables.strSourceCodefrommaster = "";
        sourcecode = "";


    }

    /// <summary>
    /// This method is called after all the rows have passed through this component.
    ///
    /// You can delete this method if you don't need to do anything here.
    /// </summary>

    /// <summary>
    /// This method is called once for every row that passes through the component from Input0.
    ///
    /// Example of reading a value from a column in the the row:
    ///  string zipCode = Row.ZipCode
    ///
    /// Example of writing a value to a column in the row:
    ///  Row.ZipCode = zipCode
    /// </summary>
    /// <param name="Row">The row that is currently passing through the component</param>
    public override void Input0_ProcessInputRow(Input0Buffer Row)
    {
        /*
         * Add your code here
         */

        sourcecode = sourcecode + "'" +Row.sourcecode.ToString()+ "',";

    }

    public override void PostExecute()
    {
        base.PostExecute();
        /*
         * Add your code here
         */
        Variables.strSourceCodefrommaster = sourcecode.Substring(0, sourcecode.Length - 1);
    }


}
]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[Properties\Resources.resx]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[ComponentWrapper.cs]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[/* THIS IS AUTO-GENERATED CODE THAT WILL BE OVERWRITTEN! DO NOT EDIT!
*  Microsoft SQL Server Integration Services component wrapper
*  This module defines the base class for your component
*  THIS IS AUTO-GENERATED CODE THAT WILL BE OVERWRITTEN! DO NOT EDIT! */

using System;
using System.Data;
using Microsoft.SqlServer.Dts.Pipeline;
using Microsoft.SqlServer.Dts.Pipeline.Wrapper;
using Microsoft.SqlServer.Dts.Runtime.Wrapper;

public class UserComponent: ScriptComponent
{
    public Connections Connections;
    public Variables Variables;
    public UserComponent()
    {
        Connections = new Connections(this);
        Variables = new Variables(this);
    }

    public override void ProcessInput(int InputID, string InputName, PipelineBuffer Buffer, OutputNameMap OutputMap)
    {

        if (InputName.Equals(@"Input 0", StringComparison.Ordinal))
        {
            Input0_ProcessInput(new Input0Buffer(Buffer, GetColumnIndexes(InputID), OutputMap));
        }

    }

    public virtual void Input0_ProcessInput(Input0Buffer Buffer)
    {
        while (Buffer.NextRow())
        {
            Input0_ProcessInputRow(Buffer);
        }
    }

    public virtual void Input0_ProcessInputRow(Input0Buffer Row)
    {
    }

}

public class Connections
{
    ScriptComponent ParentComponent;

    public Connections(ScriptComponent Component)
    {
        ParentComponent = Component;
    }

}

public class Variables
{
    ScriptComponent ParentComponent;

    public Variables(ScriptComponent Component)
    {
        ParentComponent = Component;
    }

    public String strSourceCodefrommaster
    {
        get
        {
            return (String)(ParentComponent.ReadWriteVariables["strSource_Code_from_master"].GetValueWithContext(ScriptComponent.EvaluatorContext));
        }
        set
        {
            ParentComponent.ReadWriteVariables["strSource_Code_from_master"].Value = value;
        }
    }

}
]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[BufferWrapper.cs]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[/* THIS IS AUTO-GENERATED CODE THAT WILL BE OVERWRITTEN! DO NOT EDIT!
*  Microsoft SQL Server Integration Services buffer wrappers
*  This module defines classes for accessing data flow buffers
*  THIS IS AUTO-GENERATED CODE THAT WILL BE OVERWRITTEN! DO NOT EDIT! */



using System;
using System.Data;
using Microsoft.SqlServer.Dts.Pipeline;
using Microsoft.SqlServer.Dts.Pipeline.Wrapper;

public class Input0Buffer: ScriptBuffer

{
    public Input0Buffer(PipelineBuffer Buffer, int[] BufferColumnIndexes, OutputNameMap OutputMap)
        : base(Buffer, BufferColumnIndexes, OutputMap)
    {
    }

    public String sourcecode
    {
        get
        {
            return Buffer.GetString(BufferColumnIndexes[0]);
        }
    }
    public bool sourcecode_IsNull
    {
        get
        {
            return IsNull(0);
        }
    }

    new public bool NextRow()
    {
        return base.NextRow();
    }

    new public bool EndOfRowset()
    {
        return base.EndOfRowset();
    }

}
]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[Project]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF16LE]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<c:Project xmlns:c="http://schemas.microsoft.com/codeprojectml/2010/08/main" xmlns:msb="http://schemas.microsoft.com/developer/msbuild/2003" runtimeVersion="4.0" schemaVersion="1.0">
	<msb:PropertyGroup>
		<msb:CodeName>SC_8471113a8882499bb949d818da254699</msb:CodeName>
		<msb:Language>msBuild</msb:Language>
		<msb:DisplayName>SC_8471113a8882499bb949d818da254699</msb:DisplayName>
		<msb:ProjectId>{BAF921A3-2101-41F1-81C7-B7792A7590A2}</msb:ProjectId>
	</msb:PropertyGroup>
	<msb:ItemGroup>
		<msb:Project Include="SC_8471113a8882499bb949d818da254699.csproj"/>
		<msb:File Include="Properties\Resources.resx"/>
		<msb:File Include="Properties\Settings.Designer.cs"/>
		<msb:File Include="main.cs"/>
		<msb:File Include="BufferWrapper.cs"/>
		<msb:File Include="ComponentWrapper.cs"/>
		<msb:File Include="Properties\Settings.settings"/>
		<msb:File Include="Properties\AssemblyInfo.cs"/>
		<msb:File Include="Properties\Resources.Designer.cs"/>
	</msb:ItemGroup>
</c:Project>]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[Properties\Settings.Designer.cs]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="SC_8471113a8882499bb949d818da254699.Properties.Settings.get_Default():SC_8471113a8882499bb949d818da254699.Properties.Sett" +
    "ings")]

namespace SC_8471113a8882499bb949d818da254699.Properties {
    
    
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        private static Settings defaultInstance = new Settings();
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}
]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[Properties\Settings.settings]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[<?xml version='1.0' encoding='iso-8859-1'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[Properties\Resources.Designer.cs]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[UTF8]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="SC_8471113a8882499bb949d818da254699.Properties.Resources.get_ResourceManager():System.Resources.Resou" +
    "rceManager")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="SC_8471113a8882499bb949d818da254699.Properties.Resources.get_Culture():System.Globalization.CultureIn" +
    "fo")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="SC_8471113a8882499bb949d818da254699.Properties.Resources.set_Culture(System.Globalization.CultureInfo" +
    "):Void")]

namespace SC_8471113a8882499bb949d818da254699.Properties {
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("SC_8471113a8882499bb949d818da254699.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}
]]></arrayElement>
                          </arrayElements>
                        </property>
                        <property
                          dataType="System.String"
                          description="Stores the binary representation of the component"
                          isArray="true"
                          name="BinaryCode"
                          state="cdata">
                          <arrayElements
                            arrayElementCount="2">
                            <arrayElement
                              dataType="System.String"><![CDATA[SC_8471113a8882499bb949d818da254699.dll]]></arrayElement>
                            <arrayElement
                              dataType="System.String"><![CDATA[TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1v
ZGUuDQ0KJAAAAAAAAABQRQAATAEDAEAQcWIAAAAAAAAAAOAAIiALATAAABQAAAAIAAAAAAAAQjMA
AAAgAAAAQAAAAAAAEAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAACAAAAAAgAAAAAAAAMAYIUAABAA
ABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAPAyAABPAAAAAEAAAKQEAAAAAAAAAAAAAAAAAAAA
AAAAAGAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAASBMAAAAgAAAAFAAAAAIA
AAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAKQEAAAAQAAAAAYAAAAWAAAAAAAAAAAAAAAAAABAAABA
LnJlbG9jAAAMAAAAAGAAAAACAAAAHAAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAAAk
MwAAAAAAAEgAAAACAAUAFCIAACQQAAABAAAAAAAAADgyAAC4AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAEoCKBAAAAoCcgEAAHB9AQAABCqeAgJ7AQAABHIDAABwA28G
AAAGbxEAAApyBwAAcCgSAAAKfQEAAAQqrgIoEwAACgJ7AwAABAJ7AQAABBYCewEAAARvFAAAChdZ
bxUAAApvEQAABioeAigKAAAGKioCAwQFKBYAAAoqUgJ7FwAACgJ7GAAAChaUbxkAAAoqIgIWKBoA
AAoqHgIoGwAACioeAigcAAAKKn4CKB0AAAoCAnMOAAAGfQIAAAQCAnMPAAAGfQMAAAQqkgRyDQAA
cBpvHgAACiwVAgUCAygfAAAKDgRzBQAABm8MAAAGKkorBwIDbw0AAAYDbwgAAAYt8SoGKjoCKCAA
AAoCA30EAAAEKjoCKCAAAAoCA30FAAAEKpYCewUAAARvIQAACnIdAABwbyIAAAooIwAACm8kAAAK
dBoAAAEqcgJ7BQAABG8hAAAKch0AAHBvIgAACgNvJQAACioeAiggAAAKKq5+BgAABC0eclMAAHDQ
BwAAAigmAAAKbycAAApzKAAACoAGAAAEfgYAAAQqGn4HAAAEKh4CgAcAAAQqGn4IAAAEKh4CKCkA
AAoqLnMXAAAGgAgAAAQqAAAAQlNKQgEAAQAAAAAADAAAAHY0LjAuMzAzMTkAAAAABQBsAAAArAUA
ACN+AAAYBgAANAcAACNTdHJpbmdzAAAAAEwNAADIAAAAI1VTABQOAAAQAAAAI0dVSUQAAAAkDgAA
AAIAACNCbG9iAAAAAAAAAAIAAAFXFaABCQEAAAD6ATMAFgAAAQAAACIAAAAIAAAACAAAABgAAAAO
AAAAKQAAABAAAAAEAAAABgAAAAgAAAABAAAABQAAAAEAAAAAAF0DAQAAAAAABgAsAhMFBgDAAhMF
BgB4AQAFDwCHBQAABgClAewDBgAPAuwDBgDwAewDBgCnAuwDBgBMAuwDBgBlAuwDBgC8AewDBgDX
AQUDCgCAAsUACgByBMUADgBjBMUACgAbBMUACgBhBsUABgAkBqQDBgBbAQAFBgCDBDMFBgAPBNcD
EgArAUcDEgCMAUcDEgATAcIDBgBAARMFBgArA6QDBgD+A6QDFgARAJMEFgABAJMERwDXBgAAFgAi
AJMEBgDmAKQDBgCXAKQDBgAqB+wDAAAAAF4AAAAAAAEAAQABABAAtwMAABAAAQABAAEAEABWBAAA
OQACAAUAAQAQAEMGAABFAAIACgABABAAEQYAAEkABAAOAAEAEADSBQAASQAFAA8AAAAQADoFlgVJ
AAYAEgAAARAAAQaWBWEACAAWAAEAjACiAAYAEQalAAYA0gWpAAEAUQatAAEAUQatABEAqwOxABEA
AwG1ABEAeAC5AFAgAAAAAMYA3gIGAAEAYyAAAAAAxgAHB70AAQCLIAAAAADGAOkCBgACALcgAAAA
AIYY8wQGAAIAvyAAAAAAhhjzBDEAAgDKIAAAAACGCIgAGwAFAN8gAAAAAIYIhQNNAAUA6CAAAAAA
hgAeB00ABQDwIAAAAACGACsGTQAFAPggAAAAAIYY8wQGAAUAGCEAAAAAxgC2BsMABQA9IQAAAADG
Aa8GvQAJAFAhAAAAAMYBBwe9AAoAUiEAAAAAhhjzBM0ACwBhIQAAAACGGPMEzQAMAHAhAAAAAIYI
uwQbAA0AliEAAAAAhgjXBBAADQCzIQAAAACDGPMEBgAOALshAAAAAJMIfwTTAA4A5yEAAAAAkwjr
ANgADgDuIQAAAACTCPcA3QAOAPYhAAAAAJYINwbjAA8A/SEAAAAAhhjzBAYADwAFIgAAAACRGPkE
6AAPAAAAAQAiBwAAAQB4BAAAAgDcBQAAAwApBAAAAQBnAAAAAgC7AAAAAwB4BAAABAApBAAAAQB4
BAAAAQAiBwAAAQBnBgAAAQBnBgAAAQD/AgAAAQD/AgkA8wQBABEA8wQGABkA8wQKACkA8wQQADEA
8wQQADkA8wQQAEEA8wQQAEkA8wQQAFEA8wQQAFkA8wQQAGEA8wQQAGkA8wQGAJkA8wQGALkA8wQV
AMkA8wQGAIkA3gIGAJEAHwMbANEAHQYfAIkA6QIGANEAPAMnANEAMgMrAHEA8wQxAHEAeAQ7AHEA
3AU/AHkAKANDAHEAlANIAHEAHgdNAHEAKwZNAIkA8wQGANEACgZRAIkA8AVYAJEA8wQGAIkAxQVe
AOEAmwNjAIkA8gZpAOkAwwZuAOkA9QJ0AAEBqQB5AAEBJgeCAKEA8wSIAMEA8wQGAC4ACwADAS4A
EwAMAS4AGwArAS4AIwA0AS4AKwBdAS4AMwBdAS4AOwBjAS4AQwA0AS4ASwCAAS4AUwBdAS4AWwCu
AUMAYwD4AYkAcwArAakAcwArAeMAawD4AQEBewD4AQMAAQAGAAMABwAEAAgABgAAAIwA7AAAAIkD
8AAAANsE7AAAAIME9AAAAAsB+QAAADsG/gACAAYAAwACAAcABQACABAABwABABEABwACABMACQAC
ABQACwABABUACwACABYADQAEgAAAAQAAAAAAAAAAAAAAAAA6AAAABAAAAAAAAAAAAAAAkABvAAAA
AAANAAAAAAAAAAAAAACZAHEGAAAAAA0AAAAAAAAAAAAAAJkAjgYAAAAABAAAAAAAAAAAAAAAkACk
AwAAAAANAAAAAAAAAAAAAACZADMEAAAAAAAAAAABAAAARAUAAAAAAElEVFNWYXJpYWJsZTEwMABJ
RFRTVmFyaWFibGVzMTAwAElEVFNFdmFsdWF0b3JDb250ZXh0MTAwAFNDXzg0NzExMTNhODg4MjQ5
OWJiOTQ5ZDgxOGRhMjU0Njk5ADxNb2R1bGU+AElucHV0SUQAbXNjb3JsaWIAZGVmYXVsdEluc3Rh
bmNlAGdldF9zb3VyY2Vjb2RlAFJ1bnRpbWVUeXBlSGFuZGxlAEdldFR5cGVGcm9tSGFuZGxlAElu
cHV0TmFtZQBNaWNyb3NvZnQuU3FsU2VydmVyLkR0cy5QaXBlbGluZQBUeXBlAGdldF9DdWx0dXJl
AHNldF9DdWx0dXJlAHJlc291cmNlQ3VsdHVyZQBBcHBsaWNhdGlvblNldHRpbmdzQmFzZQBFZGl0
b3JCcm93c2FibGVTdGF0ZQBDb21waWxlckdlbmVyYXRlZEF0dHJpYnV0ZQBEZWJ1Z2dlck5vblVz
ZXJDb2RlQXR0cmlidXRlAERlYnVnZ2FibGVBdHRyaWJ1dGUARWRpdG9yQnJvd3NhYmxlQXR0cmli
dXRlAEFzc2VtYmx5VGl0bGVBdHRyaWJ1dGUAQXNzZW1ibHlUcmFkZW1hcmtBdHRyaWJ1dGUAVGFy
Z2V0RnJhbWV3b3JrQXR0cmlidXRlAEFzc2VtYmx5Q29uZmlndXJhdGlvbkF0dHJpYnV0ZQBBc3Nl
bWJseURlc2NyaXB0aW9uQXR0cmlidXRlAENvbXBpbGF0aW9uUmVsYXhhdGlvbnNBdHRyaWJ1dGUA
QXNzZW1ibHlQcm9kdWN0QXR0cmlidXRlAEFzc2VtYmx5Q29weXJpZ2h0QXR0cmlidXRlAFNTSVNT
Y3JpcHRDb21wb25lbnRFbnRyeVBvaW50QXR0cmlidXRlAEFzc2VtYmx5Q29tcGFueUF0dHJpYnV0
ZQBSdW50aW1lQ29tcGF0aWJpbGl0eUF0dHJpYnV0ZQBQcmVFeGVjdXRlAFBvc3RFeGVjdXRlAHNl
dF9WYWx1ZQB2YWx1ZQBTeXN0ZW0uUnVudGltZS5WZXJzaW9uaW5nAFRvU3RyaW5nAEdldFN0cmlu
ZwBTdWJzdHJpbmcAZ2V0X0xlbmd0aABTeXN0ZW0uQ29tcG9uZW50TW9kZWwAU0NfODQ3MTExM2E4
ODgyNDk5YmI5NDlkODE4ZGEyNTQ2OTkuZGxsAGdldF9zb3VyY2Vjb2RlX0lzTnVsbABnZXRfSXRl
bQBTeXN0ZW0AcmVzb3VyY2VNYW4AU2NyaXB0TWFpbgBTeXN0ZW0uQ29uZmlndXJhdGlvbgBTeXN0
ZW0uR2xvYmFsaXphdGlvbgBTeXN0ZW0uUmVmbGVjdGlvbgBTdHJpbmdDb21wYXJpc29uAEN1bHR1
cmVJbmZvAE91dHB1dE5hbWVNYXAAT3V0cHV0TWFwAE1pY3Jvc29mdC5TcWxTZXJ2ZXIuRFRTUnVu
dGltZVdyYXAASW5wdXQwQnVmZmVyAFBpcGVsaW5lQnVmZmVyAFNjcmlwdEJ1ZmZlcgBnZXRfUmVz
b3VyY2VNYW5hZ2VyAE1pY3Jvc29mdC5TcWxTZXJ2ZXIuRHRzLlJ1bnRpbWUuV3JhcHBlcgBnZXRf
c3RyU291cmNlQ29kZWZyb21tYXN0ZXIAc2V0X3N0clNvdXJjZUNvZGVmcm9tbWFzdGVyAC5jdG9y
AC5jY3RvcgBTeXN0ZW0uRGlhZ25vc3RpY3MAU3lzdGVtLlJ1bnRpbWUuQ29tcGlsZXJTZXJ2aWNl
cwBTeXN0ZW0uUmVzb3VyY2VzAFNDXzg0NzExMTNhODg4MjQ5OWJiOTQ5ZDgxOGRhMjU0Njk5LlBy
b3BlcnRpZXMuUmVzb3VyY2VzLnJlc291cmNlcwBEZWJ1Z2dpbmdNb2RlcwBTQ184NDcxMTEzYTg4
ODI0OTliYjk0OWQ4MThkYTI1NDY5OS5Qcm9wZXJ0aWVzAGdldF9SZWFkV3JpdGVWYXJpYWJsZXMA
QnVmZmVyQ29sdW1uSW5kZXhlcwBHZXRDb2x1bW5JbmRleGVzAFNldHRpbmdzAEVxdWFscwBDb25u
ZWN0aW9ucwBDb25jYXQAT2JqZWN0AEVuZE9mUm93c2V0AGdldF9EZWZhdWx0AFVzZXJDb21wb25l
bnQAUGFyZW50Q29tcG9uZW50AFNjcmlwdENvbXBvbmVudABNaWNyb3NvZnQuU3FsU2VydmVyLlR4
U2NyaXB0AE1pY3Jvc29mdC5TcWxTZXJ2ZXIuUGlwZWxpbmVIb3N0AElucHV0MF9Qcm9jZXNzSW5w
dXQAR2V0VmFsdWVXaXRoQ29udGV4dABTY3JpcHRDb21wb25lbnRFdmFsQ29udGV4dABnZXRfRXZh
bHVhdG9yQ29udGV4dABJbnB1dDBfUHJvY2Vzc0lucHV0Um93AE5leHRSb3cAZ2V0X0Fzc2VtYmx5
AAAAAQADJwABBScALAABD0kAbgBwAHUAdAAgADAAADVzAHQAcgBTAG8AdQByAGMAZQBfAEMAbwBk
AGUAXwBmAHIAbwBtAF8AbQBhAHMAdABlAHIAAHFTAEMAXwA4ADQANwAxADEAMQAzAGEAOAA4ADgA
MgA0ADkAOQBiAGIAOQA0ADkAZAA4ADEAOABkAGEAMgA1ADQANgA5ADkALgBQAHIAbwBwAGUAcgB0
AGkAZQBzAC4AUgBlAHMAbwB1AHIAYwBlAHMAAAAAADEjlaGNzVVPk3QFJk03F4gABCABAQgDIAAB
BSABARERBCABAQ4FIAEBEVkDIAAOBwAEDg4ODg4DIAAIBSACDggICSADARI9HQgSQQMGEj0DBh0I
BCABDggEIAECCAMgAAIGIAICDhFtBSABHQgIBCAAEnEFIAESdRwEAAASeQUgARwSfQQgAQEcCAAB
EoCBEYCFBSAAEoCJByACAQ4SgIkIt3pcVhk04IkIiYRdzYCAzJECBg4DBhIUAwYSGAMGEkUDBhJR
AwYSVQMGEiAFIAEBEgwJIAQBCA4SPRJBBSABARJFBAAAElEEAAASVQUAAQESVQQAABIgAwAAAQMo
AA4DKAACBAgAElEECAASVQQIABIgCAEACAAAAAAAHgEAAQBUAhZXcmFwTm9uRXhjZXB0aW9uVGhy
b3dzAQgBAAIAAAAAACgBACNTQ184NDcxMTEzYTg4ODI0OTliYjk0OWQ4MThkYTI1NDY5OQAABQEA
AAAAHAEAF0hld2xldHQtUGFja2FyZCBDb21wYW55AAAtAQAoQ29weXJpZ2h0IEAgSGV3bGV0dC1Q
YWNrYXJkIENvbXBhbnkgMjAxOAAASQEAGi5ORVRGcmFtZXdvcmssVmVyc2lvbj12NC43AQBUDhRG
cmFtZXdvcmtEaXNwbGF5TmFtZRIuTkVUIEZyYW1ld29yayA0LjcEAQAAAAAAALQAAADOyu++AQAA
AJEAAABsU3lzdGVtLlJlc291cmNlcy5SZXNvdXJjZVJlYWRlciwgbXNjb3JsaWIsIFZlcnNpb249
NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5
I1N5c3RlbS5SZXNvdXJjZXMuUnVudGltZVJlc291cmNlU2V0AgAAAAAAAAAAAAAAUEFEUEFEULQA
AAAYMwAAAAAAAAAAAAAyMwAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJDMAAAAAAAAAAAAAAABf
Q29yRGxsTWFpbgBtc2NvcmVlLmRsbAAAAAAA/yUAIAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAQAQAAAAGAAAgAAAAAAAAAAAAAAAAAAAAQABAAAAMAAAgAAAAAAAAAAAAAAAAAAAAQAAAAAA
SAAAAFhAAABIBAAAAAAAAAAAAABIBDQAAABWAFMAXwBWAEUAUgBTAEkATwBOAF8ASQBOAEYATwAA
AAAAvQTv/gAAAQAAAAEAAAAAAAAAAQAAAAAAPwAAAAAAAAAEAAAAAgAAAAAAAAAAAAAAAAAAAEQA
AAABAFYAYQByAEYAaQBsAGUASQBuAGYAbwAAAAAAJAAEAAAAVAByAGEAbgBzAGwAYQB0AGkAbwBu
AAAAAAAAALAEqAMAAAEAUwB0AHIAaQBuAGcARgBpAGwAZQBJAG4AZgBvAAAAhAMAAAEAMAAwADAA
MAAwADQAYgAwAAAAGgABAAEAQwBvAG0AbQBlAG4AdABzAAAAAAAAAFAAGAABAEMAbwBtAHAAYQBu
AHkATgBhAG0AZQAAAAAASABlAHcAbABlAHQAdAAtAFAAYQBjAGsAYQByAGQAIABDAG8AbQBwAGEA
bgB5AAAAcAAkAAEARgBpAGwAZQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4AAAAAAFMAQwBfADgANAA3
ADEAMQAxADMAYQA4ADgAOAAyADQAOQA5AGIAYgA5ADQAOQBkADgAMQA4AGQAYQAyADUANAA2ADkA
OQAAADAACAABAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAAAAAAMQAuADAALgAwAC4AMAAAAHAAKAAB
AEkAbgB0AGUAcgBuAGEAbABOAGEAbQBlAAAAUwBDAF8AOAA0ADcAMQAxADEAMwBhADgAOAA4ADIA
NAA5ADkAYgBiADkANAA5AGQAOAAxADgAZABhADIANQA0ADYAOQA5AC4AZABsAGwAAAB2ACkAAQBM
AGUAZwBhAGwAQwBvAHAAeQByAGkAZwBoAHQAAABDAG8AcAB5AHIAaQBnAGgAdAAgAEAAIABIAGUA
dwBsAGUAdAB0AC0AUABhAGMAawBhAHIAZAAgAEMAbwBtAHAAYQBuAHkAIAAyADAAMQA4AAAAAAAq
AAEAAQBMAGUAZwBhAGwAVAByAGEAZABlAG0AYQByAGsAcwAAAAAAAAAAAHgAKAABAE8AcgBpAGcA
aQBuAGEAbABGAGkAbABlAG4AYQBtAGUAAABTAEMAXwA4ADQANwAxADEAMQAzAGEAOAA4ADgAMgA0
ADkAOQBiAGIAOQA0ADkAZAA4ADEAOABkAGEAMgA1ADQANgA5ADkALgBkAGwAbAAAAGgAJAABAFAA
cgBvAGQAdQBjAHQATgBhAG0AZQAAAAAAUwBDAF8AOAA0ADcAMQAxADEAMwBhADgAOAA4ADIANAA5
ADkAYgBiADkANAA5AGQAOAAxADgAZABhADIANQA0ADYAOQA5AAAANAAIAAEAUAByAG8AZAB1AGMA
dABWAGUAcgBzAGkAbwBuAAAAMQAuADAALgAwAC4AMAAAADgACAABAEEAcwBzAGUAbQBiAGwAeQAg
AFYAZQByAHMAaQBvAG4AAAAxAC4AMAAuADAALgAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAMAAAARDMAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA]]></arrayElement>
                          </arrayElements>
                        </property>
                        <property
                          dataType="System.String"
                          description="Specifies the name of the Microsoft Visual Studio Tools for Applications project. Project names must be unique within a package."
                          name="VSTAProjectName"
                          typeConverter="NOTBROWSABLE">SC_8471113a8882499bb949d818da254699</property>
                        <property
                          dataType="System.String"
                          description="Specifies the programming language used by the script."
                          name="ScriptLanguage"
                          typeConverter="Microsoft.SqlServer.VSTAHosting.ScriptingLanguages">CSharp</property>
                        <property
                          dataType="System.String"
                          description="Specifies a comma-separated list of read-only variables."
                          name="ReadOnlyVariables"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ScriptUIVariablePickerDlg"></property>
                        <property
                          dataType="System.String"
                          description="Specifies a comma-separated list of read/write variables."
                          name="ReadWriteVariables"
                          UITypeEditor="Microsoft.DataTransformationServices.Controls.ScriptUIWriteableVariablePickerDlg">User::strSource_Code_from_master</property>
                        <property
                          dataType="System.String"
                          description="List of breakpoints present on the script."
                          isArray="true"
                          name="BreakpointCollection"
                          typeConverter="NOTBROWSABLE">
                          <arrayElements
                            arrayElementCount="0" />
                        </property>
                        <property
                          dataType="System.String"
                          description="Checksum to match component metedata against compiled codes."
                          name="MetadataChecksum"
                          typeConverter="NOTBROWSABLE">07d53d7875149066e4582bea78aa209a</property>
                        <property
                          dataType="System.String"
                          description="Checksum to match component metedata against compiled codes."
                          name="MetadataShaChecksum"
                          typeConverter="NOTBROWSABLE">f6734feebdba6f99f2ccc1aa9825e079ff11ebbc</property>
                        <property
                          dataType="System.String"
                          name="UserComponentTypeName">Microsoft.ScriptComponentHost</property>
                        <property
                          dataType="System.String"
                          description="Checksum to match component metedata against compiled codes."
                          name="MetadataChecksum140"
                          typeConverter="NOTBROWSABLE">1C</property>
                      </properties>
                      <inputs>
                        <input
                          refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes to variable.Inputs[Input 0]"
                          hasSideEffects="true"
                          name="Input 0">
                          <inputColumns>
                            <inputColumn
                              refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes to variable.Inputs[Input 0].Columns[source_code]"
                              cachedDataType="wstr"
                              cachedLength="400"
                              cachedName="source_code"
                              lineageId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Output].Columns[source_code]" />
                          </inputColumns>
                          <externalMetadataColumns />
                        </input>
                      </inputs>
                    </component>
                  </components>
                  <paths>
                    <path
                      refId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster.Paths[OLE DB Source Output]"
                      endId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes to variable.Inputs[Input 0]"
                      name="OLE DB Source Output"
                      startId="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster.Outputs[OLE DB Source Output]" />
                  </paths>
                </pipeline>
              </DTS:ObjectData>
            </DTS:Executable>
          </DTS:Executables>
          <DTS:PrecedenceConstraints>
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint]"
              DTS:CreationName=""
              DTS:DTSID="{8C03F6B0-E3A6-4CD7-9F0A-A75F84F2A3B5}"
              DTS:From="Package\Sequence Container\Sequence Container\Get Current Reporting Month"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint"
              DTS:To="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint 1]"
              DTS:CreationName=""
              DTS:DTSID="{7DD4D65F-1F5D-4449-B293-BD675F7DA01E}"
              DTS:From="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 1"
              DTS:To="Package\Sequence Container\Sequence Container\Archive existing Visits" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint 2]"
              DTS:CreationName=""
              DTS:DTSID="{955104C2-1FDC-4798-ACDB-8FD74C08D49F}"
              DTS:From="Package\Sequence Container\Sequence Container\Delete tblDBWSLoungeVisits"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 2"
              DTS:To="Package\Sequence Container\Sequence Container\Populate dbwsvisitsbysource" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint 3]"
              DTS:CreationName=""
              DTS:DTSID="{4E5BC750-1A38-4178-8E13-1F697DE8ED9B}"
              DTS:From="Package\Sequence Container\Sequence Container\Archive existing Visits"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 3"
              DTS:To="Package\Sequence Container\Sequence Container\Delete tblDBWSLoungeVisits" />
            <DTS:PrecedenceConstraint
              DTS:refId="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint 4]"
              DTS:CreationName=""
              DTS:DTSID="{4046BD11-BEAF-4313-A9F9-CA5651E4DFE7}"
              DTS:From="Package\Sequence Container\Sequence Container\Populate dbwsvisitsbysource"
              DTS:LogicalAnd="True"
              DTS:ObjectName="Constraint 4"
              DTS:To="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits" />
          </DTS:PrecedenceConstraints>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package\Sequence Container\Workflow Control"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{B3BE13A7-B24D-4073-A345-611C90DF161D}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Workflow Control"
          DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
          DTS:ThreadHint="0">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{7E223649-2142-4D1E-B44E-5D4EF88BC859}"
              SQLTask:SqlStatementSource="SELECT COUNT(1) AS re_run_marker FROM [config].[tblSourceCodeReRun]&#xA; WHERE deal_type = 'DBWS'"
              SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ResultBinding
                SQLTask:ResultName="0"
                SQLTask:DtsVariableName="User::Int_EnableWorkflow" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package\Sequence Container.PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{7812B7FE-45DE-4B9E-8239-6D27E1B1C697}"
          DTS:From="Package\Sequence Container\Workflow Control"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package\Sequence Container\Sequence Container" />
      </DTS:PrecedenceConstraints>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Set up configuration variables"
      DTS:CreationName="Microsoft.ScriptTask"
      DTS:Description="Script Task"
      DTS:DTSID="{A69EFAE1-30CA-4F05-94CF-F3EBE1E5E148}"
      DTS:ExecutableType="Microsoft.ScriptTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set up configuration variables"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ScriptProject
          Name="ST_c61a8384d92948f6909a5d9680009df3"
          VSTAMajorVersion="14"
          VSTAMinorVersion="0"
          Language="CSharp"
          ReadOnlyVariables="User::rsWorkflowStep_Configuration,$Package::int_DataloadWorkFlowID"
          ReadWriteVariables="User::intApplicationDataloadWorkflowID,User::intDataLoadID,User::intDebug,User::strArchiveFileNameFormat,User::strBody,User::strCorruptFolder,User::strDestinationFolder,User::strFileName_Format_Export,User::strFileName_Format_Import,User::strFromEmail,User::strProcessUnknownFile,User::strSourceFolder,User::strStoredProcedureName,User::strSubject,User::strToEmail,User::strUnknownFolder">
          <ProjectItem
            Name="Properties\Settings.settings"
            Encoding="UTF8"><![CDATA[<?xml version='1.0' encoding='iso-8859-1'?>
<SettingsFile xmlns="uri:settings" CurrentProfile="(Default)">
  <Profiles>
    <Profile Name="(Default)" />
  </Profiles>
  <Settings />
</SettingsFile>]]></ProjectItem>
          <ProjectItem
            Name="Properties\Resources.resx"
            Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<root>
  <!-- 
    Microsoft ResX Schema 
    
    Version 2.0
    
    The primary goals of this format is to allow a simple XML format 
    that is mostly human readable. The generation and parsing of the 
    various data types are done through the TypeConverter classes 
    associated with the data types.
    
    Example:
    
    ... ado.net/XML headers & schema ...
    <resheader name="resmimetype">text/microsoft-resx</resheader>
    <resheader name="version">2.0</resheader>
    <resheader name="reader">System.Resources.ResXResourceReader, System.Windows.Forms, ...</resheader>
    <resheader name="writer">System.Resources.ResXResourceWriter, System.Windows.Forms, ...</resheader>
    <data name="Name1"><value>this is my long string</value><comment>this is a comment</comment></data>
    <data name="Color1" type="System.Drawing.Color, System.Drawing">Blue</data>
    <data name="Bitmap1" mimetype="application/x-microsoft.net.object.binary.base64">
        <value>[base64 mime encoded serialized .NET Framework object]</value>
    </data>
    <data name="Icon1" type="System.Drawing.Icon, System.Drawing" mimetype="application/x-microsoft.net.object.bytearray.base64">
        <value>[base64 mime encoded string representing a byte array form of the .NET Framework object]</value>
        <comment>This is a comment</comment>
    </data>
                
    There are any number of "resheader" rows that contain simple 
    name/value pairs.
    
    Each data row contains a name, and value. The row also contains a 
    type or mimetype. Type corresponds to a .NET class that support 
    text/value conversion through the TypeConverter architecture. 
    Classes that don't support this are serialized and stored with the 
    mimetype set.
    
    The mimetype is used for serialized objects, and tells the 
    ResXResourceReader how to depersist the object. This is currently not 
    extensible. For a given mimetype the value must be set accordingly:
    
    Note - application/x-microsoft.net.object.binary.base64 is the format 
    that the ResXResourceWriter will generate, however the reader can 
    read any of the formats listed below.
    
    mimetype: application/x-microsoft.net.object.binary.base64
    value   : The object must be serialized with 
            : System.Serialization.Formatters.Binary.BinaryFormatter
            : and then encoded with base64 encoding.
    
    mimetype: application/x-microsoft.net.object.soap.base64
    value   : The object must be serialized with 
            : System.Runtime.Serialization.Formatters.Soap.SoapFormatter
            : and then encoded with base64 encoding.

    mimetype: application/x-microsoft.net.object.bytearray.base64
    value   : The object must be serialized into a byte array 
            : using a System.ComponentModel.TypeConverter
            : and then encoded with base64 encoding.
    -->
  <xsd:schema id="root" xmlns="" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata">
    <xsd:element name="root" msdata:IsDataSet="true">
      <xsd:complexType>
        <xsd:choice maxOccurs="unbounded">
          <xsd:element name="metadata">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" />
              <xsd:attribute name="type" type="xsd:string" />
              <xsd:attribute name="mimetype" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="assembly">
            <xsd:complexType>
              <xsd:attribute name="alias" type="xsd:string" />
              <xsd:attribute name="name" type="xsd:string" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="data">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
                <xsd:element name="comment" type="xsd:string" minOccurs="0" msdata:Ordinal="2" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" msdata:Ordinal="1" />
              <xsd:attribute name="type" type="xsd:string" msdata:Ordinal="3" />
              <xsd:attribute name="mimetype" type="xsd:string" msdata:Ordinal="4" />
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="resheader">
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="value" type="xsd:string" minOccurs="0" msdata:Ordinal="1" />
              </xsd:sequence>
              <xsd:attribute name="name" type="xsd:string" use="required" />
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
      </xsd:complexType>
    </xsd:element>
  </xsd:schema>
  <resheader name="resmimetype">
    <value>text/microsoft-resx</value>
  </resheader>
  <resheader name="version">
    <value>2.0</value>
  </resheader>
  <resheader name="reader">
    <value>System.Resources.ResXResourceReader, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
  <resheader name="writer">
    <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
  </resheader>
</root>]]></ProjectItem>
          <ProjectItem
            Name="ScriptMain.cs"
            Encoding="UTF8"><![CDATA[#region Help:  Introduction to the script task
/* The Script Task allows you to perform virtually any operation that can be accomplished in
 * a .Net application within the context of an Integration Services control flow. 
 * 
 * Expand the other regions which have "Help" prefixes for examples of specific ways to use
 * Integration Services features within this script task. */
#endregion


#region Namespaces
using System;
using System.Data;
using System.Data.OleDb;
using Microsoft.SqlServer.Dts.Runtime;
using System.Windows.Forms;
using System.Xml;
#endregion

namespace ST_c61a8384d92948f6909a5d9680009df3
{
    /// <summary>
    /// ScriptMain is the entry point class of the script.  Do not change the name, attributes,
    /// or parent of this class.
    /// </summary>
	[Microsoft.SqlServer.Dts.Tasks.ScriptTask.SSISScriptTaskEntryPointAttribute]
	public partial class ScriptMain : Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTARTScriptObjectModelBase
	{
        #region Help:  Using Integration Services variables and parameters in a script
        /* To use a variable in this script, first ensure that the variable has been added to 
         * either the list contained in the ReadOnlyVariables property or the list contained in 
         * the ReadWriteVariables property of this script task, according to whether or not your
         * code needs to write to the variable.  To add the variable, save this script, close this instance of
         * Visual Studio, and update the ReadOnlyVariables and 
         * ReadWriteVariables properties in the Script Transformation Editor window.
         * To use a parameter in this script, follow the same steps. Parameters are always read-only.
         * 
         * Example of reading from a variable:
         *  DateTime startTime = (DateTime) Dts.Variables["System::StartTime"].Value;
         * 
         * Example of writing to a variable:
         *  Dts.Variables["User::myStringVariable"].Value = "new value";
         * 
         * Example of reading from a package parameter:
         *  int batchId = (int) Dts.Variables["$Package::batchId"].Value;
         *  
         * Example of reading from a project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].Value;
         * 
         * Example of reading from a sensitive project parameter:
         *  int batchId = (int) Dts.Variables["$Project::batchId"].GetSensitiveValue();
         * */

        #endregion

        #region Help:  Firing Integration Services events from a script
        /* This script task can fire events for logging purposes.
         * 
         * Example of firing an error event:
         *  Dts.Events.FireError(18, "Process Values", "Bad value", "", 0);
         * 
         * Example of firing an information event:
         *  Dts.Events.FireInformation(3, "Process Values", "Processing has started", "", 0, ref fireAgain)
         * 
         * Example of firing a warning event:
         *  Dts.Events.FireWarning(14, "Process Values", "No values received for input", "", 0);
         * */
        #endregion

        #region Help:  Using Integration Services connection managers in a script
        /* Some types of connection managers can be used in this script task.  See the topic 
         * "Working with Connection Managers Programatically" for details.
         * 
         * Example of using an ADO.Net connection manager:
         *  object rawConnection = Dts.Connections["Sales DB"].AcquireConnection(Dts.Transaction);
         *  SqlConnection myADONETConnection = (SqlConnection)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Sales DB"].ReleaseConnection(rawConnection);
         *
         * Example of using a File connection manager
         *  object rawConnection = Dts.Connections["Prices.zip"].AcquireConnection(Dts.Transaction);
         *  string filePath = (string)rawConnection;
         *  //Use the connection in some code here, then release the connection
         *  Dts.Connections["Prices.zip"].ReleaseConnection(rawConnection);
         * */
        #endregion


		/// <summary>
        /// This method is called when this script task executes in the control flow.
        /// Before returning from this method, set the value of Dts.TaskResult to indicate success or failure.
        /// To open Help, press F1.
        /// </summary>
		public void Main()
		{
            /*
             * Configuration variables
            //====== Read only variables =========//
            * User::rsWorkflowStep_Configuration
            * $Package::int_DataloadWorkFlowID
            //====== Read and write variables =========//
            * User::intApplicationDataloadWorkflowID
            * User::intDataLoadID
            * User::strArchiveFileNameFormat
            * User::strBody
            * User::strCorruptFolder
            * User::strDestinationFolder
            * User::strFileName_Format_Import
            * User::strFileName_Format_Export
            * User::strFromEmail
            * User::strProcessUnknownFile
            * User::strSourceFolder
            * User::strStoredProcedureName
            * User::strSubject
            * User::strToEmail
            * User::strUnknownFolder
            */
            // TODO: Add your code here


            // define oledb adapter
            OleDbDataAdapter oleDA_wrkflwStpConfig = new OleDbDataAdapter();
            // define data table to hold the values
            DataTable dt_wrkflwStpConfig = new DataTable();
            // define DataRow
            DataRow dr_wrkflwStpConfig = null;

            // polulate ther table 
            oleDA_wrkflwStpConfig.Fill(dt_wrkflwStpConfig, Dts.Variables["rsWorkflowStep_Configuration"].Value);

            foreach (DataRow row_ in dt_wrkflwStpConfig.Rows)
            {
                dr_wrkflwStpConfig = row_;

                Dts.Variables["User::intApplicationDataloadWorkflowID"].Value = Convert.ToInt32(row_["ApplicationDataloadWorkflowID"].ToString());
                Dts.Variables["User::intDataLoadID"].Value = Convert.ToInt32(row_["DataLoadID"].ToString());
                Dts.Variables["strArchiveFileNameFormat"].Value =  Convert.ToString(row_["ArchiveFileNameFormat"].ToString());
                Dts.Variables["strBody"].Value = Convert.ToString(row_["Body"].ToString());
                Dts.Variables["strCorruptFolder"].Value = Convert.ToString(row_["CorruptFolder"].ToString()); 
                Dts.Variables["strDestinationFolder"].Value = Convert.ToString(row_["DestinationFolder"].ToString());
                Dts.Variables["strFileName_Format_Import"].Value = Convert.ToString(row_["FileName_Format_Import"].ToString());
                Dts.Variables["strFileName_Format_Export"].Value = Convert.ToString(row_["FileName_Format_Export"].ToString());
                Dts.Variables["strFromEmail"].Value = Convert.ToString(row_["FromEmail"].ToString());
                Dts.Variables["strProcessUnknownFile"].Value = Convert.ToString(row_["ProcessUnknownFile"].ToString());
                Dts.Variables["strSourceFolder"].Value = Convert.ToString(row_["SourceFolder"].ToString());
                Dts.Variables["strStoredProcedureName"].Value = Convert.ToString(row_["StoredProcedureName"].ToString());
                Dts.Variables["strSubject"].Value = Convert.ToString(row_["Subject"].ToString());
                Dts.Variables["strToEmail"].Value = Convert.ToString(row_["ToEmail"].ToString());
                Dts.Variables["strUnknownFolder"].Value = Convert.ToString(row_["UnknownFolder"].ToString());

            }

            int intdebug;
            intdebug = Convert.ToInt32(Dts.Variables["intDebug"].Value);

            if (intdebug == 1)
            {
                MessageBox.Show(
                            " int_DataloadWorkFlowID :" + Convert.ToString(Dts.Variables["int_DataloadWorkFlowID"].Value)
                            + Environment.NewLine
                            + "ApplicationDataloadWorkflowID :" + Dts.Variables["User::intApplicationDataloadWorkflowID"].Value
                            + Environment.NewLine
                            + "intDataLoadID :" + Dts.Variables["User::intDataLoadID"].Value
                            +Environment.NewLine
                            + "strArchiveFileNameFormat :" + Dts.Variables["strArchiveFileNameFormat"].Value 
                            +Environment.NewLine
                            + "strBody :" + Dts.Variables["strBody"].Value
                            +Environment.NewLine
                            + "strCorruptFolder :" + Dts.Variables["strCorruptFolder"].Value
                            +Environment.NewLine
                            + "strDestinationFolder :" + Dts.Variables["strDestinationFolder"].Value
                            +Environment.NewLine
                            + "strFileName_Format_Import :" + Dts.Variables["strFileName_Format_Import"].Value
                            + Environment.NewLine
                            + "strFileName_Format_Export :" + Dts.Variables["strFileName_Format_Export"].Value
                            + Environment.NewLine
                            + "strFromEmail :" + Dts.Variables["strFromEmail"].Value
                            +Environment.NewLine
                            + "strProcessUnknownFile :" + Dts.Variables["strProcessUnknownFile"].Value
                            +Environment.NewLine
                            + "strSourceFolder :" + Dts.Variables["strSourceFolder"].Value
                            +Environment.NewLine
                            + "strStoredProcedureName :" + Dts.Variables["strStoredProcedureName"].Value
                            +Environment.NewLine
                            + "strSubject :" + Dts.Variables["strSubject"].Value
                            +Environment.NewLine
                            + "strToEmail :" + Dts.Variables["strToEmail"].Value
                            +Environment.NewLine
                            + "strUnknownFolder :" + Dts.Variables["strUnknownFolder"].Value
                            +Environment.NewLine
                    );

            };


         
        Dts.TaskResult = (int)ScriptResults.Success;
		}

        private static string getString(object o)
        {
            if (o == DBNull.Value) return "";
            return (string)o;
        }

        #region ScriptResults declaration
        /// <summary>
        /// This enum provides a convenient shorthand within the scope of this class for setting the
        /// result of the script.
        /// 
        /// This code was generated automatically.
        /// </summary>
        enum ScriptResults
        {
            Success = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Success,
            Failure = Microsoft.SqlServer.Dts.Runtime.DTSExecResult.Failure
        };
        #endregion

	}
}]]></ProjectItem>
          <ProjectItem
            Name="ST_c61a8384d92948f6909a5d9680009df3.csproj"
            Encoding="UTF8"><![CDATA[<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <ProjectTypeGuids>{30D016F9-3734-4E33-A861-5E7D899E18F3};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}</ProjectTypeGuids>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{76e995d4-be46-402d-bd21-8eacd6b2edea}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>ST_c61a8384d92948f6909a5d9680009df3</RootNamespace>
    <AssemblyName>ST_c61a8384d92948f6909a5d9680009df3</AssemblyName>
    <TargetFrameworkVersion>v4.7</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
    <ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>true</ResolveAssemblyReferenceIgnoreTargetFrameworkAttributeVersionMismatch>
    <TargetFrameworkProfile></TargetFrameworkProfile>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Debug' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>.\bin\Debug\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <DebugSymbols>false</DebugSymbols>
    <Optimize>true</Optimize>
    <OutputPath>.\bin\Release\</OutputPath>
    <EnableUnmanagedDebugging>false</EnableUnmanagedDebugging>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Data" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <Reference Include="Microsoft.SqlServer.ManagedDTS, Version=13.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
    <Reference Include="Microsoft.SqlServer.ScriptTask, Version=13.0.0.0, Culture=Neutral, PublicKeyToken=89845dcd8080cc91" />
  </ItemGroup>
  <ItemGroup>
    <AppDesigner Include="Properties\" />
    <Compile Include="Properties\AssemblyInfo.cs">
      <SubType>Code</SubType>
    </Compile>
    <EmbeddedResource Include="Properties\Resources.resx">
      <Generator>ResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.cs</LastGenOutput>
    </EmbeddedResource>
    <Compile Include="Properties\Resources.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <None Include="Properties\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <LastGenOutput>Settings.Designer.cs</LastGenOutput>
    </None>
    <Compile Include="Properties\Settings.Designer.cs">
      <AutoGen>True</AutoGen>
      <DependentUpon>Settings.settings</DependentUpon>
    </Compile>
    <Compile Include="ScriptMain.cs">
      <SubType>Code</SubType>
    </Compile>
  </ItemGroup>
  <!-- Include the build rules for a C# project.-->
  <Import Project="$(MSBuildBinPath)\Microsoft.CSharp.targets" />
  <ProjectExtensions>
    <VisualStudio>
      <FlavorProperties GUID="{30D016F9-3734-4E33-A861-5E7D899E18F3}">
        <ProjectProperties HostName="ScriptTask" HostPackage="{B3A685AA-7EAF-4BC6-9940-57959FA5AC07}" ApplicationType="usd" Language="cs" TemplatesPath="" DebugInfoCommandLine="" DebugInfoWorkingDir="" IconImageList="" />
        <Host Name="ScriptTask" GeneratedNamespace="$safeprojectname" IconIndex=""></Host>
        <ProjectClient>
          <HostIdentifier>SSIS_ST130</HostIdentifier>
        </ProjectClient>
      </FlavorProperties>
    </VisualStudio>
  </ProjectExtensions>
</Project>]]></ProjectItem>
          <ProjectItem
            Name="Project"
            Encoding="UTF16LE"><![CDATA[<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<c:Project xmlns:c="http://schemas.microsoft.com/codeprojectml/2010/08/main" xmlns:msb="http://schemas.microsoft.com/developer/msbuild/2003" runtimeVersion="4.0" schemaVersion="1.0">
	<msb:PropertyGroup>
		<msb:Language>msBuild</msb:Language>
		<msb:CodeName>ST_c61a8384d92948f6909a5d9680009df3</msb:CodeName>
		<msb:DisplayName>ST_c61a8384d92948f6909a5d9680009df3</msb:DisplayName>
		<msb:ProjectId>{1A668AAE-774D-42B0-94F9-8170DEEB6993}</msb:ProjectId>
	</msb:PropertyGroup>
	<msb:ItemGroup>
		<msb:Project Include="ST_c61a8384d92948f6909a5d9680009df3.csproj"/>
		<msb:File Include="Properties\Resources.Designer.cs"/>
		<msb:File Include="Properties\AssemblyInfo.cs"/>
		<msb:File Include="Properties\Settings.settings"/>
		<msb:File Include="Properties\Resources.resx"/>
		<msb:File Include="Properties\Settings.Designer.cs"/>
		<msb:File Include="ScriptMain.cs"/>
	</msb:ItemGroup>
</c:Project>]]></ProjectItem>
          <ProjectItem
            Name="Properties\Settings.Designer.cs"
            Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_c61a8384d92948f6909a5d9680009df3.Properties.Settings.get_Default():ST_c61a8384d92948f6909a5d9680009df3.Properties.Sett" +
    "ings")]

namespace ST_c61a8384d92948f6909a5d9680009df3.Properties {
    
    
    internal sealed partial class Settings : global::System.Configuration.ApplicationSettingsBase {
        
        [global::System.Runtime.CompilerServices.CompilerGeneratedAttribute()]
        private static Settings defaultInstance = new Settings();
        
        public static Settings Default {
            get {
                return defaultInstance;
            }
        }
    }
}]]></ProjectItem>
          <ProjectItem
            Name="Properties\AssemblyInfo.cs"
            Encoding="UTF8"><![CDATA[using System.Reflection;
using System.Runtime.CompilerServices;

//
// General Information about an assembly is controlled through the following 
// set of attributes. Change these attribute values to modify the information
// associated with an assembly.
//
[assembly: AssemblyTitle("ST_c61a8384d92948f6909a5d9680009df3")]
[assembly: AssemblyDescription("")]
[assembly: AssemblyConfiguration("")]
[assembly: AssemblyCompany("Microsoft")]
[assembly: AssemblyProduct("ST_c61a8384d92948f6909a5d9680009df3")]
[assembly: AssemblyCopyright("Copyright @ Microsoft 2017")]
[assembly: AssemblyTrademark("")]
[assembly: AssemblyCulture("")]
//
// Version information for an assembly consists of the following four values:
//
//      Major Version
//      Minor Version 
//      Build Number
//      Revision
//
// You can specify all the values or you can default the Revision and Build Numbers 
// by using the '*' as shown below:

[assembly: AssemblyVersion("1.0.*")]]]></ProjectItem>
          <ProjectItem
            Name="Properties\Resources.Designer.cs"
            Encoding="UTF8"><![CDATA[//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_c61a8384d92948f6909a5d9680009df3.Properties.Resources.get_ResourceManager():System.Resources.Resou" +
    "rceManager")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_c61a8384d92948f6909a5d9680009df3.Properties.Resources.get_Culture():System.Globalization.CultureIn" +
    "fo")]
[assembly: global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode", Scope="member", Target="ST_c61a8384d92948f6909a5d9680009df3.Properties.Resources.set_Culture(System.Globalization.CultureInfo" +
    "):Void")]

namespace ST_c61a8384d92948f6909a5d9680009df3.Properties {
    
    
    /// <summary>
    ///   A strongly-typed resource class, for looking up localized strings, etc.
    /// </summary>
    // This class was auto-generated by the StronglyTypedResourceBuilder
    // class via a tool like ResGen or Visual Studio.
    // To add or remove a member, edit your .ResX file then rerun ResGen
    // with the /str option, or rebuild your VS project.
    [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
    internal class Resources {
        
        private static global::System.Resources.ResourceManager resourceMan;
        
        private static global::System.Globalization.CultureInfo resourceCulture;
        
        [global::System.Diagnostics.CodeAnalysis.SuppressMessageAttribute("Microsoft.Performance", "CA1811:AvoidUncalledPrivateCode")]
        internal Resources() {
        }
        
        /// <summary>
        ///   Returns the cached ResourceManager instance used by this class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Resources.ResourceManager ResourceManager {
            get {
                if ((resourceMan == null)) {
                    global::System.Resources.ResourceManager temp = new global::System.Resources.ResourceManager("ST_c61a8384d92948f6909a5d9680009df3.Properties.Resources", typeof(Resources).Assembly);
                    resourceMan = temp;
                }
                return resourceMan;
            }
        }
        
        /// <summary>
        ///   Overrides the current thread's CurrentUICulture property for all
        ///   resource lookups using this strongly typed resource class.
        /// </summary>
        [global::System.ComponentModel.EditorBrowsableAttribute(System.ComponentModel.EditorBrowsableState.Advanced)]
        internal static global::System.Globalization.CultureInfo Culture {
            get {
                return resourceCulture;
            }
            set {
                resourceCulture = value;
            }
        }
    }
}]]></ProjectItem>
          <BinaryItem
            Name="ST_c61a8384d92948f6909a5d9680009df3.dll">TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1v
ZGUuDQ0KJAAAAAAAAABQRQAATAEDAEYQcWIAAAAAAAAAAOAAIiALATAAAB4AAAAIAAAAAAAA3j0A
AAAgAAAAQAAAAAAAEAAgAAAAAgAABAAAAAAAAAAGAAAAAAAAAACAAAAAAgAAAAAAAAMAYIUAABAA
ABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAIw9AABPAAAAAEAAAJwEAAAAAAAAAAAAAAAAAAAA
AAAAAGAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAIAAACAAAAAAAAAAAAAAACCAAAEgAAAAAAAAAAAAAAC50ZXh0AAAA5B0AAAAgAAAAHgAAAAIA
AAAAAAAAAAAAAAAAACAAAGAucnNyYwAAAJwEAAAAQAAAAAYAAAAgAAAAAAAAAAAAAAAAAABAAABA
LnJlbG9jAAAMAAAAAGAAAAACAAAAJgAAAAAAAAAAAAAAAAAAQAAAQgAAAAAAAAAAAAAAAAAAAADA
PQAAAAAAAEgAAAACAAUAaCcAAGwVAAABAAAAAAAAANQ8AAC4AAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAABswBQByBgAAAQAAEXMQAAAKcxEAAAoKBgIoEgAACm8TAAAK
cgEAAHBvFAAACm8VAAAKbxYAAAomBm8XAAAKbxgAAAoLONcCAAAHbxkAAAp0EQAAAQwCKBIAAApv
EwAACnI7AABwbxQAAAoIcokAAHBvGgAACm8bAAAKKBwAAAqMIwAAAW8dAAAKAigSAAAKbxMAAApy
xQAAcG8UAAAKCHLtAABwbxoAAApvGwAACigcAAAKjCMAAAFvHQAACgIoEgAACm8TAAAKcgMBAHBv
FAAACghyNQEAcG8aAAAKbxsAAAooHgAACm8dAAAKAigSAAAKbxMAAApyYQEAcG8UAAAKCHJxAQBw
bxoAAApvGwAACigeAAAKbx0AAAoCKBIAAApvEwAACnJ7AQBwbxQAAAoIcp0BAHBvGgAACm8bAAAK
KB4AAApvHQAACgIoEgAACm8TAAAKcrkBAHBvFAAACghy4wEAcG8aAAAKbxsAAAooHgAACm8dAAAK
AigSAAAKbxMAAApyBwIAcG8UAAAKCHI7AgBwbxoAAApvGwAACigeAAAKbx0AAAoCKBIAAApvEwAA
CnJpAgBwbxQAAAoIcp0CAHBvGgAACm8bAAAKKB4AAApvHQAACgIoEgAACm8TAAAKcssCAHBvFAAA
Cghy5QIAcG8aAAAKbxsAAAooHgAACm8dAAAKAigSAAAKbxMAAApy+QIAcG8UAAAKCHIlAwBwbxoA
AApvGwAACigeAAAKbx0AAAoCKBIAAApvEwAACnJLAwBwbxQAAAoIcmsDAHBvGgAACm8bAAAKKB4A
AApvHQAACgIoEgAACm8TAAAKcoUDAHBvFAAACghyswMAcG8aAAAKbxsAAAooHgAACm8dAAAKAigS
AAAKbxMAAApy2wMAcG8UAAAKCHLxAwBwbxoAAApvGwAACigeAAAKbx0AAAoCKBIAAApvEwAACnIB
BABwbxQAAAoIchcEAHBvGgAACm8bAAAKKB4AAApvHQAACgIoEgAACm8TAAAKcicEAHBvFAAACghy
SQQAcG8aAAAKbxsAAAooHgAACm8dAAAKB28fAAAKOh79///eEQd1EgAAAQ0JLAYJbyAAAArcAigS
AAAKbxMAAApyZQQAcG8UAAAKbxUAAAooIQAAChdADgMAAB8wjRMAAAElFnJ3BABwoiUXAigSAAAK
bxMAAApyqwQAcG8UAAAKbxUAAAooIgAACqIlGCgjAAAKoiUZctkEAHCiJRoCKBIAAApvEwAACnI7
AABwbxQAAApvFQAACqIlGygjAAAKoiUcchkFAHCiJR0CKBIAAApvEwAACnLFAABwbxQAAApvFQAA
CqIlHigjAAAKoiUfCXI5BQBwoiUfCgIoEgAACm8TAAAKcgMBAHBvFAAACm8VAAAKoiUfCygjAAAK
oiUfDHJvBQBwoiUfDQIoEgAACm8TAAAKcmEBAHBvFAAACm8VAAAKoiUfDigjAAAKoiUfD3KDBQBw
oiUfEAIoEgAACm8TAAAKcnsBAHBvFAAACm8VAAAKoiUfESgjAAAKoiUfEnKpBQBwoiUfEwIoEgAA
Cm8TAAAKcrkBAHBvFAAACm8VAAAKoiUfFCgjAAAKoiUfFXLXBQBwoiUfFgIoEgAACm8TAAAKcgcC
AHBvFAAACm8VAAAKoiUfFygjAAAKoiUfGHIPBgBwoiUfGQIoEgAACm8TAAAKcmkCAHBvFAAACm8V
AAAKoiUfGigjAAAKoiUfG3JHBgBwoiUfHAIoEgAACm8TAAAKcssCAHBvFAAACm8VAAAKoiUfHSgj
AAAKoiUfHnJlBgBwoiUfHwIoEgAACm8TAAAKcvkCAHBvFAAACm8VAAAKoiUfICgjAAAKoiUfIXKV
BgBwoiUfIgIoEgAACm8TAAAKcksDAHBvFAAACm8VAAAKoiUfIygjAAAKoiUfJHK5BgBwoiUfJQIo
EgAACm8TAAAKcoUDAHBvFAAACm8VAAAKoiUfJigjAAAKoiUfJ3LrBgBwoiUfKAIoEgAACm8TAAAK
ctsDAHBvFAAACm8VAAAKoiUfKSgjAAAKoiUfKnIFBwBwoiUfKwIoEgAACm8TAAAKcgEEAHBvFAAA
Cm8VAAAKoiUfLCgjAAAKoiUfLXIfBwBwoiUfLgIoEgAACm8TAAAKcicEAHBvFAAACm8VAAAKoiUf
LygjAAAKoigkAAAKKCUAAAomAigSAAAKFm8mAAAKKgAAQRwAAAIAAAA4AAAA6QIAACEDAAARAAAA
AAAAAFYCficAAAozBnJFBwBwKgJ0JQAAASoeAigoAAAKKh4CKCkAAAoqrn4BAAAELR5yRwcAcNAD
AAACKCoAAApvKwAACnMsAAAKgAEAAAR+AQAABCoafgIAAAQqHgKAAgAABCoafgMAAAQqHgIoLQAA
CioucwkAAAaAAwAABCpCU0pCAQABAAAAAAAMAAAAdjQuMC4zMDMxOQAAAAAFAGwAAAC4BAAAI34A
ACQFAACsBgAAI1N0cmluZ3MAAAAA0AsAALwHAAAjVVMAjBMAABAAAAAjR1VJRAAAAJwTAADQAQAA
I0Jsb2IAAAAAAAAAAgAAAVcdogEJAwAAAPoBMwAWAAABAAAAKwAAAAUAAAAGAAAACgAAAAIAAAAt
AAAAAgAAABAAAAABAAAAAgAAAAMAAAAEAAAAAQAAAAYAAAABAAAAAQAAAAAA9AMBAAAAAAAGAJAC
DQUGAB8DDQUGANwB+gQPAIEFAAAGAAkCfgQGAHMCfgQGAFQCfgQGAAYDfgQGALACfgQGAMkCfgQG
ACACfgQGADsCVwMKAOQCowMKADgBowMOAJQAXQAGANME6wUOAIQGXQAGAKcAMQQGACwGMQQGADgE
MQQGAL8B+gQGALIELQUGAKIEaQQSAI8B3gMSAPAB3gMSAG8BVAQGAKQBDQUOAMIEaQAKAMwDowMW
AMMF1wAWAJ4A1wAOAJAEXQAOAFQBXQAGAHMGMQQGAAMAMQQGAFsGMQQGAH0DMQQaAJEG1gUaAD8G
1gUGACEEMQQGAAMBMQQGALMAMQQGAKAGfgQAAAAALQAAAAAAAQABAAEAEABJBAkAOQABAAEAAAAQ
ADQFkAVNAAEABAAAARAAzQWQBWkAAwAIAAMBAAAOBgAAUQAEAAsAEQA9BLsAEQAoAb8AEQCEAMMA
BgZVAMcAVoD+BcoAVoAIAcoAUCAAAAAAhgBPBAYAAQDsJgAAAACRAHoDbQABAAInAAAAAIYY7QQG
AAIACicAAAAAgxjtBAYAAgASJwAAAACTCK4EzgACAD4nAAAAAJMIEAHTAAIARScAAAAAkwgcAdgA
AgBNJwAAAACWCDMG3gADAFQnAAAAAIYY7QQGAAMAXCcAAAAAkRjzBOMAAwAAAAEArAQAAAEAUQMJ
AO0EAQARAO0EBgAZAO0ECgApAO0EEAAxAO0EEAA5AO0EEABBAO0EEABJAO0EEABRAO0EEABZAO0E
EABhAO0EEABpAO0EBgCpAO0EBgDJAO0EFQDZAO0EBgDhAO0EBgB5AO0EBgBxAAYGJgDpAL8FKwDx
ACgEMAD5AD0DNgDhABwEOgB5ABwGQQAJAd8ERwCBAGcGNgCJACgETACZAHEDUQARAQEAVQD5AEcD
WgARAXEDXwCBAHsGZACRAIcBBgARAQEAaAARAXEDbQAhAfcAcgApASUGdgAxAYwGfADpAEwGAQBB
AUsDgwBxAO0EBgCZAO0EBgBJAcUAiABJAZwGkQCxAO0ElwDRAO0EBgAIABQAsQAIABgAtgApAHMA
HgEuAAsA9gAuABMA/wAuABsAHgEuACMAJwEuACsAUAEuADMAUAEuADsAVgEuAEMAJwEuAEsAZQEu
AFMAUAEuAFsAhQFDAGMAtgBJAHMAHgFhAHsAtgBjAGsAtgAbAAMAAQAEAAMAAACyBOcAAAAwAewA
AAA3BvEAAgAFAAMAAgAGAAUAAQAHAAUAAgAIAAcABIAAAAEAAADeH+tWAAAAAAAACQAAAAQAAAAA
AAAAAAAAAJ8AewAAAAAADQAAAAAAAAAAAAAAqACEAwAAAAAEAAAAAAAAAAAAAACfAF0AAAAAAAQA
AAAAAAAAAAAAAJ8AMQQAAAAADQAAAAAAAAAAAAAAqAA2AAAAAAAEAAAAAAAAAAAAAACfANYFAAAA
AAAAAAABAAAAPgUAAAUAAgAAAABUb0ludDMyAFNUX2M2MWE4Mzg0ZDkyOTQ4ZjY5MDlhNWQ5Njgw
MDA5ZGYzADxNb2R1bGU+AE1pY3Jvc29mdC5TcWxTZXJ2ZXIuTWFuYWdlZERUUwB2YWx1ZV9fAFN5
c3RlbS5EYXRhAFN5c3RlbS5EYXRhLk9sZURiAG1zY29ybGliAGRlZmF1bHRJbnN0YW5jZQBEYXRh
VGFibGUAVmFyaWFibGUASURpc3Bvc2FibGUAUnVudGltZVR5cGVIYW5kbGUAR2V0VHlwZUZyb21I
YW5kbGUATWljcm9zb2Z0LlNxbFNlcnZlci5EdHMuUnVudGltZQBnZXRfTmV3TGluZQBUeXBlAEZh
aWx1cmUAZ2V0X0N1bHR1cmUAc2V0X0N1bHR1cmUAcmVzb3VyY2VDdWx0dXJlAFZTVEFSVFNjcmlw
dE9iamVjdE1vZGVsQmFzZQBJbnRlcm5hbERhdGFDb2xsZWN0aW9uQmFzZQBBcHBsaWNhdGlvblNl
dHRpbmdzQmFzZQBEaXNwb3NlAEVkaXRvckJyb3dzYWJsZVN0YXRlAENvbXBpbGVyR2VuZXJhdGVk
QXR0cmlidXRlAERlYnVnZ2VyTm9uVXNlckNvZGVBdHRyaWJ1dGUARGVidWdnYWJsZUF0dHJpYnV0
ZQBFZGl0b3JCcm93c2FibGVBdHRyaWJ1dGUAQXNzZW1ibHlUaXRsZUF0dHJpYnV0ZQBBc3NlbWJs
eVRyYWRlbWFya0F0dHJpYnV0ZQBUYXJnZXRGcmFtZXdvcmtBdHRyaWJ1dGUAQXNzZW1ibHlDb25m
aWd1cmF0aW9uQXR0cmlidXRlAEFzc2VtYmx5RGVzY3JpcHRpb25BdHRyaWJ1dGUAQ29tcGlsYXRp
b25SZWxheGF0aW9uc0F0dHJpYnV0ZQBBc3NlbWJseVByb2R1Y3RBdHRyaWJ1dGUAQXNzZW1ibHlD
b3B5cmlnaHRBdHRyaWJ1dGUAU1NJU1NjcmlwdFRhc2tFbnRyeVBvaW50QXR0cmlidXRlAEFzc2Vt
Ymx5Q29tcGFueUF0dHJpYnV0ZQBSdW50aW1lQ29tcGF0aWJpbGl0eUF0dHJpYnV0ZQBnZXRfVmFs
dWUAc2V0X1ZhbHVlAHZhbHVlAFN5c3RlbS5SdW50aW1lLlZlcnNpb25pbmcAVG9TdHJpbmcAZ2V0
U3RyaW5nAE1pY3Jvc29mdC5TcWxTZXJ2ZXIuU2NyaXB0VGFzawBNaWNyb3NvZnQuU3FsU2VydmVy
LkR0cy5UYXNrcy5TY3JpcHRUYXNrAFNjcmlwdE9iamVjdE1vZGVsAFN5c3RlbS5Db21wb25lbnRN
b2RlbABTVF9jNjFhODM4NGQ5Mjk0OGY2OTA5YTVkOTY4MDAwOWRmMy5kbGwARmlsbABEQk51bGwA
Z2V0X0l0ZW0AU3lzdGVtAEVudW0AcmVzb3VyY2VNYW4AU2NyaXB0TWFpbgBTeXN0ZW0uQ29uZmln
dXJhdGlvbgBTeXN0ZW0uR2xvYmFsaXphdGlvbgBTeXN0ZW0uUmVmbGVjdGlvbgBEYXRhUm93Q29s
bGVjdGlvbgBDdWx0dXJlSW5mbwBnZXRfUmVzb3VyY2VNYW5hZ2VyAE9sZURiRGF0YUFkYXB0ZXIA
SUVudW1lcmF0b3IAR2V0RW51bWVyYXRvcgAuY3RvcgAuY2N0b3IAU3lzdGVtLkRpYWdub3N0aWNz
AFN5c3RlbS5SdW50aW1lLkNvbXBpbGVyU2VydmljZXMAU3lzdGVtLlJlc291cmNlcwBTVF9jNjFh
ODM4NGQ5Mjk0OGY2OTA5YTVkOTY4MDAwOWRmMy5Qcm9wZXJ0aWVzLlJlc291cmNlcy5yZXNvdXJj
ZXMARGVidWdnaW5nTW9kZXMAU1RfYzYxYTgzODRkOTI5NDhmNjkwOWE1ZDk2ODAwMDlkZjMuUHJv
cGVydGllcwBnZXRfVmFyaWFibGVzAFNldHRpbmdzAFN5c3RlbS5XaW5kb3dzLkZvcm1zAFN5c3Rl
bS5Db2xsZWN0aW9ucwBTdWNjZXNzAGdldF9EdHMAU2NyaXB0UmVzdWx0cwBnZXRfUm93cwBDb25j
YXQAT2JqZWN0AGdldF9EZWZhdWx0AERpYWxvZ1Jlc3VsdABzZXRfVGFza1Jlc3VsdABFbnZpcm9u
bWVudABnZXRfQ3VycmVudABDb252ZXJ0AE1vdmVOZXh0AERhdGFSb3cAU2hvdwBNZXNzYWdlQm94
AGdldF9Bc3NlbWJseQAAAAAAOXIAcwBXAG8AcgBrAGYAbABvAHcAUwB0AGUAcABfAEMAbwBuAGYA
aQBnAHUAcgBhAHQAaQBvAG4AAE1VAHMAZQByADoAOgBpAG4AdABBAHAAcABsAGkAYwBhAHQAaQBv
AG4ARABhAHQAYQBsAG8AYQBkAFcAbwByAGsAZgBsAG8AdwBJAEQAADtBAHAAcABsAGkAYwBhAHQA
aQBvAG4ARABhAHQAYQBsAG8AYQBkAFcAbwByAGsAZgBsAG8AdwBJAEQAACdVAHMAZQByADoAOgBp
AG4AdABEAGEAdABhAEwAbwBhAGQASQBEAAAVRABhAHQAYQBMAG8AYQBkAEkARAAAMXMAdAByAEEA
cgBjAGgAaQB2AGUARgBpAGwAZQBOAGEAbQBlAEYAbwByAG0AYQB0AAArQQByAGMAaABpAHYAZQBG
AGkAbABlAE4AYQBtAGUARgBvAHIAbQBhAHQAAA9zAHQAcgBCAG8AZAB5AAAJQgBvAGQAeQAAIXMA
dAByAEMAbwByAHIAdQBwAHQARgBvAGwAZABlAHIAABtDAG8AcgByAHUAcAB0AEYAbwBsAGQAZQBy
AAApcwB0AHIARABlAHMAdABpAG4AYQB0AGkAbwBuAEYAbwBsAGQAZQByAAAjRABlAHMAdABpAG4A
YQB0AGkAbwBuAEYAbwBsAGQAZQByAAAzcwB0AHIARgBpAGwAZQBOAGEAbQBlAF8ARgBvAHIAbQBh
AHQAXwBJAG0AcABvAHIAdAAALUYAaQBsAGUATgBhAG0AZQBfAEYAbwByAG0AYQB0AF8ASQBtAHAA
bwByAHQAADNzAHQAcgBGAGkAbABlAE4AYQBtAGUAXwBGAG8AcgBtAGEAdABfAEUAeABwAG8AcgB0
AAAtRgBpAGwAZQBOAGEAbQBlAF8ARgBvAHIAbQBhAHQAXwBFAHgAcABvAHIAdAAAGXMAdAByAEYA
cgBvAG0ARQBtAGEAaQBsAAATRgByAG8AbQBFAG0AYQBpAGwAACtzAHQAcgBQAHIAbwBjAGUAcwBz
AFUAbgBrAG4AbwB3AG4ARgBpAGwAZQAAJVAAcgBvAGMAZQBzAHMAVQBuAGsAbgBvAHcAbgBGAGkA
bABlAAAfcwB0AHIAUwBvAHUAcgBjAGUARgBvAGwAZABlAHIAABlTAG8AdQByAGMAZQBGAG8AbABk
AGUAcgAALXMAdAByAFMAdABvAHIAZQBkAFAAcgBvAGMAZQBkAHUAcgBlAE4AYQBtAGUAACdTAHQA
bwByAGUAZABQAHIAbwBjAGUAZAB1AHIAZQBOAGEAbQBlAAAVcwB0AHIAUwB1AGIAagBlAGMAdAAA
D1MAdQBiAGoAZQBjAHQAABVzAHQAcgBUAG8ARQBtAGEAaQBsAAAPVABvAEUAbQBhAGkAbAAAIXMA
dAByAFUAbgBrAG4AbwB3AG4ARgBvAGwAZABlAHIAABtVAG4AawBuAG8AdwBuAEYAbwBsAGQAZQBy
AAARaQBuAHQARABlAGIAdQBnAAAzIABpAG4AdABfAEQAYQB0AGEAbABvAGEAZABXAG8AcgBrAEYA
bABvAHcASQBEACAAOgAALWkAbgB0AF8ARABhAHQAYQBsAG8AYQBkAFcAbwByAGsARgBsAG8AdwBJ
AEQAAD9BAHAAcABsAGkAYwBhAHQAaQBvAG4ARABhAHQAYQBsAG8AYQBkAFcAbwByAGsAZgBsAG8A
dwBJAEQAIAA6AAAfaQBuAHQARABhAHQAYQBMAG8AYQBkAEkARAAgADoAADVzAHQAcgBBAHIAYwBo
AGkAdgBlAEYAaQBsAGUATgBhAG0AZQBGAG8AcgBtAGEAdAAgADoAABNzAHQAcgBCAG8AZAB5ACAA
OgAAJXMAdAByAEMAbwByAHIAdQBwAHQARgBvAGwAZABlAHIAIAA6AAAtcwB0AHIARABlAHMAdABp
AG4AYQB0AGkAbwBuAEYAbwBsAGQAZQByACAAOgAAN3MAdAByAEYAaQBsAGUATgBhAG0AZQBfAEYA
bwByAG0AYQB0AF8ASQBtAHAAbwByAHQAIAA6AAA3cwB0AHIARgBpAGwAZQBOAGEAbQBlAF8ARgBv
AHIAbQBhAHQAXwBFAHgAcABvAHIAdAAgADoAAB1zAHQAcgBGAHIAbwBtAEUAbQBhAGkAbAAgADoA
AC9zAHQAcgBQAHIAbwBjAGUAcwBzAFUAbgBrAG4AbwB3AG4ARgBpAGwAZQAgADoAACNzAHQAcgBT
AG8AdQByAGMAZQBGAG8AbABkAGUAcgAgADoAADFzAHQAcgBTAHQAbwByAGUAZABQAHIAbwBjAGUA
ZAB1AHIAZQBOAGEAbQBlACAAOgAAGXMAdAByAFMAdQBiAGoAZQBjAHQAIAA6AAAZcwB0AHIAVABv
AEUAbQBhAGkAbAAgADoAACVzAHQAcgBVAG4AawBuAG8AdwBuAEYAbwBsAGQAZQByACAAOgAAAQBx
UwBUAF8AYwA2ADEAYQA4ADMAOAA0AGQAOQAyADkANAA4AGYANgA5ADAAOQBhADUAZAA5ADYAOAAw
ADAAMAA5AGQAZgAzAC4AUAByAG8AcABlAHIAdABpAGUAcwAuAFIAZQBzAG8AdQByAGMAZQBzAAAA
AAAaPSHV1p5uQ7DOxZmrUD2HAAQgAQEIAyAAAQUgAQEREQQgAQEOBSABARFhCgcEEj0SQRJFEkkE
IAASdQQgABJ5BSABEn0cAyAAHAYgAggSPRwFIAASgIEEIAASQQQgARwOAyAADgQAAQgOBCABARwE
AAEODgMgAAIEAAEIHAQAAQ4cAwAADgUAAQ4dHAYAARGAnQ4EBhKAoQgAARKApRGAqQUgABKArQcg
AgEOEoCtCLd6XFYZNOCJCImEXc2AgMyRBAAAAAAEAQAAAAMGElkDBhJdAwYSEAIGCAMGERQEAAAS
WQQAABJdBQABARJdBAAAEhADAAABBAgAElkECAASXQQIABIQCAEACAAAAAAAHgEAAQBUAhZXcmFw
Tm9uRXhjZXB0aW9uVGhyb3dzAQgBAAIAAAAAACgBACNTVF9jNjFhODM4NGQ5Mjk0OGY2OTA5YTVk
OTY4MDAwOWRmMwAABQEAAAAADgEACU1pY3Jvc29mdAAAHwEAGkNvcHlyaWdodCBAIE1pY3Jvc29m
dCAyMDE3AABJAQAaLk5FVEZyYW1ld29yayxWZXJzaW9uPXY0LjcBAFQOFEZyYW1ld29ya0Rpc3Bs
YXlOYW1lEi5ORVQgRnJhbWV3b3JrIDQuNwC0AAAAzsrvvgEAAACRAAAAbFN5c3RlbS5SZXNvdXJj
ZXMuUmVzb3VyY2VSZWFkZXIsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1
dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OSNTeXN0ZW0uUmVzb3VyY2VzLlJ1
bnRpbWVSZXNvdXJjZVNldAIAAAAAAAAAAAAAAFBBRFBBRFC0AAAAtD0AAAAAAAAAAAAAzj0AAAAg
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAMA9AAAAAAAAAAAAAAAAX0NvckRsbE1haW4AbXNjb3JlZS5k
bGwAAAAAAP8lACAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEA
EAAAABgAAIAAAAAAAAAAAAAAAAAAAAEAAQAAADAAAIAAAAAAAAAAAAAAAAAAAAEAAAAAAEgAAABY
QAAAPgQAAAAAAAAAAAAAPgQ0AAAAVgBTAF8AVgBFAFIAUwBJAE8ATgBfAEkATgBGAE8AAAAAAL0E
7/4AAAEAAAABAOtW3h8AAAEA61beHz8AAAAAAAAABAAAAAIAAAAAAAAAAAAAAAAAAABEAAAAAQBW
AGEAcgBGAGkAbABlAEkAbgBmAG8AAAAAACQABAAAAFQAcgBhAG4AcwBsAGEAdABpAG8AbgAAAAAA
AACwBJ4DAAABAFMAdAByAGkAbgBnAEYAaQBsAGUASQBuAGYAbwAAAHoDAAABADAAMAAwADAAMAA0
AGIAMAAAABoAAQABAEMAbwBtAG0AZQBuAHQAcwAAAAAAAAA0AAoAAQBDAG8AbQBwAGEAbgB5AE4A
YQBtAGUAAAAAAE0AaQBjAHIAbwBzAG8AZgB0AAAAcAAkAAEARgBpAGwAZQBEAGUAcwBjAHIAaQBw
AHQAaQBvAG4AAAAAAFMAVABfAGMANgAxAGEAOAAzADgANABkADkAMgA5ADQAOABmADYAOQAwADkA
YQA1AGQAOQA2ADgAMAAwADAAOQBkAGYAMwAAAD4ADwABAEYAaQBsAGUAVgBlAHIAcwBpAG8AbgAA
AAAAMQAuADAALgA4ADEANQA4AC4AMgAyADIANQAxAAAAAABwACgAAQBJAG4AdABlAHIAbgBhAGwA
TgBhAG0AZQAAAFMAVABfAGMANgAxAGEAOAAzADgANABkADkAMgA5ADQAOABmADYAOQAwADkAYQA1
AGQAOQA2ADgAMAAwADAAOQBkAGYAMwAuAGQAbABsAAAAWgAbAAEATABlAGcAYQBsAEMAbwBwAHkA
cgBpAGcAaAB0AAAAQwBvAHAAeQByAGkAZwBoAHQAIABAACAATQBpAGMAcgBvAHMAbwBmAHQAIAAy
ADAAMQA3AAAAAAAqAAEAAQBMAGUAZwBhAGwAVAByAGEAZABlAG0AYQByAGsAcwAAAAAAAAAAAHgA
KAABAE8AcgBpAGcAaQBuAGEAbABGAGkAbABlAG4AYQBtAGUAAABTAFQAXwBjADYAMQBhADgAMwA4
ADQAZAA5ADIAOQA0ADgAZgA2ADkAMAA5AGEANQBkADkANgA4ADAAMAAwADkAZABmADMALgBkAGwA
bAAAAGgAJAABAFAAcgBvAGQAdQBjAHQATgBhAG0AZQAAAAAAUwBUAF8AYwA2ADEAYQA4ADMAOAA0
AGQAOQAyADkANAA4AGYANgA5ADAAOQBhADUAZAA5ADYAOAAwADAAMAA5AGQAZgAzAAAAQgAPAAEA
UAByAG8AZAB1AGMAdABWAGUAcgBzAGkAbwBuAAAAMQAuADAALgA4ADEANQA4AC4AMgAyADIANQAx
AAAAAABGAA8AAQBBAHMAcwBlAG0AYgBsAHkAIABWAGUAcgBzAGkAbwBuAAAAMQAuADAALgA4ADEA
NQA4AC4AMgAyADIANQAxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAADAAAAOA9AAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==</BinaryItem>
        </ScriptProject>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{46D5BA9D-ADCC-4B7A-B041-9505F92B367F}"
      DTS:From="Package\Flag Dataload as Start"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Get the Configuration" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{C07D60C0-0946-484B-9FDE-A233C314BE01}"
      DTS:From="Package\Get the Configuration"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Set up configuration variables" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{74BE94DB-B5F1-4B33-8267-4CF91C699565}"
      DTS:From="Package\Set up configuration variables"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Sequence Container" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{BBCF819C-6994-4DFE-BF25-ED8642DC8B27}"
      DTS:From="Package\Sequence Container"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Flag Data Load Complete" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{F62FCDB1-5593-4A87-8BC9-290488FB2C20}"
      DTS:From="Package\Sequence Container"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\Flag Data Load Failed"
      DTS:Value="1" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{BAEA4301-2A77-45B7-A7BD-DE261A7F8108}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{C46AA1F7-B34A-44BC-9E58-A32A3395AD10}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Send Mail Task"
          DTS:CreationName="Microsoft.SendMailTask"
          DTS:Description="Send Mail Task"
          DTS:DTSID="{CCB176FC-4C85-4FA4-B0AB-AF707C1D05DA}"
          DTS:ExecutableType="Microsoft.SendMailTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Send Mail Task"
          DTS:TaskContact="Send Mail Task; Microsoft Corporation; SQL Server 2016;  2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
          <DTS:Variables />
          <DTS:PropertyExpression
            DTS:Name="Disable">@[User::int_DataloadWorkFlowID] &gt;0</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="FromLine">@[User::strFromEmail]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="Subject">@[User::strSubject]</DTS:PropertyExpression>
          <DTS:PropertyExpression
            DTS:Name="ToLine">@[User::strToEmail]</DTS:PropertyExpression>
          <DTS:ObjectData>
            <SendMailTask:SendMailTaskData
              SendMailTask:SMTPServer="{2C11C33C-2E12-467F-8E02-A7EE0DFC48B4}"
              SendMailTask:From="TE-BI@collinsongroup.com"
              SendMailTask:To="TE-BI@collinsongroup.com"
              SendMailTask:Subject="04_src2dest_ppass_bi02_visits_extract Fails to execute.Please check Package and run again"
              SendMailTask:MessageSourceType="Variable"
              SendMailTask:MessageSource="User::strBody" xmlns:SendMailTask="www.microsoft.com/sqlserver/dts/tasks/sendmailtask" />
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="198,45"
          Id="Package\Flag Data Load Complete"
          TopLeft="92.4376436040995,1187.10737384788" />
        <NodeLayout
          Size="198,45"
          Id="Package\Flag Data Load Failed"
          TopLeft="586.578241026437,1196.42092994956" />
        <NodeLayout
          Size="283,42"
          Id="Package\Flag Dataload as Start"
          TopLeft="293.757147810411,91.6287594549939" />
        <NodeLayout
          Size="283,42"
          Id="Package\Get the Configuration"
          TopLeft="293.757147810411,139.452288883918" />
        <NodeLayout
          Size="275,42"
          Id="Package\Sequence Container\Sequence Container\Archive existing Visits"
          TopLeft="15.670300030988,198.303273907719" />
        <NodeLayout
          Size="268,42"
          Id="Package\Sequence Container\Sequence Container\Delete tblDBWSLoungeVisits"
          TopLeft="12.5952382160694,300.020723152132" />
        <NodeLayout
          Size="284,42"
          Id="Package\Sequence Container\Sequence Container\Get Current Reporting Month"
          TopLeft="14.3095239595491,18.5294036222676" />
        <NodeLayout
          Size="253,42"
          Id="Package\Sequence Container\Sequence Container\Populate dbwsvisitsbysource"
          TopLeft="21.7428621861399,384.205232687942" />
        <NodeLayout
          Size="261,42"
          Id="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits"
          TopLeft="23.9285717424082,473.875813977681" />
        <NodeLayout
          Size="301,42"
          Id="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster"
          TopLeft="7.02380954975979,106.781131902722" />
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint]"
          TopLeft="156.866666754654,60.1294036222676">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,46.6517282804548"
              Start="0,0"
              End="0,39.1517282804548">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,39.1517282804548" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint 1]"
          TopLeft="155.347054790374,148.381131902722">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,49.9221420049965"
              Start="0,0"
              End="0,42.4221420049965">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,42.4221420049965" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint 2]"
          TopLeft="147.369050201105,341.620723152132">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.5845095358099"
              Start="0,0"
              End="0,35.0845095358099">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,35.0845095358099" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint 3]"
          TopLeft="149.932769123529,239.903273907719">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60.1174492444127"
              Start="0,0"
              End="0,52.6174492444127">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.6174492444127" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container.PrecedenceConstraints[Constraint 4]"
          TopLeft="151.235716964274,425.805232687942">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,48.070581289739"
              Start="0,0"
              End="0,40.570581289739">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,40.570581289739" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="325,571"
          Size="325,614"
          Id="Package\Sequence Container\Sequence Container"
          TopLeft="39.4938822290292,103.872273849919" />
        <NodeLayout
          Size="162,42"
          Id="Package\Sequence Container\Workflow Control"
          TopLeft="117.180958381964,8.18823231979758" />
        <EdgeLayout
          Id="Package\Sequence Container.PrecedenceConstraints[Constraint]"
          TopLeft="199.937420305497,49.7882323197976">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,54.084041530121"
              Start="0,0"
              End="0,46.584041530121">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,46.584041530121" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <ContainerLayout
          HeaderHeight="43"
          IsExpanded="True"
          PanelSize="398,773"
          Size="398,816"
          Id="Package\Sequence Container"
          TopLeft="234.875967866896,292.342859195261" />
        <NodeLayout
          Size="283,42"
          Id="Package\Set up configuration variables"
          TopLeft="293.757147810411,186.66405359838" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="293.757147810412,112.428759454993">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,42.2235294289243"
              Start="0,0"
              End="-7.5,42.2235294289243">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-18.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="-18.5,0"
                    Point2="-22.5,0"
                    Point3="-22.5,4" />
                  <mssgle:LineSegment
                    End="-22.5,38.2235294289243" />
                  <mssgle:CubicBezierSegment
                    Point1="-22.5,38.2235294289243"
                    Point2="-22.5,42.2235294289243"
                    Point3="-18.5,42.2235294289243" />
                  <mssgle:LineSegment
                    End="-7.5,42.2235294289243" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="293.757147810412,165.852288883918">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,36.0117647144619"
              Start="0,0"
              End="-7.5,36.0117647144619">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-18.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="-18.5,0"
                    Point2="-22.5,0"
                    Point3="-22.5,4" />
                  <mssgle:LineSegment
                    End="-22.5,32.0117647144619" />
                  <mssgle:CubicBezierSegment
                    Point1="-22.5,32.0117647144619"
                    Point2="-22.5,36.0117647144619"
                    Point3="-18.5,36.0117647144619" />
                  <mssgle:LineSegment
                    End="-7.5,36.0117647144619" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="434.516557838654,228.26405359838">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,64.078805596881"
              Start="0,0"
              End="0,56.578805596881">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,56.578805596881" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="368.742634533563,1108.34285919526">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-177.104990929463,78.7645146526188"
              Start="0,0"
              End="-177.104990929463,71.2645146526188">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,27.6952195235388" />
                  <mssgle:CubicBezierSegment
                    Point1="0,27.6952195235388"
                    Point2="0,31.6952195235388"
                    Point3="-4,31.6952195235388" />
                  <mssgle:LineSegment
                    End="-173.104990929463,31.6952195235388" />
                  <mssgle:CubicBezierSegment
                    Point1="-173.104990929463,31.6952195235388"
                    Point2="-177.104990929463,31.6952195235388"
                    Point3="-177.104990929463,35.6952195235388" />
                  <mssgle:LineSegment
                    End="-177.104990929463,71.2645146526188" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="498.609301200229,1108.34285919526">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="187.168939826208,88.0780707543031"
              Start="0,0"
              End="187.168939826208,80.5780707543031">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.4430392935152" />
                  <mssgle:CubicBezierSegment
                    Point1="0,31.4430392935152"
                    Point2="0,35.4430392935152"
                    Point3="4,35.4430392935152" />
                  <mssgle:LineSegment
                    End="183.168939826208,35.4430392935152" />
                  <mssgle:CubicBezierSegment
                    Point1="183.168939826208,35.4430392935152"
                    Point2="187.168939826208,35.4430392935152"
                    Point3="187.168939826208,39.4430392935152" />
                  <mssgle:LineSegment
                    End="187.168939826208,80.5780707543031" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="78.3431222568538,40.4430392935152,30.4826953125,9.7490234375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="150.4,41.6"
          Id="Package.EventHandlers[OnError]\Send Mail Task"
          TopLeft="199.428568217219,103.011763401757" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <TaskHost
    design-time-name="Package\Sequence Container\Sequence Container\Archive existing Visits">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="270.4,41.6"
          Id="Package\Sequence Container\Sequence Container\Archive existing Visits\Destination tblMCLKLoungeVisits archive"
          TopLeft="167.2,344.8" />
        <NodeLayout
          Size="244.8,41.6"
          Id="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits"
          TopLeft="184,77.6" />
        <NodeLayout
          Size="244.8,41.6"
          Id="Package\Sequence Container\Sequence Container\Archive existing Visits\Derived Column"
          TopLeft="184.72077913939,167.944206867736" />
        <NodeLayout
          Size="244.8,41.6"
          Id="Package\Sequence Container\Sequence Container\Archive existing Visits\Row Count"
          TopLeft="184.14935055823,249.729590309018" />
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container\Archive existing Visits.Paths[Row Count Output 1]"
          TopLeft="304.474675279115,291.329590309018">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,53.4704096909819"
              Start="0,0"
              End="0,45.9704096909819">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,45.9704096909819" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container\Archive existing Visits.Paths[OLE DB Source Output]"
          TopLeft="306.760389569695,119.2">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,48.7442068677356"
              Start="0,0"
              End="0,41.2442068677356">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,41.2442068677356" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container\Archive existing Visits.Paths[Derived Column Output]"
          TopLeft="306.83506484881,209.544206867736">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,40.1853834412813"
              Start="0,0"
              End="0,32.6853834412813">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.6853834412813" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Sequence Container\Sequence Container\Archive existing Visits\Source tblMCLKLoungeVisits">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="201.6,41.6"
          Id="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Get DataLoadWorkFlowID"
          TopLeft="133.22197995852,138.513125294981" />
        <NodeLayout
          Size="203.2,43.2"
          Id="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Row Count"
          TopLeft="129.14286050018,237.952944205128" />
        <NodeLayout
          Size="236,41.6"
          Id="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits"
          TopLeft="116.672529136592,356.971044293165" />
        <NodeLayout
          Size="205.6,41.6"
          Id="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource"
          TopLeft="132.948051536901,63.4652411135985" />
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits.Paths[Row Count Output 1]"
          TopLeft="232.707694818386,281.152944205128">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,75.8181000880369"
              Start="0,0"
              End="0,68.3181000880369">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,68.3181000880369" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits.Paths[OLE DB Source Output]"
          TopLeft="234.885015747711,105.065241113599">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,33.4478841813825"
              Start="0,0"
              End="0,25.9478841813825">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.9478841813825" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits.Paths[Derived Column Output]"
          TopLeft="232.38242022935,180.113125294981">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,57.839818910147"
              Start="0,0"
              End="0,50.339818910147">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,50.339818910147" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Destination tblDBWSLoungeVisits">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Sequence Container\Sequence Container\PPDB DBWS_Visits\Source dbwsvisitsbysource">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="252,42"
          Id="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes to variable"
          TopLeft="211.085713711564,204.47058799506" />
        <NodeLayout
          Size="301,42"
          Id="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster"
          TopLeft="188.114284653566,78.5411764276894" />
        <EdgeLayout
          Id="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster.Paths[OLE DB Source Output]"
          TopLeft="337.799999182565,120.141176427689">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,84.3294115673707"
              Start="0,0"
              End="0,76.8294115673707">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,76.8294115673707" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Sequence Container\Sequence Container\Source codes from vwGlobalSourceCodeMaster\Source codes from vwGlobalSourceCodeMaster">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>